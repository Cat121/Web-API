{"version":3,"sources":["../node_modules/copy-to-clipboard/index.js","../node_modules/toggle-selection/index.js","views/Integrations/WebBooks/Books.tsx","components/DataTable/index.tsx","components/DataTable/Pagination.tsx","components/DataTable/TableHeader.tsx","components/DataTable/TableRow.tsx","components/DataView/index.tsx","components/CreateForm/index.tsx","components/FilterForm/index.tsx"],"names":["deselectCurrent","__webpack_require__","defaultMessage","module","exports","text","options","debug","message","reselectPrevious","range","selection","mark","success","document","createRange","getSelection","createElement","textContent","style","all","position","top","clip","whiteSpace","webkitUserSelect","MozUserSelect","msUserSelect","userSelect","body","appendChild","selectNode","addRange","execCommand","Error","err","console","error","warn","window","clipboardData","setData","copyKey","test","navigator","userAgent","replace","format","prompt","removeRange","removeAllRanges","removeChild","rangeCount","active","activeElement","ranges","i","push","getRangeAt","tagName","toUpperCase","blur","type","forEach","focus","DataView","Object","__WEBPACK_IMPORTED_MODULE_5__components_DataView__","Books","_super","props","_this","call","this","onFocus","e","target","select","renderEditContent","bind","__extends","prototype","render","t","fields","id","label","create","filter","required","title","edit","wide","lines","view","content","book","__WEBPACK_IMPORTED_MODULE_1_react__","dangerouslySetInnerHTML","__html","html","link","action","color","icon","onClick","copy","value","apiUrl","__WEBPACK_IMPORTED_MODULE_4_semantic_ui_react__","fluid","canEdit","canDelete","filterTitle","createTitle","onSave","obj","newData","save","state","map","line","index","Item","key","compact","negative","size","deleteLine","primary","floated","moveLineDown","disabled","length","moveLineUp","addLine","name","placeholder","onChange","handleChange","newItem","setState","concat","__WEBPACK_IMPORTED_MODULE_0_copy_to_clipboard__","__webpack_exports__","__WEBPACK_IMPORTED_MODULE_3_react_redux__","api","server","dispatch","__WEBPACK_IMPORTED_MODULE_2_react_i18next__","DataTable","changePage","event","page","preventDefault","onEdit","keys","__WEBPACK_IMPORTED_MODULE_0_lodash__","doHandleChange","__WEBPACK_IMPORTED_MODULE_5__Util__","__assign","_a","shouldComponentUpdate","nextProps","nextState","list","actions","f","maxPage","Math","ceil","min","_t","editable","deletable","marginTop","renderHeader","__WEBPACK_IMPORTED_MODULE_3_semantic_ui_react__","striped","stackable","__WEBPACK_IMPORTED_MODULE_7__TableHeader__","hasActions","i18n","__WEBPACK_IMPORTED_MODULE_4__services_i18n__","Body","renderRows","__WEBPACK_IMPORTED_MODULE_6__Pagination__","fitted","listPage","slice","thisRef","changes","__WEBPACK_IMPORTED_MODULE_8__TableRow__","idFunc","tableRef","actionable","editing","isEditing","onDelete","Pagination","__WEBPACK_IMPORTED_MODULE_0_react__","__WEBPACK_IMPORTED_MODULE_1_semantic_ui_react__","pagination","renderFirst","renderPrevMore","renderMain","renderNextMore","renderLast","from","max","to","pages","p","DataTableHeader","Header","Row","renderFields","renderActions","field","HeaderCell","TableRow","apply","arguments","onEditEmpty","undefined","j","Cell","collapsing","renderField","renderEdit","__WEBPACK_IMPORTED_MODULE_2__Util__","col","Field","search","control","Input","_canEdit","_canDelete","updating","loading","secondary","del","endpoint","objId","noDetails","data","__WEBPACK_IMPORTED_MODULE_2_react_redux__","_state","ownProps","creating","types","perm","split","perms","permissions","mapStateToProps","requestList","__WEBPACK_IMPORTED_MODULE_4__actions_dataview__","requestDetails","requestCreate","requestChange","requestDelete","setFilter","equals","o1","o2","mapDispatchToProps","expandRef","details","endEdit","delete","onCreate","newObj","__WEBPACK_IMPORTED_MODULE_8__Util__","componentDidMount","static","interval","setInterval","componentWillUnmount","clearInterval","checks","regsValid","val","func_1","createFields","filterFields","ff","find","filterName","dataVal","filterValue","v","indexOf","RegExp","_b","every","check","cols","origActions","DT","createTable","createForm","renderCreateForm","filterForm","renderFilterForm","basic","doubling","columns","__WEBPACK_IMPORTED_MODULE_6__DataTable__","checkCreatePerm","createButton","Column","__WEBPACK_IMPORTED_MODULE_5__CreateForm__","button","__WEBPACK_IMPORTED_MODULE_7__FilterForm__","valid","values","onFilterChange","CreateForm","handleClick","open","__WEBPACK_IMPORTED_MODULE_4__Util__","canCreate","createName","styled","Title","Content","renderFieldGroups","fieldGroups","newField","isGroup","only","second","first","fg","Group","widths","FilterForm","__WEBPACK_IMPORTED_MODULE_3__Util__","fs","__WEBPACK_IMPORTED_MODULE_2_semantic_ui_react__","visible","multiple"],"mappings":"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","file":"static/js/6.1d8a313a.chunk.js","sourcesContent":["'use strict';\n\nvar deselectCurrent = require('toggle-selection');\n\nvar defaultMessage = 'Copy to clipboard: #{key}, Enter';\n\nfunction format(message) {\n  var copyKey = (/mac os x/i.test(navigator.userAgent) ? '⌘' : 'Ctrl') + '+C';\n  return message.replace(/#{\\s*key\\s*}/g, copyKey);\n}\n\nfunction copy(text, options) {\n  var debug, message, reselectPrevious, range, selection, mark, success = false;\n  if (!options) { options = {}; }\n  debug = options.debug || false;\n  try {\n    reselectPrevious = deselectCurrent();\n\n    range = document.createRange();\n    selection = document.getSelection();\n\n    mark = document.createElement('span');\n    mark.textContent = text;\n    // reset user styles for span element\n    mark.style.all = 'unset';\n    // prevents scrolling to the end of the page\n    mark.style.position = 'fixed';\n    mark.style.top = 0;\n    mark.style.clip = 'rect(0, 0, 0, 0)';\n    // used to preserve spaces and line breaks\n    mark.style.whiteSpace = 'pre';\n    // do not inherit user-select (it may be `none`)\n    mark.style.webkitUserSelect = 'text';\n    mark.style.MozUserSelect = 'text';\n    mark.style.msUserSelect = 'text';\n    mark.style.userSelect = 'text';\n\n    document.body.appendChild(mark);\n\n    range.selectNode(mark);\n    selection.addRange(range);\n\n    var successful = document.execCommand('copy');\n    if (!successful) {\n      throw new Error('copy command was unsuccessful');\n    }\n    success = true;\n  } catch (err) {\n    debug && console.error('unable to copy using execCommand: ', err);\n    debug && console.warn('trying IE specific stuff');\n    try {\n      window.clipboardData.setData('text', text);\n      success = true;\n    } catch (err) {\n      debug && console.error('unable to copy using clipboardData: ', err);\n      debug && console.error('falling back to prompt');\n      message = format('message' in options ? options.message : defaultMessage);\n      window.prompt(message, text);\n    }\n  } finally {\n    if (selection) {\n      if (typeof selection.removeRange == 'function') {\n        selection.removeRange(range);\n      } else {\n        selection.removeAllRanges();\n      }\n    }\n\n    if (mark) {\n      document.body.removeChild(mark);\n    }\n    reselectPrevious();\n  }\n\n  return success;\n}\n\nmodule.exports = copy;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/copy-to-clipboard/index.js\n// module id = 1024\n// module chunks = 6","\nmodule.exports = function () {\n  var selection = document.getSelection();\n  if (!selection.rangeCount) {\n    return function () {};\n  }\n  var active = document.activeElement;\n\n  var ranges = [];\n  for (var i = 0; i < selection.rangeCount; i++) {\n    ranges.push(selection.getRangeAt(i));\n  }\n\n  switch (active.tagName.toUpperCase()) { // .toUpperCase handles XHTML\n    case 'INPUT':\n    case 'TEXTAREA':\n      active.blur();\n      break;\n\n    default:\n      active = null;\n      break;\n  }\n\n  selection.removeAllRanges();\n  return function () {\n    selection.type === 'Caret' &&\n    selection.removeAllRanges();\n\n    if (!selection.rangeCount) {\n      ranges.forEach(function(range) {\n        selection.addRange(range);\n      });\n    }\n\n    active &&\n    active.focus();\n  };\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/toggle-selection/index.js\n// module id = 1025\n// module chunks = 6","import * as copy from 'copy-to-clipboard';\r\nimport * as React from 'react';\r\nimport { withTranslation, WithTranslation } from 'react-i18next';\r\nimport { connect } from 'react-redux';\r\nimport { Dispatch } from 'redux';\r\nimport { Button, Input, List } from 'semantic-ui-react';\r\n\r\nimport { AppAction } from '../../../actions';\r\nimport DataViewFunc, { DataViewFields } from '../../../components/DataView';\r\nimport { WebBooksBook } from '../../../fetch';\r\nimport { AppState, DataViewRef } from '../../../types';\r\n\r\n// tslint:disable-next-line: variable-name\r\nconst DataView = DataViewFunc('web-books/book', 'id');\r\n\r\ninterface Props extends WithTranslation {\r\n\tapiUrl: string;\r\n}\r\n\r\ninterface OwnState {\r\n\tlines: string[];\r\n\tnewItem: '';\r\n}\r\n\r\nclass Books extends React.Component<Props, OwnState> {\r\n\tpublic constructor(props: Props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.renderEditContent = this.renderEditContent.bind(this);\r\n\t}\r\n\r\n\tpublic render() {\r\n\t\tconst { t } = this.props;\r\n\r\n\t\tconst linkView = (book: WebBooksBook) => {\r\n\t\t\tconst action = {\r\n\t\t\t\tcolor: 'teal',\r\n\t\t\t\ticon: 'linkify',\r\n\t\t\t\tonClick: () => this.copy(book)\r\n\t\t\t};\r\n\t\t\tconst value =\r\n\t\t\t\tthis.props.apiUrl + '/api/v5/web-books/book/' + book.id + '/html';\r\n\t\t\treturn (\r\n\t\t\t\t<Input fluid onFocus={this.onFocus} action={action} value={value} />\r\n\t\t\t);\r\n\t\t};\r\n\r\n\t\tconst fields: DataViewFields<WebBooksBook> = {\r\n\t\t\tid: {\r\n\t\t\t\tlabel: t('Id'),\r\n\t\t\t\tcreate: true,\r\n\t\t\t\tfilter: true,\r\n\t\t\t\trequired: true\r\n\t\t\t},\r\n\t\t\ttitle: {\r\n\t\t\t\tlabel: t('Title'),\r\n\t\t\t\tedit: true,\r\n\t\t\t\tcreate: true,\r\n\t\t\t\trequired: true,\r\n\t\t\t\twide: true\r\n\t\t\t},\r\n\t\t\tlines: {\r\n\t\t\t\tview: false,\r\n\t\t\t\tedit: true\r\n\t\t\t},\r\n\t\t\tcontent: {\r\n\t\t\t\tlabel: t('Content'),\r\n\t\t\t\twide: true,\r\n\t\t\t\tview: book => <div dangerouslySetInnerHTML={{ __html: book.html }} />,\r\n\t\t\t\tedit: this.renderEditContent\r\n\t\t\t},\r\n\t\t\tlink: {\r\n\t\t\t\tlabel: t('Link'),\r\n\t\t\t\twide: true,\r\n\t\t\t\tview: linkView\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tconst onSave = (\r\n\t\t\tobj: WebBooksBook,\r\n\t\t\tnewData: any,\r\n\t\t\tview: DataViewRef<WebBooksBook>\r\n\t\t) => {\r\n\t\t\tview.save(obj, {\r\n\t\t\t\tid: obj.id,\r\n\t\t\t\ttitle: newData.title,\r\n\t\t\t\tlines: newData.lines\r\n\t\t\t});\r\n\t\t};\r\n\r\n\t\treturn (\r\n\t\t\t<DataView\r\n\t\t\t\tcanEdit\r\n\t\t\t\tcanDelete\r\n\t\t\t\ticon=\"book\"\r\n\t\t\t\ttitle={t('WebBooks')}\r\n\t\t\t\tfilterTitle={t('FilterBooks')}\r\n\t\t\t\tcreateTitle={t('CreateBook')}\r\n\t\t\t\tfields={fields}\r\n\t\t\t\tonSave={onSave}\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate renderEditContent(\r\n\t\tbook: WebBooksBook,\r\n\t\tview: DataViewRef<WebBooksBook>\r\n\t) {\r\n\t\tconst { t } = this.props;\r\n\r\n\t\tconst lines = view.state.lines.map((line: string, index: number) => {\r\n\t\t\tconst onDel = () => this.deleteLine(view, index);\r\n\t\t\tconst onMoveDown = () => this.moveLineDown(view, index);\r\n\t\t\tconst onMoveLineUp = () => this.moveLineUp(view, index);\r\n\t\t\treturn (\r\n\t\t\t\t<List.Item key={index}>\r\n\t\t\t\t\t<Button compact negative icon=\"delete\" size=\"mini\" onClick={onDel} />\r\n\t\t\t\t\t{line}\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tcompact\r\n\t\t\t\t\t\tprimary\r\n\t\t\t\t\t\ticon=\"arrow down\"\r\n\t\t\t\t\t\tsize=\"mini\"\r\n\t\t\t\t\t\tfloated=\"right\"\r\n\t\t\t\t\t\tonClick={onMoveDown}\r\n\t\t\t\t\t\tdisabled={index >= view.state.lines.length - 1}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tcompact\r\n\t\t\t\t\t\tprimary\r\n\t\t\t\t\t\ticon=\"arrow up\"\r\n\t\t\t\t\t\tsize=\"mini\"\r\n\t\t\t\t\t\tfloated=\"right\"\r\n\t\t\t\t\t\tonClick={onMoveLineUp}\r\n\t\t\t\t\t\tdisabled={index <= 0}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</List.Item>\r\n\t\t\t);\r\n\t\t});\r\n\r\n\t\tconst action = {\r\n\t\t\tcolor: 'green',\r\n\t\t\ticon: 'plus',\r\n\t\t\tonClick: () => this.addLine(view)\r\n\t\t};\r\n\r\n\t\treturn (\r\n\t\t\t<>\r\n\t\t\t\t<List size=\"large\">{lines}</List>\r\n\t\t\t\t<Input\r\n\t\t\t\t\tname=\"newItem\"\r\n\t\t\t\t\tplaceholder={t('NewLine')}\r\n\t\t\t\t\tonChange={view.handleChange}\r\n\t\t\t\t\tvalue={view.state.newItem ? view.state.newItem : ''}\r\n\t\t\t\t\taction={action}\r\n\t\t\t\t/>\r\n\t\t\t</>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate onFocus = (e: React.SyntheticEvent<HTMLInputElement>) => {\r\n\t\t(e.target as any).select();\r\n\t};\r\n\r\n\tprivate addLine(view: DataViewRef<WebBooksBook>) {\r\n\t\tview.setState({\r\n\t\t\tlines: view.state.lines.concat(view.state.newItem),\r\n\t\t\tnewItem: ''\r\n\t\t});\r\n\t}\r\n\r\n\tprivate moveLineUp(view: DataViewRef<WebBooksBook>, index: number) {\r\n\t\tview.setState({\r\n\t\t\tlines: view.state.lines.map((line: string, i: number) =>\r\n\t\t\t\ti === index\r\n\t\t\t\t\t? view.state.lines[index - 1]\r\n\t\t\t\t\t: i === index - 1\r\n\t\t\t\t\t? view.state.lines[index]\r\n\t\t\t\t\t: line\r\n\t\t\t)\r\n\t\t});\r\n\t}\r\n\r\n\tprivate moveLineDown(view: DataViewRef<WebBooksBook>, index: number) {\r\n\t\tview.setState({\r\n\t\t\tlines: view.state.lines.map((line: string, i: number) =>\r\n\t\t\t\ti === index\r\n\t\t\t\t\t? view.state.lines[index + 1]\r\n\t\t\t\t\t: i === index + 1\r\n\t\t\t\t\t? view.state.lines[index]\r\n\t\t\t\t\t: line\r\n\t\t\t)\r\n\t\t});\r\n\t}\r\n\r\n\tprivate deleteLine(view: DataViewRef<WebBooksBook>, index: number) {\r\n\t\tview.setState({\r\n\t\t\tlines: view.state.lines.filter((line: string, i: number) => i !== index),\r\n\t\t\tnewItem: ''\r\n\t\t});\r\n\t}\r\n\r\n\tprivate copy(book: WebBooksBook) {\r\n\t\tcopy(this.props.apiUrl + '/api/v5/web-books/book/' + book.id + '/html');\r\n\t}\r\n}\r\n\r\nconst mapStateToProps = (state: AppState) => {\r\n\treturn {\r\n\t\tapiUrl: state.api.server.apiUrl\r\n\t};\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch: Dispatch<AppAction>) => {\r\n\treturn {};\r\n};\r\n\r\nexport default connect(\r\n\tmapStateToProps,\r\n\tmapDispatchToProps\r\n)(withTranslation('Integrations.WebBooks')(Books));\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/views/Integrations/WebBooks/Books.tsx","import * as _ from 'lodash';\r\nimport * as React from 'react';\r\nimport { withTranslation, WithTranslation } from 'react-i18next';\r\nimport { Header, Icon, SemanticICONS, Table } from 'semantic-ui-react';\r\n\r\nimport i18n from '../../services/i18n';\r\nimport { DataFieldRaw, DataTableRef, IdFunction } from '../../types';\r\nimport { handleChange, HandleChangeFunc } from '../Util';\r\n\r\nimport Pagination from './Pagination';\r\nimport TableHeader from './TableHeader';\r\nimport TableRow from './TableRow';\r\n\r\nconst ITEMS_PER_PAGE = 20;\r\n\r\nexport type DataTableFields<T> = {\r\n\t[key: string]: DataFieldRaw<T>;\r\n};\r\n\r\nexport interface Props<T> {\r\n\ttitle?: string;\r\n\ticon?: SemanticICONS;\r\n\tlist: T[];\r\n\tcanEdit?: (data: T) => boolean;\r\n\tcanDelete?: (data: T) => boolean;\r\n\tfields: DataTableFields<T>;\r\n\tactions?: (data: T, view: DataTableRef) => JSX.Element | undefined;\r\n\tonEdit?: (data: T | undefined, view: DataTableRef) => void;\r\n\tonSave?: (data: T, newData: any, view: DataTableRef) => void;\r\n\tonDelete?: (data: T, view: DataTableRef) => void;\r\n\tidFunc: IdFunction<T>;\r\n\tisEditing: (data: T) => boolean;\r\n}\r\n\r\ninterface AllProps<T> extends Props<T>, WithTranslation {}\r\n\r\ninterface OwnState {\r\n\tpage: number;\r\n\tnewData: any;\r\n}\r\n\r\nclass DataTable<T> extends React.Component<AllProps<T>, OwnState> {\r\n\tprivate handleChange: HandleChangeFunc;\r\n\r\n\tpublic constructor(props: AllProps<T>) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.state = {\r\n\t\t\tpage: 0,\r\n\t\t\tnewData: {}\r\n\t\t};\r\n\r\n\t\tthis.changePage = this.changePage.bind(this);\r\n\t\tthis.doHandleChange = this.doHandleChange.bind(this);\r\n\t\tthis.handleChange = handleChange.bind(this, this.doHandleChange);\r\n\t}\r\n\r\n\tprivate doHandleChange(key: string, value: string) {\r\n\t\tthis.setState({\r\n\t\t\tnewData: {\r\n\t\t\t\t...this.state.newData,\r\n\t\t\t\t[key]: value\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprivate changePage = (event: React.MouseEvent<HTMLElement>, page: number) => {\r\n\t\tevent.preventDefault();\r\n\r\n\t\tthis.setState({\r\n\t\t\tpage: page\r\n\t\t});\r\n\t};\r\n\r\n\tprivate onEdit = (obj: T | undefined, view: DataTableRef): void => {\r\n\t\tconst newData = {};\r\n\t\tif (obj) {\r\n\t\t\tObject.keys(this.props.fields).forEach(name => {\r\n\t\t\t\tif (!this.props.fields[name].edit) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tnewData[name] = _.get(obj, name);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tthis.setState({\r\n\t\t\tnewData: newData\r\n\t\t});\r\n\r\n\t\tif (this.props.onEdit) {\r\n\t\t\tthis.props.onEdit(obj, view);\r\n\t\t}\r\n\t};\r\n\r\n\tpublic shouldComponentUpdate(nextProps: Props<T>, nextState: OwnState) {\r\n\t\treturn (\r\n\t\t\tnextProps.fields !== this.props.fields ||\r\n\t\t\tnextProps.list !== this.props.list ||\r\n\t\t\tnextState.page !== this.state.page ||\r\n\t\t\tnextState.newData !== this.state.newData\r\n\t\t);\r\n\t}\r\n\r\n\tpublic render() {\r\n\t\tconst { list, canEdit, canDelete, actions } = this.props;\r\n\t\tconst fields = Object.keys(this.props.fields)\r\n\t\t\t.map(f => this.props.fields[f])\r\n\t\t\t.filter(f => f.view);\r\n\r\n\t\tconst maxPage = Math.ceil(list.length / ITEMS_PER_PAGE);\r\n\t\tconst page = Math.min(this.state.page, maxPage - 1);\r\n\r\n\t\tconst _t = this.props.t;\r\n\t\tconst editable = _.some(list, canEdit);\r\n\t\tconst deletable = _.some(list, canDelete);\r\n\r\n\t\treturn (\r\n\t\t\t<div style={{ marginTop: '2em' }}>\r\n\t\t\t\t{this.renderHeader()}\r\n\r\n\t\t\t\t<Table striped={true} stackable>\r\n\t\t\t\t\t<TableHeader\r\n\t\t\t\t\t\tfields={fields}\r\n\t\t\t\t\t\thasActions={typeof actions !== typeof undefined}\r\n\t\t\t\t\t\tcanEdit={editable}\r\n\t\t\t\t\t\tcanDelete={deletable}\r\n\t\t\t\t\t\ti18n={i18n}\r\n\t\t\t\t\t\tt={_t}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<Table.Body>{this.renderRows(fields, page)}</Table.Body>\r\n\t\t\t\t</Table>\r\n\t\t\t\t<Pagination\r\n\t\t\t\t\tpage={page}\r\n\t\t\t\t\tmaxPage={maxPage}\r\n\t\t\t\t\tchangePage={this.changePage}\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate renderHeader() {\r\n\t\tconst { icon, title } = this.props;\r\n\r\n\t\tif (!title) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<Header>\r\n\t\t\t\t<Icon fitted name={icon} /> {title}\r\n\t\t\t</Header>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate renderRows(fields: DataFieldRaw<T>[], page: number) {\r\n\t\tconst { list, canEdit, canDelete, actions, t } = this.props;\r\n\r\n\t\tconst listPage = list.slice(\r\n\t\t\tpage * ITEMS_PER_PAGE,\r\n\t\t\t(page + 1) * ITEMS_PER_PAGE\r\n\t\t);\r\n\r\n\t\tconst thisRef: DataTableRef = {\r\n\t\t\thandleChange: this.handleChange,\r\n\t\t\tstate: this.state.newData,\r\n\t\t\tsetState: (changes: object) =>\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\tnewData: { ...this.state.newData, ...changes }\r\n\t\t\t\t})\r\n\t\t};\r\n\r\n\t\tconst editable = _.some(list, canEdit);\r\n\t\tconst deletable = _.some(list, canDelete);\r\n\r\n\t\treturn listPage.map((obj, i) => (\r\n\t\t\t<TableRow\r\n\t\t\t\tkey={this.props.idFunc(obj)}\r\n\t\t\t\tobj={obj}\r\n\t\t\t\ttableRef={thisRef}\r\n\t\t\t\tactionable={editable || deletable}\r\n\t\t\t\tcanEdit={canEdit}\r\n\t\t\t\tcanDelete={canDelete}\r\n\t\t\t\tediting={this.props.isEditing(obj)}\r\n\t\t\t\tfields={fields}\r\n\t\t\t\tonEdit={this.onEdit}\r\n\t\t\t\tonSave={this.props.onSave}\r\n\t\t\t\tonDelete={this.props.onDelete}\r\n\t\t\t\tactions={actions}\r\n\t\t\t\tnewData={this.state.newData}\r\n\t\t\t\thandleChange={this.handleChange}\r\n\t\t\t\ti18n={i18n}\r\n\t\t\t\tt={t}\r\n\t\t\t/>\r\n\t\t));\r\n\t}\r\n}\r\n\r\nexport default withTranslation('DataTable')(DataTable);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/DataTable/index.tsx","import * as React from 'react';\r\nimport { Menu } from 'semantic-ui-react';\r\n\r\nexport interface Props {\r\n\tpage: number;\r\n\tmaxPage: number;\r\n\tchangePage: (event: React.MouseEvent<HTMLElement>, page: number) => void;\r\n}\r\n\r\nexport default class Pagination extends React.Component<Props> {\r\n\tpublic shouldComponentUpdate(nextProps: Props, nextState: any) {\r\n\t\treturn (\r\n\t\t\tnextProps.page !== this.props.page ||\r\n\t\t\tnextProps.maxPage !== this.props.maxPage\r\n\t\t);\r\n\t}\r\n\r\n\tpublic render() {\r\n\t\tif (this.props.maxPage <= 1) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<Menu pagination>\r\n\t\t\t\t{this.renderFirst()}\r\n\t\t\t\t{this.renderPrevMore()}\r\n\t\t\t\t{this.renderMain()}\r\n\t\t\t\t{this.renderNextMore()}\r\n\t\t\t\t{this.renderLast()}\r\n\t\t\t</Menu>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate renderFirst() {\r\n\t\tif (this.props.page <= 4) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\t// tslint:disable-next-line:jsx-no-lambda\r\n\t\treturn <Menu.Item onClick={e => this.props.changePage(e, 0)}>1</Menu.Item>;\r\n\t}\r\n\r\n\tprivate renderPrevMore() {\r\n\t\tif (this.props.page <= 5) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t// tslint:disable-next-line:jsx-no-lambda\r\n\t\t\t<Menu.Item onClick={e => this.props.changePage(e, this.props.page - 5)}>\r\n\t\t\t\t...\r\n\t\t\t</Menu.Item>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate renderMain() {\r\n\t\tconst { page, maxPage } = this.props;\r\n\t\tconst from = Math.max(0, page - 4);\r\n\t\tconst to = Math.min(maxPage, page + 5);\r\n\r\n\t\tconst pages = [];\r\n\t\tfor (let i = from; i < to; i++) {\r\n\t\t\tpages.push(i);\r\n\t\t}\r\n\r\n\t\treturn pages.map(p => (\r\n\t\t\t<Menu.Item\r\n\t\t\t\tkey={p}\r\n\t\t\t\t// tslint:disable-next-line:jsx-no-lambda\r\n\t\t\t\tonClick={e => this.props.changePage(e, p)}\r\n\t\t\t\tactive={p === page}\r\n\t\t\t>\r\n\t\t\t\t{p + 1}\r\n\t\t\t</Menu.Item>\r\n\t\t));\r\n\t}\r\n\r\n\tprivate renderNextMore() {\r\n\t\tif (this.props.page >= this.props.maxPage - 6) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t// tslint:disable-next-line:jsx-no-lambda\r\n\t\t\t<Menu.Item onClick={e => this.props.changePage(e, this.props.page + 5)}>\r\n\t\t\t\t...\r\n\t\t\t</Menu.Item>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate renderLast() {\r\n\t\tif (this.props.page >= this.props.maxPage - 5) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<Menu.Item\r\n\t\t\t\t// tslint:disable-next-line:jsx-no-lambda\r\n\t\t\t\tonClick={e => this.props.changePage(e, this.props.maxPage - 1)}\r\n\t\t\t>\r\n\t\t\t\t{this.props.maxPage}\r\n\t\t\t</Menu.Item>\r\n\t\t);\r\n\t}\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/DataTable/Pagination.tsx","import * as React from 'react';\r\nimport { WithTranslation } from 'react-i18next';\r\nimport { Table } from 'semantic-ui-react';\r\n\r\nimport { DataFieldRaw } from '../../types';\r\n\r\nexport interface Props<T> extends WithTranslation {\r\n\thasActions: boolean;\r\n\tcanEdit?: boolean;\r\n\tcanDelete?: boolean;\r\n\tfields: DataFieldRaw<T>[];\r\n}\r\n\r\nexport default class DataTableHeader<T> extends React.Component<Props<T>> {\r\n\tpublic shouldComponentUpdate(nextProps: Props<T>, nextState: any) {\r\n\t\treturn nextProps.fields !== this.props.fields;\r\n\t}\r\n\r\n\tpublic render() {\r\n\t\treturn (\r\n\t\t\t<Table.Header>\r\n\t\t\t\t<Table.Row>\r\n\t\t\t\t\t{this.renderFields()}\r\n\t\t\t\t\t{this.renderActions()}\r\n\t\t\t\t</Table.Row>\r\n\t\t\t</Table.Header>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate renderFields() {\r\n\t\treturn Object.keys(this.props.fields).map(name => {\r\n\t\t\tconst field = this.props.fields[name];\r\n\t\t\treturn (\r\n\t\t\t\t<Table.HeaderCell key={name}>\r\n\t\t\t\t\t{field.label ? field.label : '<' + field.name + '>'}\r\n\t\t\t\t</Table.HeaderCell>\r\n\t\t\t);\r\n\t\t});\r\n\t}\r\n\r\n\tprivate renderActions() {\r\n\t\tif (\r\n\t\t\t!this.props.hasActions &&\r\n\t\t\t!this.props.canEdit &&\r\n\t\t\t!this.props.canDelete\r\n\t\t) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn <Table.HeaderCell>{this.props.t('Actions')}</Table.HeaderCell>;\r\n\t}\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/DataTable/TableHeader.tsx","import * as React from 'react';\r\nimport { WithTranslation } from 'react-i18next';\r\nimport { Button, Dropdown, Form, Icon, Table } from 'semantic-ui-react';\r\n\r\nimport { DataFieldRaw, DataTableRef } from '../../types';\r\nimport { get, HandleChangeFunc } from '../Util';\r\n\r\nexport interface Props<T> extends WithTranslation {\r\n\tobj: T;\r\n\ttableRef: DataTableRef;\r\n\tactionable: boolean;\r\n\tcanEdit?: (data: T) => boolean;\r\n\tcanDelete?: (data: T) => boolean;\r\n\tediting: boolean;\r\n\tfields: DataFieldRaw<T>[];\r\n\tonEdit: (data: T | undefined, view: DataTableRef) => void;\r\n\tonSave?: (data: T, newData: any, view: DataTableRef) => void;\r\n\tonDelete?: (data: T, view: DataTableRef) => void;\r\n\tactions?: (data: T, view: DataTableRef) => JSX.Element | undefined;\r\n\thandleChange: HandleChangeFunc;\r\n\tnewData: any;\r\n}\r\n\r\nexport default class TableRow<T> extends React.Component<Props<T>> {\r\n\tpublic shouldComponentUpdate(nextProps: Props<T>, nextState: any) {\r\n\t\treturn (\r\n\t\t\tnextProps.obj !== this.props.obj ||\r\n\t\t\tnextProps.editing !== this.props.editing ||\r\n\t\t\tnextProps.fields !== this.props.fields ||\r\n\t\t\t(this.props.editing && nextProps.newData !== this.props.newData)\r\n\t\t);\r\n\t}\r\n\r\n\tprivate onSave = () => {\r\n\t\tconst { obj, tableRef } = this.props;\r\n\r\n\t\tif (this.props.onSave) {\r\n\t\t\tthis.props.onSave(obj, this.props.newData, tableRef);\r\n\t\t}\r\n\t};\r\n\r\n\tprivate onEditEmpty = () => {\r\n\t\tthis.props.onEdit(undefined, this.props.tableRef);\r\n\t};\r\n\r\n\tprivate onEdit = () => {\r\n\t\tthis.props.onEdit(this.props.obj, this.props.tableRef);\r\n\t};\r\n\r\n\tprivate onDelete = () => {\r\n\t\tif (this.props.onDelete) {\r\n\t\t\tthis.props.onDelete(this.props.obj, this.props.tableRef);\r\n\t\t}\r\n\t};\r\n\r\n\tpublic render() {\r\n\t\treturn (\r\n\t\t\t<Table.Row>\r\n\t\t\t\t{this.renderFields()}\r\n\t\t\t\t{this.renderActions()}\r\n\t\t\t</Table.Row>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate renderFields() {\r\n\t\tconst { fields } = this.props;\r\n\r\n\t\treturn fields.map((field, j) => (\r\n\t\t\t<Table.Cell key={j} collapsing={!field.wide}>\r\n\t\t\t\t{this.renderField(field)}\r\n\t\t\t</Table.Cell>\r\n\t\t));\r\n\t}\r\n\r\n\tprivate renderField(field: DataFieldRaw<T>) {\r\n\t\tconst { obj, editing, tableRef } = this.props;\r\n\r\n\t\treturn field.edit && editing\r\n\t\t\t? typeof field.edit === 'function'\r\n\t\t\t\t? field.edit(obj, tableRef)\r\n\t\t\t\t: this.renderEdit(obj, field)\r\n\t\t\t: typeof field.view === 'function'\r\n\t\t\t? field.view(obj, tableRef)\r\n\t\t\t: get(obj, field.name);\r\n\t}\r\n\r\n\tprivate renderEdit(obj: T, col: DataFieldRaw<T>) {\r\n\t\tif (col.options) {\r\n\t\t\treturn (\r\n\t\t\t\t<Form.Field\r\n\t\t\t\t\tfluid\r\n\t\t\t\t\tselection\r\n\t\t\t\t\tsearch\r\n\t\t\t\t\tcontrol={Dropdown}\r\n\t\t\t\t\tname={col.name}\r\n\t\t\t\t\tplaceholder={col.label}\r\n\t\t\t\t\toptions={col.options}\r\n\t\t\t\t\tvalue={this.props.newData[col.name]}\r\n\t\t\t\t\tonChange={this.props.handleChange}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<Form.Input\r\n\t\t\t\tname={col.name}\r\n\t\t\t\ttype={col.type ? col.type : 'text'}\r\n\t\t\t\tplaceholder={col.label}\r\n\t\t\t\tvalue={this.props.newData[col.name]}\r\n\t\t\t\tonChange={this.props.handleChange}\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate renderActions() {\r\n\t\tconst {\r\n\t\t\tactions,\r\n\t\t\tobj,\r\n\t\t\tactionable,\r\n\t\t\tcanEdit,\r\n\t\t\tcanDelete,\r\n\t\t\tediting,\r\n\t\t\ttableRef\r\n\t\t} = this.props;\r\n\r\n\t\tconst _canEdit = typeof canEdit === 'function' ? canEdit(obj) : canEdit;\r\n\t\tconst _canDelete =\r\n\t\t\ttypeof canDelete === 'function' ? canDelete(obj) : canEdit;\r\n\r\n\t\tif (!actions && !actionable) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tlet edit = null;\r\n\t\tif (_canEdit && editing) {\r\n\t\t\tedit = (\r\n\t\t\t\t<Table.Cell collapsing>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tprimary\r\n\t\t\t\t\t\tdisabled={(obj as any).updating}\r\n\t\t\t\t\t\tloading={(obj as any).updating}\r\n\t\t\t\t\t\tonClick={this.onSave}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Icon name=\"save\" /> {this.props.t('Save')}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tsecondary\r\n\t\t\t\t\t\tdisabled={(obj as any).updating}\r\n\t\t\t\t\t\tloading={(obj as any).updating}\r\n\t\t\t\t\t\tonClick={this.onEditEmpty}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Icon name=\"cancel\" /> {this.props.t('Cancel')}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</Table.Cell>\r\n\t\t\t);\r\n\t\t} else if (_canEdit) {\r\n\t\t\tedit = (\r\n\t\t\t\t<Table.Cell collapsing>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tprimary\r\n\t\t\t\t\t\tdisabled={(obj as any).updating}\r\n\t\t\t\t\t\tloading={(obj as any).updating}\r\n\t\t\t\t\t\tonClick={this.onEdit}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Icon name=\"edit\" /> {this.props.t('Edit')}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</Table.Cell>\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tlet del = null;\r\n\t\tif (_canDelete) {\r\n\t\t\tdel = (\r\n\t\t\t\t<Button\r\n\t\t\t\t\tnegative\r\n\t\t\t\t\tdisabled={(obj as any).updating}\r\n\t\t\t\t\tloading={(obj as any).updating}\r\n\t\t\t\t\tonClick={this.onDelete}\r\n\t\t\t\t>\r\n\t\t\t\t\t<Icon name=\"trash\" /> {this.props.t('Remove')}\r\n\t\t\t\t</Button>\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<Table.Cell collapsing>\r\n\t\t\t\t{edit}\r\n\t\t\t\t{del}\r\n\t\t\t\t{actions ? actions(obj, tableRef) : null}\r\n\t\t\t</Table.Cell>\r\n\t\t);\r\n\t}\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/DataTable/TableRow.tsx","import * as _ from 'lodash';\r\nimport * as React from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { Dispatch } from 'redux';\r\nimport { Grid, Segment } from 'semantic-ui-react';\r\n\r\nimport { AppAction } from '../../actions';\r\nimport {\r\n\trequestChange,\r\n\trequestCreate,\r\n\trequestDelete,\r\n\trequestDetails,\r\n\trequestList,\r\n\tsetFilter\r\n} from '../../actions/dataview';\r\nimport { DataViewState } from '../../reducers/dataview';\r\nimport {\r\n\tAppState,\r\n\tDataFieldRaw,\r\n\tDataTableRef,\r\n\tDataViewRef,\r\n\tIdFunction\r\n} from '../../types';\r\nimport CreateForm from '../CreateForm';\r\nimport DataTable, { Props as DataTableProps } from '../DataTable';\r\nimport FilterForm from '../FilterForm';\r\nimport { checkPermissions } from '../Util';\r\n\r\nimport {\r\n\tDispatchProps,\r\n\tFullProps,\r\n\tOwnProps,\r\n\tOwnState,\r\n\tStateProps\r\n} from './types';\r\nexport { DataViewFields } from './types';\r\n\r\nclass DataView<T> extends React.Component<FullProps<T>, OwnState<T>> {\r\n\tprivate interval: NodeJS.Timer;\r\n\r\n\tpublic constructor(props: FullProps<T>) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.state = {\r\n\t\t\tpage: 0,\r\n\t\t\tdata: undefined\r\n\t\t};\r\n\r\n\t\tthis.details = this.details.bind(this);\r\n\t\tthis.create = this.create.bind(this);\r\n\t\tthis.edit = this.edit.bind(this);\r\n\t\tthis.endEdit = this.endEdit.bind(this);\r\n\t\tthis.save = this.save.bind(this);\r\n\t\tthis.delete = this.delete.bind(this);\r\n\t}\r\n\r\n\tpublic componentDidMount() {\r\n\t\tif (!this.props.static) {\r\n\t\t\tthis.props.requestList();\r\n\t\t\tthis.interval = setInterval(this.props.requestList, 10000);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic componentWillUnmount() {\r\n\t\tif (this.interval) {\r\n\t\t\tclearInterval(this.interval);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic shouldComponentUpdate(\r\n\t\tnextProps: FullProps<T>,\r\n\t\tnextState: OwnState<T>\r\n\t) {\r\n\t\treturn (\r\n\t\t\tnextProps.creating !== this.props.creating ||\r\n\t\t\tnextProps.filter !== this.props.filter ||\r\n\t\t\tnextProps.fields !== this.props.fields ||\r\n\t\t\tnextProps.list !== this.props.list ||\r\n\t\t\tnextState.data !== this.state.data\r\n\t\t);\r\n\t}\r\n\r\n\t// Create a new data entry\r\n\tprivate create(data: T) {\r\n\t\tthis.props.requestCreate(data);\r\n\t}\r\n\r\n\t// Get the details for a data entry\r\n\tprivate details(data: T) {\r\n\t\tthis.props.requestDetails(data);\r\n\t}\r\n\r\n\t// Select a data entry for editing\r\n\tprivate edit(data: T | undefined) {\r\n\t\tthis.setState({ data });\r\n\t}\r\n\r\n\t// Save/Update an existing data entry\r\n\tprivate save(data: T, newData: any) {\r\n\t\tthis.props.requestChange(data, newData);\r\n\t\tthis.endEdit();\r\n\t}\r\n\r\n\t// End editing an entry\r\n\tprivate endEdit() {\r\n\t\tthis.setState({\r\n\t\t\tdata: undefined\r\n\t\t});\r\n\t}\r\n\r\n\t// Delete a data entry\r\n\tprivate delete(data: T) {\r\n\t\tthis.props.requestDelete(data);\r\n\t}\r\n\r\n\tpublic render() {\r\n\t\tconst { filter, title, createTitle, filterTitle } = this.props;\r\n\r\n\t\tconst checks: ((val: T) => boolean)[] = [];\r\n\t\tlet regsValid = false;\r\n\r\n\t\t// Get all the fields of the table\r\n\t\tconst fields: { [x: string]: DataFieldRaw<T> } = _.mapValues(\r\n\t\t\tthis.props.fields,\r\n\t\t\t(value, name) => {\r\n\t\t\t\tlet val: DataFieldRaw<T> = {\r\n\t\t\t\t\tname: name,\r\n\t\t\t\t\tview: true\r\n\t\t\t\t};\r\n\r\n\t\t\t\t// If the column is a string use that as the label\r\n\t\t\t\t// If the column is a function, use that function to display the cell\r\n\t\t\t\t// else if the column provides a view function then use that to display the cell\r\n\t\t\t\tif (typeof value === 'string') {\r\n\t\t\t\t\tval.label = value;\r\n\t\t\t\t} else if (typeof value === 'function') {\r\n\t\t\t\t\tval.view = (obj: T, tableRef: DataTableRef) =>\r\n\t\t\t\t\t\tvalue(obj, this.expandRef(tableRef));\r\n\t\t\t\t} else if (typeof value === 'object') {\r\n\t\t\t\t\tval = { ...val, ...value };\r\n\t\t\t\t\tif (typeof value.view === 'function') {\r\n\t\t\t\t\t\tconst func = value.view;\r\n\t\t\t\t\t\tval.view = (obj: T, tableRef: DataTableRef) =>\r\n\t\t\t\t\t\t\tfunc(obj, this.expandRef(tableRef));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn val;\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\t// Get all the fields for the create form\r\n\t\t// Get all the fields for the filter form\r\n\t\tconst createFields: { [x: string]: DataFieldRaw<T> } = {};\r\n\t\tconst filterFields: { [x: string]: DataFieldRaw<T> } = {};\r\n\t\tObject.keys(fields).forEach(f => {\r\n\t\t\tif (fields[f].create) {\r\n\t\t\t\tcreateFields[f] = fields[f];\r\n\t\t\t}\r\n\t\t\tif (fields[f].filter) {\r\n\t\t\t\tfilterFields[f] = fields[f];\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\ttry {\r\n\t\t\tObject.keys(filter).forEach(name => {\r\n\t\t\t\tconst value = filter[name];\r\n\r\n\t\t\t\t// Get the filter field according to the filterName if specified,\r\n\t\t\t\t// otherwise just the name\r\n\t\t\t\tconst ff =\r\n\t\t\t\t\tObject.keys(filterFields)\r\n\t\t\t\t\t\t.map(f => filterFields[f])\r\n\t\t\t\t\t\t.find(f => f.filterName === name) || filterFields[name];\r\n\r\n\t\t\t\t// If we have a filterValue function then use that as the value for the check\r\n\t\t\t\tlet val = (dataVal: T) => _.get(dataVal, name);\r\n\t\t\t\tif (typeof ff.filterValue === 'function') {\r\n\t\t\t\t\tval = ff.filterValue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// If it is an array then we need to check if the value is in the array\r\n\t\t\t\t// Otherwise just use a normal regex check\r\n\t\t\t\tif (_.isArray(value)) {\r\n\t\t\t\t\tif (value.length === 0) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tchecks.push((dataVal: T) => {\r\n\t\t\t\t\t\tconst v = val(dataVal);\r\n\t\t\t\t\t\treturn value.indexOf(v) >= 0;\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tchecks.push((dataVal: T) =>\r\n\t\t\t\t\t\tnew RegExp(value, 'i').test(val(dataVal))\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tregsValid = true;\r\n\t\t} catch {\r\n\t\t\tregsValid = false;\r\n\t\t}\r\n\r\n\t\t// Filter out the values according to the filters\r\n\t\t// If the regex isn't valid then we don't want to filter\r\n\t\tconst list = this.props.list.filter(data => {\r\n\t\t\treturn !regsValid || checks.every(check => check(data));\r\n\t\t});\r\n\r\n\t\t// Check how many columns we need for the create and filter form\r\n\t\tconst cols = createTitle && filterTitle ? 2 : 1;\r\n\r\n\t\t// Wrap the provided actions if we have any\r\n\t\tconst origActions = this.props.actions;\r\n\t\tlet actions = origActions;\r\n\t\tif (typeof origActions === 'function') {\r\n\t\t\tactions = (obj, tableRef) => origActions(obj, this.expandRef(tableRef));\r\n\t\t}\r\n\r\n\t\tconst DT = this.createTable();\r\n\r\n\t\tconst createForm = this.renderCreateForm(createTitle, createFields);\r\n\t\tconst filterForm = this.renderFilterForm(\r\n\t\t\tfilterTitle,\r\n\t\t\tfilterFields,\r\n\t\t\tregsValid\r\n\t\t);\r\n\r\n\t\treturn (\r\n\t\t\t<Segment basic>\r\n\t\t\t\t<Grid stackable doubling columns={cols}>\r\n\t\t\t\t\t{createForm}\r\n\t\t\t\t\t{filterForm}\r\n\t\t\t\t</Grid>\r\n\r\n\t\t\t\t<DT\r\n\t\t\t\t\ttitle={title}\r\n\t\t\t\t\ticon={this.props.icon}\r\n\t\t\t\t\tlist={list}\r\n\t\t\t\t\tidFunc={this.props.idFunc}\r\n\t\t\t\t\tfields={fields}\r\n\t\t\t\t\tonEdit={this.onEdit}\r\n\t\t\t\t\tonSave={this.onSave}\r\n\t\t\t\t\tonDelete={this.onDelete}\r\n\t\t\t\t\tcanEdit={this.canEdit}\r\n\t\t\t\t\tcanDelete={this.canDelete}\r\n\t\t\t\t\tactions={actions}\r\n\t\t\t\t\tisEditing={this.isEditing}\r\n\t\t\t\t/>\r\n\t\t\t</Segment>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate createTable() {\r\n\t\treturn DataTable as React.ComponentClass<DataTableProps<T>>;\r\n\t}\r\n\r\n\tprivate expandRef = (tableRef: DataTableRef): DataViewRef<T> => ({\r\n\t\t...tableRef,\r\n\t\tcreate: this.create,\r\n\t\tdetails: this.details,\r\n\t\tsave: this.save,\r\n\t\tedit: this.edit,\r\n\t\tendEdit: this.endEdit,\r\n\t\tdelete: this.delete\r\n\t});\r\n\r\n\tprivate onCreate = (obj: T, tableRef: DataTableRef) => {\r\n\t\tthis.props.onCreate\r\n\t\t\t? this.props.onCreate(obj, this.expandRef(tableRef))\r\n\t\t\t: this.create(obj);\r\n\t};\r\n\r\n\tprivate onEdit = (obj: T, tableRef: DataTableRef) => {\r\n\t\tthis.props.onEdit\r\n\t\t\t? this.props.onEdit(obj, this.expandRef(tableRef))\r\n\t\t\t: this.edit(obj);\r\n\t};\r\n\r\n\tprivate onSave = (obj: T, newObj: any, tableRef: DataTableRef) => {\r\n\t\tthis.props.onSave\r\n\t\t\t? this.props.onSave(obj, newObj, this.expandRef(tableRef))\r\n\t\t\t: this.save(obj, newObj);\r\n\t};\r\n\r\n\tprivate onDelete = (obj: T, tableRef: DataTableRef) => {\r\n\t\tthis.props.onDelete\r\n\t\t\t? this.props.onDelete(obj, this.expandRef(tableRef))\r\n\t\t\t: this.delete(obj);\r\n\t};\r\n\r\n\tprivate canEdit = (obj: T) => {\r\n\t\tconst { canEdit, perms, perm } = this.props;\r\n\t\treturn (\r\n\t\t\t(typeof canEdit === 'function' ? canEdit(obj) : !!canEdit) &&\r\n\t\t\tcheckPermissions(perms, perm.concat('modify'))\r\n\t\t);\r\n\t};\r\n\r\n\tprivate canDelete = (obj: T) => {\r\n\t\tconst { canDelete, perms, perm } = this.props;\r\n\t\treturn (\r\n\t\t\t(typeof canDelete === 'function' ? canDelete(obj) : !!canDelete) &&\r\n\t\t\tcheckPermissions(perms, perm.concat('delete'))\r\n\t\t);\r\n\t};\r\n\r\n\tprivate isEditing = (obj: T) => this.props.equals(obj, this.state.data);\r\n\r\n\tprivate renderCreateForm(\r\n\t\tcreateTitle: string | undefined,\r\n\t\tcreateFields: { [x: string]: DataFieldRaw<T> }\r\n\t) {\r\n\t\tconst { checkCreatePerm, perms, perm, createButton, creating } = this.props;\r\n\t\tif (\r\n\t\t\t!createTitle ||\r\n\t\t\t(checkCreatePerm && !checkPermissions(perms, perm.concat('create')))\r\n\t\t) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<Grid.Column>\r\n\t\t\t\t<CreateForm\r\n\t\t\t\t\ttitle={createTitle}\r\n\t\t\t\t\tbutton={createButton}\r\n\t\t\t\t\tcreating={creating}\r\n\t\t\t\t\tfields={createFields}\r\n\t\t\t\t\tonCreate={this.onCreate}\r\n\t\t\t\t/>\r\n\t\t\t</Grid.Column>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate renderFilterForm(\r\n\t\tfilterTitle: string | undefined,\r\n\t\tfilterFields: { [x: string]: DataFieldRaw<T> },\r\n\t\tregsValid: boolean\r\n\t) {\r\n\t\tif (!filterTitle) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<Grid.Column>\r\n\t\t\t\t<FilterForm\r\n\t\t\t\t\ttitle={filterTitle}\r\n\t\t\t\t\tfields={filterFields}\r\n\t\t\t\t\tvalid={regsValid}\r\n\t\t\t\t\tvalues={this.props.filter}\r\n\t\t\t\t\tonFilterChange={this.props.setFilter}\r\n\t\t\t\t/>\r\n\t\t\t</Grid.Column>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nfunction mapStateToProps<T>(endpoint: string, id: IdFunction<T>) {\r\n\treturn (_state: AppState, ownProps: OwnProps<T>) => {\r\n\t\tconst state: DataViewState<T> = _.get(\r\n\t\t\t_state,\r\n\t\t\tendpoint.replace(/\\//g, '_').replace('-', '')\r\n\t\t);\r\n\r\n\t\treturn {\r\n\t\t\tcreating: state ? state.creating : false,\r\n\t\t\tfilter: state && state.filter ? state.filter : {},\r\n\t\t\tlist: state ? state.list : [],\r\n\t\t\ttypes: _state.api.types,\r\n\t\t\tidFunc: id,\r\n\t\t\tperm: endpoint.split('/'),\r\n\t\t\tperms: _state.api.permissions\r\n\t\t};\r\n\t};\r\n}\r\n\r\nfunction mapDispatchToProps<T>(\r\n\tendpoint: string,\r\n\tid: IdFunction<T>,\r\n\tnoDetails: boolean\r\n) {\r\n\treturn (dispatch: Dispatch<AppAction>) => {\r\n\t\treturn {\r\n\t\t\trequestList: () => dispatch(requestList(endpoint, !noDetails)),\r\n\t\t\trequestDetails: (data: T) => dispatch(requestDetails(endpoint, id, data)),\r\n\t\t\trequestCreate: (data: T) => dispatch(requestCreate(endpoint, id, data)),\r\n\t\t\trequestChange: (data: T, newData: object) =>\r\n\t\t\t\tdispatch(requestChange(endpoint, id, data, newData)),\r\n\t\t\trequestDelete: (data: T) => dispatch(requestDelete(endpoint, id, data)),\r\n\t\t\tsetFilter: (filter: string, value: string) =>\r\n\t\t\t\tdispatch(setFilter(endpoint, filter, value)),\r\n\t\t\tequals: (o1: T, o2: T) => o1 != null && o2 != null && id(o1) === id(o2)\r\n\t\t};\r\n\t};\r\n}\r\n\r\nexport default function createDataView<T>(\r\n\tendpoint: string,\r\n\tobjId: string | IdFunction<T>,\r\n\tnoDetails?: boolean\r\n) {\r\n\tif (!objId) {\r\n\t\tobjId = 'id';\r\n\t}\r\n\tconst id =\r\n\t\ttypeof objId === 'function'\r\n\t\t\t? objId\r\n\t\t\t: (data: T) => _.get(data, objId as string);\r\n\r\n\treturn connect<StateProps<T>, DispatchProps<T>, OwnProps<T>, AppState>(\r\n\t\tmapStateToProps<T>(endpoint, id),\r\n\t\tmapDispatchToProps<T>(endpoint, id, noDetails ? true : false)\r\n\t)(DataView as any);\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/DataView/index.tsx","import * as _ from 'lodash';\r\nimport * as React from 'react';\r\nimport { withTranslation, WithTranslation } from 'react-i18next';\r\nimport { Accordion, Button, Dropdown, Form, Icon } from 'semantic-ui-react';\r\n\r\nimport { DataFieldGroup, DataFieldRaw, DataTableRef } from '../../types';\r\nimport { handleChange, HandleChangeFunc } from '../Util';\r\n\r\nexport interface Props<T> extends WithTranslation {\r\n\ttitle: string;\r\n\tcreating: boolean;\r\n\tonCreate: (data: any, view: DataTableRef) => void;\r\n\tbutton?: string;\r\n\tfields: {\r\n\t\t[x: string]: DataFieldRaw<T>;\r\n\t};\r\n}\r\n\r\ninterface OwnState {\r\n\topen: boolean;\r\n\tnewData: any;\r\n}\r\n\r\nclass CreateForm<T> extends React.Component<Props<T>, OwnState> {\r\n\tprivate handleChange: HandleChangeFunc;\r\n\r\n\tpublic constructor(props: Props<T>) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.state = {\r\n\t\t\topen: false,\r\n\t\t\tnewData: {}\r\n\t\t};\r\n\r\n\t\tthis.doHandleChange = this.doHandleChange.bind(this);\r\n\t\tthis.handleChange = handleChange.bind(this, this.doHandleChange);\r\n\t\tthis.create = this.create.bind(this);\r\n\t}\r\n\r\n\tprivate doHandleChange(key: string, value: string) {\r\n\t\tthis.setState({\r\n\t\t\tnewData: {\r\n\t\t\t\t...this.state.newData,\r\n\t\t\t\t[key]: value\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic shouldComponentUpdate(nextProps: Props<T>, nextState: OwnState) {\r\n\t\treturn (\r\n\t\t\tnextProps.creating !== this.props.creating ||\r\n\t\t\tnextProps.fields !== this.props.fields ||\r\n\t\t\tnextState.newData !== this.state.newData ||\r\n\t\t\tnextState.open !== this.state.open\r\n\t\t);\r\n\t}\r\n\r\n\tprivate create() {\r\n\t\tconst data = {};\r\n\t\tObject.keys(this.state.newData).forEach(key => {\r\n\t\t\t_.set(data, key, this.state.newData[key]);\r\n\t\t});\r\n\r\n\t\tthis.props.onCreate(data, {\r\n\t\t\tstate: this.state.newData,\r\n\t\t\tsetState: this.setState,\r\n\t\t\thandleChange: this.handleChange\r\n\t\t});\r\n\t}\r\n\r\n\tprivate canCreate(): boolean {\r\n\t\treturn Object.keys(this.props.fields).every(name => {\r\n\t\t\tconst field = this.props.fields[name];\r\n\t\t\tconst key = field.createName ? field.createName : name;\r\n\t\t\treturn (\r\n\t\t\t\ttypeof field === 'string' || !field.required || this.state.newData[key]\r\n\t\t\t);\r\n\t\t});\r\n\t}\r\n\r\n\tprivate handleClick = () => {\r\n\t\tthis.setState({\r\n\t\t\topen: !this.state.open\r\n\t\t});\r\n\t};\r\n\r\n\tpublic render() {\r\n\t\tconst { title, creating } = this.props;\r\n\r\n\t\tconst _t = this.props.t;\r\n\r\n\t\treturn (\r\n\t\t\t<Accordion styled fluid>\r\n\t\t\t\t<Accordion.Title active={this.state.open} onClick={this.handleClick}>\r\n\t\t\t\t\t<Icon fitted name=\"plus\" /> {title}\r\n\t\t\t\t</Accordion.Title>\r\n\r\n\t\t\t\t<Accordion.Content active={this.state.open}>\r\n\t\t\t\t\t<Form loading={creating}>\r\n\t\t\t\t\t\t{this.renderFieldGroups()}\r\n\r\n\t\t\t\t\t\t<Button primary onClick={this.create} disabled={!this.canCreate()}>\r\n\t\t\t\t\t\t\t{this.props.button || _t('Create')}\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t</Form>\r\n\t\t\t\t</Accordion.Content>\r\n\t\t\t</Accordion>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate renderFieldGroups() {\r\n\t\tconst fieldGroups: DataFieldGroup<T>[] = [];\r\n\t\tObject.keys(this.props.fields).forEach(name => {\r\n\t\t\tconst field = this.props.fields[name];\r\n\t\t\tconst newField: DataFieldRaw<T> = {\r\n\t\t\t\t...field,\r\n\t\t\t\tname: field.createName ? field.createName : name\r\n\t\t\t};\r\n\r\n\t\t\tif (newField.isGroup) {\r\n\t\t\t\tfieldGroups.push({ only: newField });\r\n\t\t\t} else if (\r\n\t\t\t\tfieldGroups.length &&\r\n\t\t\t\t!fieldGroups[fieldGroups.length - 1].second\r\n\t\t\t) {\r\n\t\t\t\tfieldGroups[fieldGroups.length - 1].second = newField;\r\n\t\t\t} else {\r\n\t\t\t\tfieldGroups.push({ first: newField });\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn fieldGroups.map((fg, i) => {\r\n\t\t\tif (fg.only) {\r\n\t\t\t\treturn <div key={i}>{this.renderField(fg.only)}</div>;\r\n\t\t\t}\r\n\r\n\t\t\treturn (\r\n\t\t\t\t<Form.Group key={i} widths=\"equal\">\r\n\t\t\t\t\t{fg.first && this.renderField(fg.first)}\r\n\r\n\t\t\t\t\t{fg.second && this.renderField(fg.second)}\r\n\t\t\t\t</Form.Group>\r\n\t\t\t);\r\n\t\t});\r\n\t}\r\n\r\n\tprivate renderField(field: DataFieldRaw<T>) {\r\n\t\tconst state = this.state.newData;\r\n\r\n\t\tif (typeof field.create === 'function') {\r\n\t\t\treturn field.create({\r\n\t\t\t\tstate: state,\r\n\t\t\t\tsetState: this.setState,\r\n\t\t\t\thandleChange: this.handleChange,\r\n\t\t\t\tvalue: state[field.name]\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (field.options) {\r\n\t\t\treturn (\r\n\t\t\t\t<Form.Field\r\n\t\t\t\t\tfluid={true}\r\n\t\t\t\t\tselection={true}\r\n\t\t\t\t\tsearch={true}\r\n\t\t\t\t\trequired={field.required}\r\n\t\t\t\t\tcontrol={Dropdown}\r\n\t\t\t\t\tname={field.name}\r\n\t\t\t\t\tlabel={field.label}\r\n\t\t\t\t\tplaceholder={field.label}\r\n\t\t\t\t\tonChange={this.handleChange}\r\n\t\t\t\t\tvalue={state[field.name]}\r\n\t\t\t\t\toptions={field.options}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<Form.Input\r\n\t\t\t\trequired={field.required}\r\n\t\t\t\ttype={field.type ? field.type : 'text'}\r\n\t\t\t\tname={field.name}\r\n\t\t\t\tlabel={field.label}\r\n\t\t\t\tplaceholder={field.label}\r\n\t\t\t\tonChange={this.handleChange}\r\n\t\t\t\tvalue={state[field.name]}\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default withTranslation('CreateForm')(CreateForm);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/CreateForm/index.tsx","import * as _ from 'lodash';\r\nimport * as React from 'react';\r\nimport { Accordion, Dropdown, Form, Icon, Message } from 'semantic-ui-react';\r\n\r\nimport { DataFieldGroup, DataFieldRaw } from '../../types';\r\nimport { handleChange, HandleChangeFunc } from '../Util';\r\n\r\nexport interface Props<T> {\r\n\ttitle: string;\r\n\tvalid: boolean;\r\n\tfields: {\r\n\t\t[x: string]: DataFieldRaw<T>;\r\n\t};\r\n\tvalues: {\r\n\t\t[x: string]: string | string[];\r\n\t};\r\n\tonFilterChange: (key: string, value: string) => void;\r\n}\r\n\r\ninterface State {\r\n\topen: boolean;\r\n}\r\n\r\nclass FilterForm<T> extends React.Component<Props<T>, State> {\r\n\tprivate handleChange: HandleChangeFunc;\r\n\r\n\tpublic constructor(props: Props<T>) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.state = {\r\n\t\t\topen: false\r\n\t\t};\r\n\r\n\t\tthis.handleChange = handleChange.bind(this, this.props.onFilterChange);\r\n\t}\r\n\r\n\tpublic shouldComponentUpdate(nextProps: Props<T>, nextState: State) {\r\n\t\treturn (\r\n\t\t\tnextProps.values !== this.props.values ||\r\n\t\t\tnextProps.fields !== this.props.fields ||\r\n\t\t\tnextProps.valid !== this.props.valid ||\r\n\t\t\tnextState.open !== this.state.open\r\n\t\t);\r\n\t}\r\n\r\n\tprivate handleClick = () => {\r\n\t\tthis.setState({\r\n\t\t\topen: !this.state.open\r\n\t\t});\r\n\t};\r\n\r\n\tpublic render() {\r\n\t\tconst { title, fields, values, valid } = this.props;\r\n\r\n\t\tconst fieldGroups: DataFieldGroup<T>[] = [];\r\n\t\tObject.keys(fields).forEach(name => {\r\n\t\t\tconst field = fields[name];\r\n\t\t\tconst newField: DataFieldRaw<T> = {\r\n\t\t\t\t...field,\r\n\t\t\t\tname: field.filterName ? field.filterName : name\r\n\t\t\t};\r\n\r\n\t\t\tif (newField.isGroup) {\r\n\t\t\t\tfieldGroups.push({ only: newField });\r\n\t\t\t} else if (\r\n\t\t\t\tfieldGroups.length &&\r\n\t\t\t\t!fieldGroups[fieldGroups.length - 1].second\r\n\t\t\t) {\r\n\t\t\t\tfieldGroups[fieldGroups.length - 1].second = newField;\r\n\t\t\t} else {\r\n\t\t\t\tfieldGroups.push({ first: newField });\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tconst fs = fieldGroups.map((fg, i) => {\r\n\t\t\tif (fg.only) {\r\n\t\t\t\treturn this.renderField(fg.only, _.get(values, fg.only.name), !valid);\r\n\t\t\t}\r\n\r\n\t\t\tconst first = fg.first\r\n\t\t\t\t? this.renderField(fg.first, _.get(values, fg.first.name), !valid)\r\n\t\t\t\t: null;\r\n\t\t\tconst second = fg.second\r\n\t\t\t\t? this.renderField(fg.second, _.get(values, fg.second.name), !valid)\r\n\t\t\t\t: null;\r\n\r\n\t\t\treturn (\r\n\t\t\t\t<Form.Group key={i} widths=\"equal\">\r\n\t\t\t\t\t{first}\r\n\t\t\t\t\t{second}\r\n\t\t\t\t</Form.Group>\r\n\t\t\t);\r\n\t\t});\r\n\r\n\t\treturn (\r\n\t\t\t<Accordion styled fluid>\r\n\t\t\t\t<Accordion.Title active={this.state.open} onClick={this.handleClick}>\r\n\t\t\t\t\t<Icon name=\"filter\" fitted /> {title}\r\n\t\t\t\t</Accordion.Title>\r\n\r\n\t\t\t\t<Accordion.Content active={this.state.open}>\r\n\t\t\t\t\t<Form>\r\n\t\t\t\t\t\t{fs}\r\n\t\t\t\t\t\t<Message\r\n\t\t\t\t\t\t\terror\r\n\t\t\t\t\t\t\tvisible={!valid}\r\n\t\t\t\t\t\t\tcontent=\"Search term must be a valid regex\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form>\r\n\t\t\t\t</Accordion.Content>\r\n\t\t\t</Accordion>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate renderField(\r\n\t\tfield: DataFieldRaw<T>,\r\n\t\tvalue: string | string[],\r\n\t\terror: boolean\r\n\t) {\r\n\t\tif (typeof field.filter === 'function') {\r\n\t\t\treturn field.filter({\r\n\t\t\t\tstate: this.props.values,\r\n\t\t\t\tsetState: this.setState,\r\n\t\t\t\thandleChange: this.handleChange,\r\n\t\t\t\tvalue: value\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (field.options) {\r\n\t\t\tif (!value) {\r\n\t\t\t\tvalue = [];\r\n\t\t\t}\r\n\r\n\t\t\treturn (\r\n\t\t\t\t<Form.Field\r\n\t\t\t\t\tfluid\r\n\t\t\t\t\tselection\r\n\t\t\t\t\tsearch\r\n\t\t\t\t\tmultiple\r\n\t\t\t\t\tcontrol={Dropdown}\r\n\t\t\t\t\tname={field.name}\r\n\t\t\t\t\tlabel={field.label}\r\n\t\t\t\t\tplaceholder={field.label}\r\n\t\t\t\t\toptions={field.options}\r\n\t\t\t\t\tvalue={value}\r\n\t\t\t\t\terror={error}\r\n\t\t\t\t\tonChange={this.handleChange}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<Form.Input\r\n\t\t\t\tname={field.name}\r\n\t\t\t\ttype={field.type ? field.type : 'text'}\r\n\t\t\t\tlabel={field.label}\r\n\t\t\t\tplaceholder={field.label}\r\n\t\t\t\tvalue={value}\r\n\t\t\t\terror={error}\r\n\t\t\t\tonChange={this.handleChange}\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default FilterForm;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/FilterForm/index.tsx"],"sourceRoot":""}