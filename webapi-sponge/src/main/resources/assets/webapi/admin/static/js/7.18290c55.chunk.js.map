{"version":3,"sources":["views/Integrations/VillagerShops/ShopItem.tsx","views/Integrations/VillagerShops/Shops.tsx","components/DataTable/index.tsx","components/DataTable/Pagination.tsx","components/DataTable/TableHeader.tsx","components/DataTable/TableRow.tsx","components/DataView/index.tsx","components/CreateForm/index.tsx","components/FilterForm/index.tsx"],"names":["ShopItem","_super","_this","apply","this","arguments","onChange","e","val","props","item","onRemove","__extends","prototype","render","_a","t","__WEBPACK_IMPORTED_MODULE_0_react__","__WEBPACK_IMPORTED_MODULE_1_semantic_ui_react__","Row","Cell","collapsing","Field","selection","search","control","name","placeholder","value","type","id","options","Object","__WEBPACK_IMPORTED_MODULE_2__components_Util__","itemTypes","fluid","quantity","buyPrice","sellPrice","currency","currencies","stock","maxStock","negative","icon","content","onClick","__webpack_exports__","DataView","__WEBPACK_IMPORTED_MODULE_6__components_DataView__","Shops","call","handleItemChange","event","data","__WEBPACK_IMPORTED_MODULE_7__components_Util__","newItem","__WEBPACK_IMPORTED_MODULE_0_lodash__","setState","items","state","map","i","removeItem","filter","modal","toggleModal","bind","handleEdit","handleChange","addItem","componentDidMount","requestCatalog","__WEBPACK_IMPORTED_MODULE_9__types__","Entity","Item","Currency","fields","uid","label","entityType","view","shop","entityTypes","__WEBPACK_IMPORTED_MODULE_1_react__","canEdit","canDelete","title","filterTitle","onEdit","renderModal","__WEBPACK_IMPORTED_MODULE_10__ShopItem__","key","i18n","__WEBPACK_IMPORTED_MODULE_8__services_i18n__","__WEBPACK_IMPORTED_MODULE_4_semantic_ui_react__","open","onClose","size","className","Header","__WEBPACK_IMPORTED_MODULE_2_react_i18next__","i18nKey","Content","fitted","Group","widths","Input","required","HeaderCell","Body","colSpan","textAlign","positive","Actions","primary","save","secondary","stockItems","undefined","link","__rest","__assign","hasStock","shopId","concat","__WEBPACK_IMPORTED_MODULE_3_react_redux__","api","types","dispatch","__WEBPACK_IMPORTED_MODULE_5__actions__","DataTable","changePage","page","preventDefault","obj","newData","keys","forEach","edit","doHandleChange","__WEBPACK_IMPORTED_MODULE_5__Util__","shouldComponentUpdate","nextProps","nextState","list","actions","f","maxPage","Math","ceil","length","min","_t","editable","deletable","style","marginTop","renderHeader","__WEBPACK_IMPORTED_MODULE_3_semantic_ui_react__","striped","stackable","__WEBPACK_IMPORTED_MODULE_7__TableHeader__","hasActions","__WEBPACK_IMPORTED_MODULE_4__services_i18n__","renderRows","__WEBPACK_IMPORTED_MODULE_6__Pagination__","listPage","slice","thisRef","changes","__WEBPACK_IMPORTED_MODULE_8__TableRow__","idFunc","tableRef","actionable","editing","isEditing","onSave","onDelete","Pagination","pagination","renderFirst","renderPrevMore","renderMain","renderNextMore","renderLast","from","max","to","pages","push","p","active","DataTableHeader","renderFields","renderActions","field","TableRow","onEditEmpty","j","wide","renderField","renderEdit","__WEBPACK_IMPORTED_MODULE_2__Util__","col","_canEdit","_canDelete","disabled","updating","loading","del","endpoint","objId","noDetails","__WEBPACK_IMPORTED_MODULE_2_react_redux__","_state","ownProps","replace","creating","perm","split","perms","permissions","mapStateToProps","requestList","__WEBPACK_IMPORTED_MODULE_4__actions_dataview__","requestDetails","requestCreate","requestChange","requestDelete","setFilter","equals","o1","o2","mapDispatchToProps","expandRef","create","details","endEdit","delete","onCreate","newObj","__WEBPACK_IMPORTED_MODULE_8__Util__","static","interval","setInterval","componentWillUnmount","clearInterval","createTitle","checks","regsValid","func_1","createFields","filterFields","ff","find","filterName","dataVal","filterValue","v","indexOf","RegExp","test","_b","every","check","cols","origActions","DT","createTable","createForm","renderCreateForm","filterForm","renderFilterForm","basic","doubling","columns","__WEBPACK_IMPORTED_MODULE_6__DataTable__","checkCreatePerm","createButton","Column","__WEBPACK_IMPORTED_MODULE_5__CreateForm__","button","__WEBPACK_IMPORTED_MODULE_7__FilterForm__","valid","values","onFilterChange","CreateForm","handleClick","__WEBPACK_IMPORTED_MODULE_4__Util__","canCreate","createName","styled","Title","renderFieldGroups","fieldGroups","newField","isGroup","only","second","first","fg","FilterForm","__WEBPACK_IMPORTED_MODULE_3__Util__","fs","__WEBPACK_IMPORTED_MODULE_2_semantic_ui_react__","error","visible","multiple"],"mappings":"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","file":"static/js/7.18290c55.chunk.js","sourcesContent":["import * as React from 'react';\r\nimport { WithTranslation } from 'react-i18next';\r\nimport {\r\n\tButton,\r\n\tDropdown,\r\n\tDropdownProps,\r\n\tForm,\r\n\tInput,\r\n\tTable\r\n} from 'semantic-ui-react';\r\n\r\nimport { renderCatalogTypeOptions } from '../../../components/Util';\r\nimport { CatalogType, VillagerShopsStockItem } from '../../../fetch';\r\n\r\ninterface Props extends WithTranslation {\r\n\titem: VillagerShopsStockItem;\r\n\titemTypes: CatalogType[];\r\n\tcurrencies: CatalogType[];\r\n\tonChange: (\r\n\t\titem: VillagerShopsStockItem,\r\n\t\tevent: React.SyntheticEvent<HTMLElement>,\r\n\t\tdata?: DropdownProps\r\n\t) => void;\r\n\tonRemove: (item: VillagerShopsStockItem) => void;\r\n}\r\n\r\ninterface OwnState {}\r\n\r\nclass ShopItem extends React.Component<Props, OwnState> {\r\n\tpublic render() {\r\n\t\tconst { item, t } = this.props;\r\n\r\n\t\treturn (\r\n\t\t\t<Table.Row>\r\n\t\t\t\t<Table.Cell collapsing>\r\n\t\t\t\t\t<Form.Field\r\n\t\t\t\t\t\tselection\r\n\t\t\t\t\t\tsearch\r\n\t\t\t\t\t\tcontrol={Dropdown}\r\n\t\t\t\t\t\tname=\"item.type.id\"\r\n\t\t\t\t\t\tplaceholder=\"Item\"\r\n\t\t\t\t\t\tvalue={item.item.type.id}\r\n\t\t\t\t\t\toptions={renderCatalogTypeOptions(this.props.itemTypes)}\r\n\t\t\t\t\t\tonChange={this.onChange}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Table.Cell>\r\n\t\t\t\t<Table.Cell>\r\n\t\t\t\t\t<Input\r\n\t\t\t\t\t\tfluid\r\n\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\tname=\"item.quantity\"\r\n\t\t\t\t\t\tplaceholder={t('Amount')}\r\n\t\t\t\t\t\tonChange={this.onChange}\r\n\t\t\t\t\t\tvalue={item.item.quantity}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Table.Cell>\r\n\t\t\t\t<Table.Cell>\r\n\t\t\t\t\t<Input\r\n\t\t\t\t\t\tfluid\r\n\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\tname=\"buyPrice\"\r\n\t\t\t\t\t\tplaceholder={t('BuyPrice')}\r\n\t\t\t\t\t\tonChange={this.onChange}\r\n\t\t\t\t\t\tvalue={item.buyPrice}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Table.Cell>\r\n\t\t\t\t<Table.Cell>\r\n\t\t\t\t\t<Input\r\n\t\t\t\t\t\tfluid\r\n\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\tname=\"sellPrice\"\r\n\t\t\t\t\t\tplaceholder={t('SellPrice')}\r\n\t\t\t\t\t\tonChange={this.onChange}\r\n\t\t\t\t\t\tvalue={item.sellPrice}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Table.Cell>\r\n\t\t\t\t<Table.Cell collapsing>\r\n\t\t\t\t\t<Form.Field\r\n\t\t\t\t\t\tselection\r\n\t\t\t\t\t\tsearch\r\n\t\t\t\t\t\tcontrol={Dropdown}\r\n\t\t\t\t\t\tname=\"currency.id\"\r\n\t\t\t\t\t\tplaceholder=\"Currency\"\r\n\t\t\t\t\t\tvalue={item.currency.id}\r\n\t\t\t\t\t\toptions={renderCatalogTypeOptions(this.props.currencies)}\r\n\t\t\t\t\t\tonChange={this.onChange}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Table.Cell>\r\n\t\t\t\t<Table.Cell>\r\n\t\t\t\t\t<Input\r\n\t\t\t\t\t\tfluid\r\n\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\tname=\"stock\"\r\n\t\t\t\t\t\tplaceholder={t('Stock')}\r\n\t\t\t\t\t\tonChange={this.onChange}\r\n\t\t\t\t\t\tvalue={item.stock}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Table.Cell>\r\n\t\t\t\t<Table.Cell>\r\n\t\t\t\t\t<Input\r\n\t\t\t\t\t\tfluid\r\n\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\tname=\"maxStock\"\r\n\t\t\t\t\t\tplaceholder={t('MaxStock')}\r\n\t\t\t\t\t\tonChange={this.onChange}\r\n\t\t\t\t\t\tvalue={item.maxStock}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Table.Cell>\r\n\t\t\t\t<Table.Cell collapsing>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tnegative\r\n\t\t\t\t\t\ticon=\"delete\"\r\n\t\t\t\t\t\tcontent={t('Delete')}\r\n\t\t\t\t\t\tonClick={this.onRemove}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Table.Cell>\r\n\t\t\t</Table.Row>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate onChange = (e: any, val: any) => {\r\n\t\tthis.props.onChange(this.props.item, e, val);\r\n\t};\r\n\r\n\tprivate onRemove = () => {\r\n\t\tthis.props.onRemove(this.props.item);\r\n\t};\r\n}\r\n\r\nexport default ShopItem;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/views/Integrations/VillagerShops/ShopItem.tsx","import * as _ from 'lodash';\r\nimport * as React from 'react';\r\nimport { Trans, withTranslation, WithTranslation } from 'react-i18next';\r\nimport { connect } from 'react-redux';\r\nimport { Dispatch } from 'redux';\r\nimport {\r\n\tButton,\r\n\tDropdown,\r\n\tDropdownProps,\r\n\tForm,\r\n\tHeader,\r\n\tIcon,\r\n\tModal,\r\n\tTable\r\n} from 'semantic-ui-react';\r\n\r\nimport { AppAction, requestCatalog } from '../../../actions';\r\nimport DataViewFunc, { DataViewFields } from '../../../components/DataView';\r\nimport {\r\n\thandleChange,\r\n\tHandleChangeFunc,\r\n\trenderCatalogTypeOptions\r\n} from '../../../components/Util';\r\nimport {\r\n\tCatalogType,\r\n\tVillagerShopsShop,\r\n\tVillagerShopsStockItem\r\n} from '../../../fetch';\r\nimport i18n from '../../../services/i18n';\r\nimport { AppState, CatalogTypeKeys, DataViewRef } from '../../../types';\r\n\r\nimport ShopItem from './ShopItem';\r\n\r\n// tslint:disable-next-line: variable-name\r\nconst DataView = DataViewFunc('vshop/shop', 'uid');\r\n\r\ninterface Props extends WithTranslation {\r\n\tentityTypes: CatalogType[];\r\n\titemTypes: CatalogType[];\r\n\tcurrencies: CatalogType[];\r\n\trequestCatalog: (type: string) => AppAction;\r\n}\r\n\r\ninterface OwnState {\r\n\tmodal: boolean;\r\n\tshop?: VillagerShopsShop;\r\n\tname?: string;\r\n\ttype?: string;\r\n\titems: VillagerShopsStockItem[];\r\n}\r\n\r\nclass Shops extends React.Component<Props, OwnState> {\r\n\tprivate handleChange: HandleChangeFunc;\r\n\tprivate save: () => void;\r\n\r\n\tpublic constructor(props: Props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.state = {\r\n\t\t\tmodal: false,\r\n\t\t\titems: []\r\n\t\t};\r\n\r\n\t\tthis.toggleModal = this.toggleModal.bind(this);\r\n\t\tthis.handleEdit = this.handleEdit.bind(this);\r\n\t\tthis.handleChange = handleChange.bind(this, null);\r\n\t\tthis.addItem = this.addItem.bind(this);\r\n\t\tthis.removeItem = this.removeItem.bind(this);\r\n\t}\r\n\r\n\tpublic componentDidMount() {\r\n\t\tthis.props.requestCatalog(CatalogTypeKeys.Entity);\r\n\t\tthis.props.requestCatalog(CatalogTypeKeys.Item);\r\n\t\tthis.props.requestCatalog(CatalogTypeKeys.Currency);\r\n\t}\r\n\r\n\tpublic render() {\r\n\t\tconst { t } = this.props;\r\n\r\n\t\tconst fields: DataViewFields<VillagerShopsShop> = {\r\n\t\t\tuid: t('Id'),\r\n\t\t\tname: {\r\n\t\t\t\tlabel: t('Name'),\r\n\t\t\t\tfilter: true\r\n\t\t\t},\r\n\t\t\tentityType: {\r\n\t\t\t\tlabel: t('Type'),\r\n\t\t\t\tview: (shop: VillagerShopsShop) => shop.entityType.name,\r\n\t\t\t\tfilter: true,\r\n\t\t\t\toptions: renderCatalogTypeOptions(this.props.entityTypes)\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\treturn (\r\n\t\t\t<>\r\n\t\t\t\t<DataView\r\n\t\t\t\t\tcanEdit\r\n\t\t\t\t\tcanDelete\r\n\t\t\t\t\ticon=\"shop\"\r\n\t\t\t\t\ttitle={t('Shops')}\r\n\t\t\t\t\tfilterTitle={t('FilterShops')}\r\n\t\t\t\t\tfields={fields}\r\n\t\t\t\t\tonEdit={this.handleEdit}\r\n\t\t\t\t/>\r\n\t\t\t\t{this.renderModal()}\r\n\t\t\t</>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate renderModal() {\r\n\t\tif (!this.state.modal || !this.state.shop) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst { t } = this.props;\r\n\r\n\t\tconst items = this.state.items.map((item, i) => (\r\n\t\t\t<ShopItem\r\n\t\t\t\tkey={i}\r\n\t\t\t\titem={item}\r\n\t\t\t\tt={t}\r\n\t\t\t\ti18n={i18n}\r\n\t\t\t\titemTypes={this.props.itemTypes}\r\n\t\t\t\tcurrencies={this.props.currencies}\r\n\t\t\t\tonChange={this.handleItemChange}\r\n\t\t\t\tonRemove={this.removeItem}\r\n\t\t\t/>\r\n\t\t));\r\n\r\n\t\treturn (\r\n\t\t\t<Modal\r\n\t\t\t\topen={this.state.modal}\r\n\t\t\t\tonClose={this.toggleModal}\r\n\t\t\t\tsize=\"fullscreen\"\r\n\t\t\t\tclassName=\"scrolling\"\r\n\t\t\t>\r\n\t\t\t\t<Modal.Header>\r\n\t\t\t\t\t<Trans i18nKey=\"ShopTitle\">Edit '{this.state.shop.name}'</Trans>\r\n\t\t\t\t</Modal.Header>\r\n\t\t\t\t<Modal.Content>\r\n\t\t\t\t\t<Form>\r\n\t\t\t\t\t\t<Header>\r\n\t\t\t\t\t\t\t<Icon fitted name=\"info\" /> {t('General')}\r\n\t\t\t\t\t\t</Header>\r\n\r\n\t\t\t\t\t\t<Form.Group widths=\"equal\">\r\n\t\t\t\t\t\t\t<Form.Input\r\n\t\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\t\tfluid\r\n\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\tname=\"name\"\r\n\t\t\t\t\t\t\t\tlabel={t('Name')}\r\n\t\t\t\t\t\t\t\tplaceholder={t('Name')}\r\n\t\t\t\t\t\t\t\tonChange={this.handleChange}\r\n\t\t\t\t\t\t\t\tvalue={this.state.name}\r\n\t\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t\t<Form.Field\r\n\t\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\t\tfluid\r\n\t\t\t\t\t\t\t\tselection\r\n\t\t\t\t\t\t\t\tsearch\r\n\t\t\t\t\t\t\t\tcontrol={Dropdown}\r\n\t\t\t\t\t\t\t\tname=\"type\"\r\n\t\t\t\t\t\t\t\tlabel={t('Type')}\r\n\t\t\t\t\t\t\t\tplaceholder={t('Type')}\r\n\t\t\t\t\t\t\t\tonChange={this.handleChange}\r\n\t\t\t\t\t\t\t\toptions={renderCatalogTypeOptions(this.props.entityTypes)}\r\n\t\t\t\t\t\t\t\tvalue={this.state.type}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t\t<Header>\r\n\t\t\t\t\t\t\t<Icon fitted name=\"cube\" /> {t('Items')}\r\n\t\t\t\t\t\t</Header>\r\n\r\n\t\t\t\t\t\t<Table size=\"small\">\r\n\t\t\t\t\t\t\t<Table.Header>\r\n\t\t\t\t\t\t\t\t<Table.Row>\r\n\t\t\t\t\t\t\t\t\t<Table.HeaderCell>{t('Item')}</Table.HeaderCell>\r\n\t\t\t\t\t\t\t\t\t<Table.HeaderCell>{t('Amount')}</Table.HeaderCell>\r\n\t\t\t\t\t\t\t\t\t<Table.HeaderCell>{t('BuyPrice')}</Table.HeaderCell>\r\n\t\t\t\t\t\t\t\t\t<Table.HeaderCell>{t('SellPrice')}</Table.HeaderCell>\r\n\t\t\t\t\t\t\t\t\t<Table.HeaderCell>{t('Currency')}</Table.HeaderCell>\r\n\t\t\t\t\t\t\t\t\t<Table.HeaderCell>{t('Stock')}</Table.HeaderCell>\r\n\t\t\t\t\t\t\t\t\t<Table.HeaderCell>{t('MaxStock')}</Table.HeaderCell>\r\n\t\t\t\t\t\t\t\t\t<Table.HeaderCell>{t('Actions')}</Table.HeaderCell>\r\n\t\t\t\t\t\t\t\t</Table.Row>\r\n\t\t\t\t\t\t\t</Table.Header>\r\n\t\t\t\t\t\t\t<Table.Body>\r\n\t\t\t\t\t\t\t\t{items}\r\n\t\t\t\t\t\t\t\t<Table.Row>\r\n\t\t\t\t\t\t\t\t\t<Table.Cell colSpan=\"8\" textAlign=\"center\">\r\n\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\tpositive\r\n\t\t\t\t\t\t\t\t\t\t\ticon=\"plus\"\r\n\t\t\t\t\t\t\t\t\t\t\tcontent={t('Add')}\r\n\t\t\t\t\t\t\t\t\t\t\tonClick={this.addItem}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t</Table.Cell>\r\n\t\t\t\t\t\t\t\t</Table.Row>\r\n\t\t\t\t\t\t\t</Table.Body>\r\n\t\t\t\t\t\t</Table>\r\n\t\t\t\t\t</Form>\r\n\t\t\t\t</Modal.Content>\r\n\t\t\t\t<Modal.Actions>\r\n\t\t\t\t\t<Button primary onClick={this.save}>\r\n\t\t\t\t\t\t{t('Save')}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t\t&nbsp;\r\n\t\t\t\t\t<Button secondary onClick={this.toggleModal}>\r\n\t\t\t\t\t\t{t('Cancel')}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</Modal.Actions>\r\n\t\t\t</Modal>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate toggleModal() {\r\n\t\tthis.setState({\r\n\t\t\tmodal: !this.state.modal\r\n\t\t});\r\n\t}\r\n\r\n\tprivate handleEdit(\r\n\t\tshop: VillagerShopsShop,\r\n\t\tview: DataViewRef<VillagerShopsShop>\r\n\t) {\r\n\t\tthis.save = () => {\r\n\t\t\tview.save(shop, {\r\n\t\t\t\tname: this.state.name,\r\n\t\t\t\tentityType: this.state.type,\r\n\t\t\t\tstockItems: this.state.items\r\n\t\t\t});\r\n\t\t\tthis.setState({\r\n\t\t\t\tmodal: false,\r\n\t\t\t\tshop: undefined\r\n\t\t\t});\r\n\t\t};\r\n\r\n\t\tthis.setState({\r\n\t\t\tmodal: true,\r\n\t\t\tshop,\r\n\t\t\tname: shop ? shop.name : undefined,\r\n\t\t\ttype: shop ? shop.entityType.id : undefined,\r\n\t\t\titems: shop\r\n\t\t\t\t? shop.stockItems\r\n\t\t\t\t\t? shop.stockItems.map(({ link, ...i }) => ({ ...i }))\r\n\t\t\t\t\t: []\r\n\t\t\t\t: []\r\n\t\t});\r\n\t}\r\n\r\n\tprivate handleItemChange = (\r\n\t\titem: VillagerShopsStockItem,\r\n\t\tevent: React.SyntheticEvent<HTMLElement>,\r\n\t\tdata?: DropdownProps\r\n\t) => {\r\n\t\tconst cb = (name: string, value: string) => {\r\n\t\t\tconst newItem = _.cloneDeep(item);\r\n\t\t\t_.set(newItem, name, value);\r\n\r\n\t\t\tthis.setState({\r\n\t\t\t\titems: this.state.items.map(i => (i === item ? newItem : i))\r\n\t\t\t});\r\n\t\t};\r\n\t\thandleChange.call(this, cb, event, data);\r\n\t};\r\n\r\n\tprivate addItem() {\r\n\t\tconst newItem: VillagerShopsStockItem = {\r\n\t\t\titem: {\r\n\t\t\t\ttype: {\r\n\t\t\t\t\tid: 'minecraft:dirt',\r\n\t\t\t\t\tname: 'Dirt'\r\n\t\t\t\t},\r\n\t\t\t\tquantity: 1\r\n\t\t\t},\r\n\t\t\tcurrency: {\r\n\t\t\t\tid: '',\r\n\t\t\t\tname: ''\r\n\t\t\t},\r\n\t\t\tbuyPrice: 0,\r\n\t\t\tsellPrice: 0,\r\n\t\t\tstock: 0,\r\n\t\t\tmaxStock: 0,\r\n\t\t\thasStock: false,\r\n\t\t\tshopId: this.state.shop!.uid!\r\n\t\t};\r\n\r\n\t\tconst items = this.state.items\r\n\t\t\t? this.state.items.concat(newItem)\r\n\t\t\t: [newItem];\r\n\t\tthis.setState({\r\n\t\t\titems\r\n\t\t});\r\n\t}\r\n\r\n\tprivate removeItem = (item: VillagerShopsStockItem) => {\r\n\t\tthis.setState({\r\n\t\t\titems: this.state.items.filter(i => i !== item)\r\n\t\t});\r\n\t};\r\n}\r\n\r\nconst mapStateToProps = (state: AppState) => {\r\n\treturn {\r\n\t\tentityTypes: state.api.types[CatalogTypeKeys.Entity],\r\n\t\titemTypes: state.api.types[CatalogTypeKeys.Item],\r\n\t\tcurrencies: state.api.types[CatalogTypeKeys.Currency]\r\n\t};\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch: Dispatch<AppAction>) => {\r\n\treturn {\r\n\t\trequestCatalog: (type: string): AppAction => dispatch(requestCatalog(type))\r\n\t};\r\n};\r\n\r\nexport default connect(\r\n\tmapStateToProps,\r\n\tmapDispatchToProps\r\n)(withTranslation('Integrations.VShop')(Shops));\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/views/Integrations/VillagerShops/Shops.tsx","import * as _ from 'lodash';\r\nimport * as React from 'react';\r\nimport { withTranslation, WithTranslation } from 'react-i18next';\r\nimport { Header, Icon, SemanticICONS, Table } from 'semantic-ui-react';\r\n\r\nimport i18n from '../../services/i18n';\r\nimport { DataFieldRaw, DataTableRef, IdFunction } from '../../types';\r\nimport { handleChange, HandleChangeFunc } from '../Util';\r\n\r\nimport Pagination from './Pagination';\r\nimport TableHeader from './TableHeader';\r\nimport TableRow from './TableRow';\r\n\r\nconst ITEMS_PER_PAGE = 20;\r\n\r\nexport type DataTableFields<T> = {\r\n\t[key: string]: DataFieldRaw<T>;\r\n};\r\n\r\nexport interface Props<T> {\r\n\ttitle?: string;\r\n\ticon?: SemanticICONS;\r\n\tlist: T[];\r\n\tcanEdit?: (data: T) => boolean;\r\n\tcanDelete?: (data: T) => boolean;\r\n\tfields: DataTableFields<T>;\r\n\tactions?: (data: T, view: DataTableRef) => JSX.Element | undefined;\r\n\tonEdit?: (data: T | undefined, view: DataTableRef) => void;\r\n\tonSave?: (data: T, newData: any, view: DataTableRef) => void;\r\n\tonDelete?: (data: T, view: DataTableRef) => void;\r\n\tidFunc: IdFunction<T>;\r\n\tisEditing: (data: T) => boolean;\r\n}\r\n\r\ninterface AllProps<T> extends Props<T>, WithTranslation {}\r\n\r\ninterface OwnState {\r\n\tpage: number;\r\n\tnewData: any;\r\n}\r\n\r\nclass DataTable<T> extends React.Component<AllProps<T>, OwnState> {\r\n\tprivate handleChange: HandleChangeFunc;\r\n\r\n\tpublic constructor(props: AllProps<T>) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.state = {\r\n\t\t\tpage: 0,\r\n\t\t\tnewData: {}\r\n\t\t};\r\n\r\n\t\tthis.changePage = this.changePage.bind(this);\r\n\t\tthis.doHandleChange = this.doHandleChange.bind(this);\r\n\t\tthis.handleChange = handleChange.bind(this, this.doHandleChange);\r\n\t}\r\n\r\n\tprivate doHandleChange(key: string, value: string) {\r\n\t\tthis.setState({\r\n\t\t\tnewData: {\r\n\t\t\t\t...this.state.newData,\r\n\t\t\t\t[key]: value\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprivate changePage = (event: React.MouseEvent<HTMLElement>, page: number) => {\r\n\t\tevent.preventDefault();\r\n\r\n\t\tthis.setState({\r\n\t\t\tpage: page\r\n\t\t});\r\n\t};\r\n\r\n\tprivate onEdit = (obj: T | undefined, view: DataTableRef): void => {\r\n\t\tconst newData = {};\r\n\t\tif (obj) {\r\n\t\t\tObject.keys(this.props.fields).forEach(name => {\r\n\t\t\t\tif (!this.props.fields[name].edit) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tnewData[name] = _.get(obj, name);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tthis.setState({\r\n\t\t\tnewData: newData\r\n\t\t});\r\n\r\n\t\tif (this.props.onEdit) {\r\n\t\t\tthis.props.onEdit(obj, view);\r\n\t\t}\r\n\t};\r\n\r\n\tpublic shouldComponentUpdate(nextProps: Props<T>, nextState: OwnState) {\r\n\t\treturn (\r\n\t\t\tnextProps.fields !== this.props.fields ||\r\n\t\t\tnextProps.list !== this.props.list ||\r\n\t\t\tnextState.page !== this.state.page ||\r\n\t\t\tnextState.newData !== this.state.newData\r\n\t\t);\r\n\t}\r\n\r\n\tpublic render() {\r\n\t\tconst { list, canEdit, canDelete, actions } = this.props;\r\n\t\tconst fields = Object.keys(this.props.fields)\r\n\t\t\t.map(f => this.props.fields[f])\r\n\t\t\t.filter(f => f.view);\r\n\r\n\t\tconst maxPage = Math.ceil(list.length / ITEMS_PER_PAGE);\r\n\t\tconst page = Math.min(this.state.page, maxPage - 1);\r\n\r\n\t\tconst _t = this.props.t;\r\n\t\tconst editable = _.some(list, canEdit);\r\n\t\tconst deletable = _.some(list, canDelete);\r\n\r\n\t\treturn (\r\n\t\t\t<div style={{ marginTop: '2em' }}>\r\n\t\t\t\t{this.renderHeader()}\r\n\r\n\t\t\t\t<Table striped={true} stackable>\r\n\t\t\t\t\t<TableHeader\r\n\t\t\t\t\t\tfields={fields}\r\n\t\t\t\t\t\thasActions={typeof actions !== typeof undefined}\r\n\t\t\t\t\t\tcanEdit={editable}\r\n\t\t\t\t\t\tcanDelete={deletable}\r\n\t\t\t\t\t\ti18n={i18n}\r\n\t\t\t\t\t\tt={_t}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<Table.Body>{this.renderRows(fields, page)}</Table.Body>\r\n\t\t\t\t</Table>\r\n\t\t\t\t<Pagination\r\n\t\t\t\t\tpage={page}\r\n\t\t\t\t\tmaxPage={maxPage}\r\n\t\t\t\t\tchangePage={this.changePage}\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate renderHeader() {\r\n\t\tconst { icon, title } = this.props;\r\n\r\n\t\tif (!title) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<Header>\r\n\t\t\t\t<Icon fitted name={icon} /> {title}\r\n\t\t\t</Header>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate renderRows(fields: DataFieldRaw<T>[], page: number) {\r\n\t\tconst { list, canEdit, canDelete, actions, t } = this.props;\r\n\r\n\t\tconst listPage = list.slice(\r\n\t\t\tpage * ITEMS_PER_PAGE,\r\n\t\t\t(page + 1) * ITEMS_PER_PAGE\r\n\t\t);\r\n\r\n\t\tconst thisRef: DataTableRef = {\r\n\t\t\thandleChange: this.handleChange,\r\n\t\t\tstate: this.state.newData,\r\n\t\t\tsetState: (changes: object) =>\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\tnewData: { ...this.state.newData, ...changes }\r\n\t\t\t\t})\r\n\t\t};\r\n\r\n\t\tconst editable = _.some(list, canEdit);\r\n\t\tconst deletable = _.some(list, canDelete);\r\n\r\n\t\treturn listPage.map((obj, i) => (\r\n\t\t\t<TableRow\r\n\t\t\t\tkey={this.props.idFunc(obj)}\r\n\t\t\t\tobj={obj}\r\n\t\t\t\ttableRef={thisRef}\r\n\t\t\t\tactionable={editable || deletable}\r\n\t\t\t\tcanEdit={canEdit}\r\n\t\t\t\tcanDelete={canDelete}\r\n\t\t\t\tediting={this.props.isEditing(obj)}\r\n\t\t\t\tfields={fields}\r\n\t\t\t\tonEdit={this.onEdit}\r\n\t\t\t\tonSave={this.props.onSave}\r\n\t\t\t\tonDelete={this.props.onDelete}\r\n\t\t\t\tactions={actions}\r\n\t\t\t\tnewData={this.state.newData}\r\n\t\t\t\thandleChange={this.handleChange}\r\n\t\t\t\ti18n={i18n}\r\n\t\t\t\tt={t}\r\n\t\t\t/>\r\n\t\t));\r\n\t}\r\n}\r\n\r\nexport default withTranslation('DataTable')(DataTable);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/DataTable/index.tsx","import * as React from 'react';\r\nimport { Menu } from 'semantic-ui-react';\r\n\r\nexport interface Props {\r\n\tpage: number;\r\n\tmaxPage: number;\r\n\tchangePage: (event: React.MouseEvent<HTMLElement>, page: number) => void;\r\n}\r\n\r\nexport default class Pagination extends React.Component<Props> {\r\n\tpublic shouldComponentUpdate(nextProps: Props, nextState: any) {\r\n\t\treturn (\r\n\t\t\tnextProps.page !== this.props.page ||\r\n\t\t\tnextProps.maxPage !== this.props.maxPage\r\n\t\t);\r\n\t}\r\n\r\n\tpublic render() {\r\n\t\tif (this.props.maxPage <= 1) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<Menu pagination>\r\n\t\t\t\t{this.renderFirst()}\r\n\t\t\t\t{this.renderPrevMore()}\r\n\t\t\t\t{this.renderMain()}\r\n\t\t\t\t{this.renderNextMore()}\r\n\t\t\t\t{this.renderLast()}\r\n\t\t\t</Menu>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate renderFirst() {\r\n\t\tif (this.props.page <= 4) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\t// tslint:disable-next-line:jsx-no-lambda\r\n\t\treturn <Menu.Item onClick={e => this.props.changePage(e, 0)}>1</Menu.Item>;\r\n\t}\r\n\r\n\tprivate renderPrevMore() {\r\n\t\tif (this.props.page <= 5) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t// tslint:disable-next-line:jsx-no-lambda\r\n\t\t\t<Menu.Item onClick={e => this.props.changePage(e, this.props.page - 5)}>\r\n\t\t\t\t...\r\n\t\t\t</Menu.Item>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate renderMain() {\r\n\t\tconst { page, maxPage } = this.props;\r\n\t\tconst from = Math.max(0, page - 4);\r\n\t\tconst to = Math.min(maxPage, page + 5);\r\n\r\n\t\tconst pages = [];\r\n\t\tfor (let i = from; i < to; i++) {\r\n\t\t\tpages.push(i);\r\n\t\t}\r\n\r\n\t\treturn pages.map(p => (\r\n\t\t\t<Menu.Item\r\n\t\t\t\tkey={p}\r\n\t\t\t\t// tslint:disable-next-line:jsx-no-lambda\r\n\t\t\t\tonClick={e => this.props.changePage(e, p)}\r\n\t\t\t\tactive={p === page}\r\n\t\t\t>\r\n\t\t\t\t{p + 1}\r\n\t\t\t</Menu.Item>\r\n\t\t));\r\n\t}\r\n\r\n\tprivate renderNextMore() {\r\n\t\tif (this.props.page >= this.props.maxPage - 6) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t// tslint:disable-next-line:jsx-no-lambda\r\n\t\t\t<Menu.Item onClick={e => this.props.changePage(e, this.props.page + 5)}>\r\n\t\t\t\t...\r\n\t\t\t</Menu.Item>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate renderLast() {\r\n\t\tif (this.props.page >= this.props.maxPage - 5) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<Menu.Item\r\n\t\t\t\t// tslint:disable-next-line:jsx-no-lambda\r\n\t\t\t\tonClick={e => this.props.changePage(e, this.props.maxPage - 1)}\r\n\t\t\t>\r\n\t\t\t\t{this.props.maxPage}\r\n\t\t\t</Menu.Item>\r\n\t\t);\r\n\t}\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/DataTable/Pagination.tsx","import * as React from 'react';\r\nimport { WithTranslation } from 'react-i18next';\r\nimport { Table } from 'semantic-ui-react';\r\n\r\nimport { DataFieldRaw } from '../../types';\r\n\r\nexport interface Props<T> extends WithTranslation {\r\n\thasActions: boolean;\r\n\tcanEdit?: boolean;\r\n\tcanDelete?: boolean;\r\n\tfields: DataFieldRaw<T>[];\r\n}\r\n\r\nexport default class DataTableHeader<T> extends React.Component<Props<T>> {\r\n\tpublic shouldComponentUpdate(nextProps: Props<T>, nextState: any) {\r\n\t\treturn nextProps.fields !== this.props.fields;\r\n\t}\r\n\r\n\tpublic render() {\r\n\t\treturn (\r\n\t\t\t<Table.Header>\r\n\t\t\t\t<Table.Row>\r\n\t\t\t\t\t{this.renderFields()}\r\n\t\t\t\t\t{this.renderActions()}\r\n\t\t\t\t</Table.Row>\r\n\t\t\t</Table.Header>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate renderFields() {\r\n\t\treturn Object.keys(this.props.fields).map(name => {\r\n\t\t\tconst field = this.props.fields[name];\r\n\t\t\treturn (\r\n\t\t\t\t<Table.HeaderCell key={name}>\r\n\t\t\t\t\t{field.label ? field.label : '<' + field.name + '>'}\r\n\t\t\t\t</Table.HeaderCell>\r\n\t\t\t);\r\n\t\t});\r\n\t}\r\n\r\n\tprivate renderActions() {\r\n\t\tif (\r\n\t\t\t!this.props.hasActions &&\r\n\t\t\t!this.props.canEdit &&\r\n\t\t\t!this.props.canDelete\r\n\t\t) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn <Table.HeaderCell>{this.props.t('Actions')}</Table.HeaderCell>;\r\n\t}\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/DataTable/TableHeader.tsx","import * as React from 'react';\r\nimport { WithTranslation } from 'react-i18next';\r\nimport { Button, Dropdown, Form, Icon, Table } from 'semantic-ui-react';\r\n\r\nimport { DataFieldRaw, DataTableRef } from '../../types';\r\nimport { get, HandleChangeFunc } from '../Util';\r\n\r\nexport interface Props<T> extends WithTranslation {\r\n\tobj: T;\r\n\ttableRef: DataTableRef;\r\n\tactionable: boolean;\r\n\tcanEdit?: (data: T) => boolean;\r\n\tcanDelete?: (data: T) => boolean;\r\n\tediting: boolean;\r\n\tfields: DataFieldRaw<T>[];\r\n\tonEdit: (data: T | undefined, view: DataTableRef) => void;\r\n\tonSave?: (data: T, newData: any, view: DataTableRef) => void;\r\n\tonDelete?: (data: T, view: DataTableRef) => void;\r\n\tactions?: (data: T, view: DataTableRef) => JSX.Element | undefined;\r\n\thandleChange: HandleChangeFunc;\r\n\tnewData: any;\r\n}\r\n\r\nexport default class TableRow<T> extends React.Component<Props<T>> {\r\n\tpublic shouldComponentUpdate(nextProps: Props<T>, nextState: any) {\r\n\t\treturn (\r\n\t\t\tnextProps.obj !== this.props.obj ||\r\n\t\t\tnextProps.editing !== this.props.editing ||\r\n\t\t\tnextProps.fields !== this.props.fields ||\r\n\t\t\t(this.props.editing && nextProps.newData !== this.props.newData)\r\n\t\t);\r\n\t}\r\n\r\n\tprivate onSave = () => {\r\n\t\tconst { obj, tableRef } = this.props;\r\n\r\n\t\tif (this.props.onSave) {\r\n\t\t\tthis.props.onSave(obj, this.props.newData, tableRef);\r\n\t\t}\r\n\t};\r\n\r\n\tprivate onEditEmpty = () => {\r\n\t\tthis.props.onEdit(undefined, this.props.tableRef);\r\n\t};\r\n\r\n\tprivate onEdit = () => {\r\n\t\tthis.props.onEdit(this.props.obj, this.props.tableRef);\r\n\t};\r\n\r\n\tprivate onDelete = () => {\r\n\t\tif (this.props.onDelete) {\r\n\t\t\tthis.props.onDelete(this.props.obj, this.props.tableRef);\r\n\t\t}\r\n\t};\r\n\r\n\tpublic render() {\r\n\t\treturn (\r\n\t\t\t<Table.Row>\r\n\t\t\t\t{this.renderFields()}\r\n\t\t\t\t{this.renderActions()}\r\n\t\t\t</Table.Row>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate renderFields() {\r\n\t\tconst { fields } = this.props;\r\n\r\n\t\treturn fields.map((field, j) => (\r\n\t\t\t<Table.Cell key={j} collapsing={!field.wide}>\r\n\t\t\t\t{this.renderField(field)}\r\n\t\t\t</Table.Cell>\r\n\t\t));\r\n\t}\r\n\r\n\tprivate renderField(field: DataFieldRaw<T>) {\r\n\t\tconst { obj, editing, tableRef } = this.props;\r\n\r\n\t\treturn field.edit && editing\r\n\t\t\t? typeof field.edit === 'function'\r\n\t\t\t\t? field.edit(obj, tableRef)\r\n\t\t\t\t: this.renderEdit(obj, field)\r\n\t\t\t: typeof field.view === 'function'\r\n\t\t\t? field.view(obj, tableRef)\r\n\t\t\t: get(obj, field.name);\r\n\t}\r\n\r\n\tprivate renderEdit(obj: T, col: DataFieldRaw<T>) {\r\n\t\tif (col.options) {\r\n\t\t\treturn (\r\n\t\t\t\t<Form.Field\r\n\t\t\t\t\tfluid\r\n\t\t\t\t\tselection\r\n\t\t\t\t\tsearch\r\n\t\t\t\t\tcontrol={Dropdown}\r\n\t\t\t\t\tname={col.name}\r\n\t\t\t\t\tplaceholder={col.label}\r\n\t\t\t\t\toptions={col.options}\r\n\t\t\t\t\tvalue={this.props.newData[col.name]}\r\n\t\t\t\t\tonChange={this.props.handleChange}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<Form.Input\r\n\t\t\t\tname={col.name}\r\n\t\t\t\ttype={col.type ? col.type : 'text'}\r\n\t\t\t\tplaceholder={col.label}\r\n\t\t\t\tvalue={this.props.newData[col.name]}\r\n\t\t\t\tonChange={this.props.handleChange}\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate renderActions() {\r\n\t\tconst {\r\n\t\t\tactions,\r\n\t\t\tobj,\r\n\t\t\tactionable,\r\n\t\t\tcanEdit,\r\n\t\t\tcanDelete,\r\n\t\t\tediting,\r\n\t\t\ttableRef\r\n\t\t} = this.props;\r\n\r\n\t\tconst _canEdit = typeof canEdit === 'function' ? canEdit(obj) : canEdit;\r\n\t\tconst _canDelete =\r\n\t\t\ttypeof canDelete === 'function' ? canDelete(obj) : canEdit;\r\n\r\n\t\tif (!actions && !actionable) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tlet edit = null;\r\n\t\tif (_canEdit && editing) {\r\n\t\t\tedit = (\r\n\t\t\t\t<Table.Cell collapsing>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tprimary\r\n\t\t\t\t\t\tdisabled={(obj as any).updating}\r\n\t\t\t\t\t\tloading={(obj as any).updating}\r\n\t\t\t\t\t\tonClick={this.onSave}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Icon name=\"save\" /> {this.props.t('Save')}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tsecondary\r\n\t\t\t\t\t\tdisabled={(obj as any).updating}\r\n\t\t\t\t\t\tloading={(obj as any).updating}\r\n\t\t\t\t\t\tonClick={this.onEditEmpty}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Icon name=\"cancel\" /> {this.props.t('Cancel')}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</Table.Cell>\r\n\t\t\t);\r\n\t\t} else if (_canEdit) {\r\n\t\t\tedit = (\r\n\t\t\t\t<Table.Cell collapsing>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tprimary\r\n\t\t\t\t\t\tdisabled={(obj as any).updating}\r\n\t\t\t\t\t\tloading={(obj as any).updating}\r\n\t\t\t\t\t\tonClick={this.onEdit}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Icon name=\"edit\" /> {this.props.t('Edit')}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</Table.Cell>\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tlet del = null;\r\n\t\tif (_canDelete) {\r\n\t\t\tdel = (\r\n\t\t\t\t<Button\r\n\t\t\t\t\tnegative\r\n\t\t\t\t\tdisabled={(obj as any).updating}\r\n\t\t\t\t\tloading={(obj as any).updating}\r\n\t\t\t\t\tonClick={this.onDelete}\r\n\t\t\t\t>\r\n\t\t\t\t\t<Icon name=\"trash\" /> {this.props.t('Remove')}\r\n\t\t\t\t</Button>\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<Table.Cell collapsing>\r\n\t\t\t\t{edit}\r\n\t\t\t\t{del}\r\n\t\t\t\t{actions ? actions(obj, tableRef) : null}\r\n\t\t\t</Table.Cell>\r\n\t\t);\r\n\t}\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/DataTable/TableRow.tsx","import * as _ from 'lodash';\r\nimport * as React from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { Dispatch } from 'redux';\r\nimport { Grid, Segment } from 'semantic-ui-react';\r\n\r\nimport { AppAction } from '../../actions';\r\nimport {\r\n\trequestChange,\r\n\trequestCreate,\r\n\trequestDelete,\r\n\trequestDetails,\r\n\trequestList,\r\n\tsetFilter\r\n} from '../../actions/dataview';\r\nimport { DataViewState } from '../../reducers/dataview';\r\nimport {\r\n\tAppState,\r\n\tDataFieldRaw,\r\n\tDataTableRef,\r\n\tDataViewRef,\r\n\tIdFunction\r\n} from '../../types';\r\nimport CreateForm from '../CreateForm';\r\nimport DataTable, { Props as DataTableProps } from '../DataTable';\r\nimport FilterForm from '../FilterForm';\r\nimport { checkPermissions } from '../Util';\r\n\r\nimport {\r\n\tDispatchProps,\r\n\tFullProps,\r\n\tOwnProps,\r\n\tOwnState,\r\n\tStateProps\r\n} from './types';\r\nexport { DataViewFields } from './types';\r\n\r\nclass DataView<T> extends React.Component<FullProps<T>, OwnState<T>> {\r\n\tprivate interval: NodeJS.Timer;\r\n\r\n\tpublic constructor(props: FullProps<T>) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.state = {\r\n\t\t\tpage: 0,\r\n\t\t\tdata: undefined\r\n\t\t};\r\n\r\n\t\tthis.details = this.details.bind(this);\r\n\t\tthis.create = this.create.bind(this);\r\n\t\tthis.edit = this.edit.bind(this);\r\n\t\tthis.endEdit = this.endEdit.bind(this);\r\n\t\tthis.save = this.save.bind(this);\r\n\t\tthis.delete = this.delete.bind(this);\r\n\t}\r\n\r\n\tpublic componentDidMount() {\r\n\t\tif (!this.props.static) {\r\n\t\t\tthis.props.requestList();\r\n\t\t\tthis.interval = setInterval(this.props.requestList, 10000);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic componentWillUnmount() {\r\n\t\tif (this.interval) {\r\n\t\t\tclearInterval(this.interval);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic shouldComponentUpdate(\r\n\t\tnextProps: FullProps<T>,\r\n\t\tnextState: OwnState<T>\r\n\t) {\r\n\t\treturn (\r\n\t\t\tnextProps.creating !== this.props.creating ||\r\n\t\t\tnextProps.filter !== this.props.filter ||\r\n\t\t\tnextProps.fields !== this.props.fields ||\r\n\t\t\tnextProps.list !== this.props.list ||\r\n\t\t\tnextState.data !== this.state.data\r\n\t\t);\r\n\t}\r\n\r\n\t// Create a new data entry\r\n\tprivate create(data: T) {\r\n\t\tthis.props.requestCreate(data);\r\n\t}\r\n\r\n\t// Get the details for a data entry\r\n\tprivate details(data: T) {\r\n\t\tthis.props.requestDetails(data);\r\n\t}\r\n\r\n\t// Select a data entry for editing\r\n\tprivate edit(data: T | undefined) {\r\n\t\tthis.setState({ data });\r\n\t}\r\n\r\n\t// Save/Update an existing data entry\r\n\tprivate save(data: T, newData: any) {\r\n\t\tthis.props.requestChange(data, newData);\r\n\t\tthis.endEdit();\r\n\t}\r\n\r\n\t// End editing an entry\r\n\tprivate endEdit() {\r\n\t\tthis.setState({\r\n\t\t\tdata: undefined\r\n\t\t});\r\n\t}\r\n\r\n\t// Delete a data entry\r\n\tprivate delete(data: T) {\r\n\t\tthis.props.requestDelete(data);\r\n\t}\r\n\r\n\tpublic render() {\r\n\t\tconst { filter, title, createTitle, filterTitle } = this.props;\r\n\r\n\t\tconst checks: ((val: T) => boolean)[] = [];\r\n\t\tlet regsValid = false;\r\n\r\n\t\t// Get all the fields of the table\r\n\t\tconst fields: { [x: string]: DataFieldRaw<T> } = _.mapValues(\r\n\t\t\tthis.props.fields,\r\n\t\t\t(value, name) => {\r\n\t\t\t\tlet val: DataFieldRaw<T> = {\r\n\t\t\t\t\tname: name,\r\n\t\t\t\t\tview: true\r\n\t\t\t\t};\r\n\r\n\t\t\t\t// If the column is a string use that as the label\r\n\t\t\t\t// If the column is a function, use that function to display the cell\r\n\t\t\t\t// else if the column provides a view function then use that to display the cell\r\n\t\t\t\tif (typeof value === 'string') {\r\n\t\t\t\t\tval.label = value;\r\n\t\t\t\t} else if (typeof value === 'function') {\r\n\t\t\t\t\tval.view = (obj: T, tableRef: DataTableRef) =>\r\n\t\t\t\t\t\tvalue(obj, this.expandRef(tableRef));\r\n\t\t\t\t} else if (typeof value === 'object') {\r\n\t\t\t\t\tval = { ...val, ...value };\r\n\t\t\t\t\tif (typeof value.view === 'function') {\r\n\t\t\t\t\t\tconst func = value.view;\r\n\t\t\t\t\t\tval.view = (obj: T, tableRef: DataTableRef) =>\r\n\t\t\t\t\t\t\tfunc(obj, this.expandRef(tableRef));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn val;\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\t// Get all the fields for the create form\r\n\t\t// Get all the fields for the filter form\r\n\t\tconst createFields: { [x: string]: DataFieldRaw<T> } = {};\r\n\t\tconst filterFields: { [x: string]: DataFieldRaw<T> } = {};\r\n\t\tObject.keys(fields).forEach(f => {\r\n\t\t\tif (fields[f].create) {\r\n\t\t\t\tcreateFields[f] = fields[f];\r\n\t\t\t}\r\n\t\t\tif (fields[f].filter) {\r\n\t\t\t\tfilterFields[f] = fields[f];\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\ttry {\r\n\t\t\tObject.keys(filter).forEach(name => {\r\n\t\t\t\tconst value = filter[name];\r\n\r\n\t\t\t\t// Get the filter field according to the filterName if specified,\r\n\t\t\t\t// otherwise just the name\r\n\t\t\t\tconst ff =\r\n\t\t\t\t\tObject.keys(filterFields)\r\n\t\t\t\t\t\t.map(f => filterFields[f])\r\n\t\t\t\t\t\t.find(f => f.filterName === name) || filterFields[name];\r\n\r\n\t\t\t\t// If we have a filterValue function then use that as the value for the check\r\n\t\t\t\tlet val = (dataVal: T) => _.get(dataVal, name);\r\n\t\t\t\tif (typeof ff.filterValue === 'function') {\r\n\t\t\t\t\tval = ff.filterValue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// If it is an array then we need to check if the value is in the array\r\n\t\t\t\t// Otherwise just use a normal regex check\r\n\t\t\t\tif (_.isArray(value)) {\r\n\t\t\t\t\tif (value.length === 0) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tchecks.push((dataVal: T) => {\r\n\t\t\t\t\t\tconst v = val(dataVal);\r\n\t\t\t\t\t\treturn value.indexOf(v) >= 0;\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tchecks.push((dataVal: T) =>\r\n\t\t\t\t\t\tnew RegExp(value, 'i').test(val(dataVal))\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tregsValid = true;\r\n\t\t} catch {\r\n\t\t\tregsValid = false;\r\n\t\t}\r\n\r\n\t\t// Filter out the values according to the filters\r\n\t\t// If the regex isn't valid then we don't want to filter\r\n\t\tconst list = this.props.list.filter(data => {\r\n\t\t\treturn !regsValid || checks.every(check => check(data));\r\n\t\t});\r\n\r\n\t\t// Check how many columns we need for the create and filter form\r\n\t\tconst cols = createTitle && filterTitle ? 2 : 1;\r\n\r\n\t\t// Wrap the provided actions if we have any\r\n\t\tconst origActions = this.props.actions;\r\n\t\tlet actions = origActions;\r\n\t\tif (typeof origActions === 'function') {\r\n\t\t\tactions = (obj, tableRef) => origActions(obj, this.expandRef(tableRef));\r\n\t\t}\r\n\r\n\t\tconst DT = this.createTable();\r\n\r\n\t\tconst createForm = this.renderCreateForm(createTitle, createFields);\r\n\t\tconst filterForm = this.renderFilterForm(\r\n\t\t\tfilterTitle,\r\n\t\t\tfilterFields,\r\n\t\t\tregsValid\r\n\t\t);\r\n\r\n\t\treturn (\r\n\t\t\t<Segment basic>\r\n\t\t\t\t<Grid stackable doubling columns={cols}>\r\n\t\t\t\t\t{createForm}\r\n\t\t\t\t\t{filterForm}\r\n\t\t\t\t</Grid>\r\n\r\n\t\t\t\t<DT\r\n\t\t\t\t\ttitle={title}\r\n\t\t\t\t\ticon={this.props.icon}\r\n\t\t\t\t\tlist={list}\r\n\t\t\t\t\tidFunc={this.props.idFunc}\r\n\t\t\t\t\tfields={fields}\r\n\t\t\t\t\tonEdit={this.onEdit}\r\n\t\t\t\t\tonSave={this.onSave}\r\n\t\t\t\t\tonDelete={this.onDelete}\r\n\t\t\t\t\tcanEdit={this.canEdit}\r\n\t\t\t\t\tcanDelete={this.canDelete}\r\n\t\t\t\t\tactions={actions}\r\n\t\t\t\t\tisEditing={this.isEditing}\r\n\t\t\t\t/>\r\n\t\t\t</Segment>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate createTable() {\r\n\t\treturn DataTable as React.ComponentClass<DataTableProps<T>>;\r\n\t}\r\n\r\n\tprivate expandRef = (tableRef: DataTableRef): DataViewRef<T> => ({\r\n\t\t...tableRef,\r\n\t\tcreate: this.create,\r\n\t\tdetails: this.details,\r\n\t\tsave: this.save,\r\n\t\tedit: this.edit,\r\n\t\tendEdit: this.endEdit,\r\n\t\tdelete: this.delete\r\n\t});\r\n\r\n\tprivate onCreate = (obj: T, tableRef: DataTableRef) => {\r\n\t\tthis.props.onCreate\r\n\t\t\t? this.props.onCreate(obj, this.expandRef(tableRef))\r\n\t\t\t: this.create(obj);\r\n\t};\r\n\r\n\tprivate onEdit = (obj: T, tableRef: DataTableRef) => {\r\n\t\tthis.props.onEdit\r\n\t\t\t? this.props.onEdit(obj, this.expandRef(tableRef))\r\n\t\t\t: this.edit(obj);\r\n\t};\r\n\r\n\tprivate onSave = (obj: T, newObj: any, tableRef: DataTableRef) => {\r\n\t\tthis.props.onSave\r\n\t\t\t? this.props.onSave(obj, newObj, this.expandRef(tableRef))\r\n\t\t\t: this.save(obj, newObj);\r\n\t};\r\n\r\n\tprivate onDelete = (obj: T, tableRef: DataTableRef) => {\r\n\t\tthis.props.onDelete\r\n\t\t\t? this.props.onDelete(obj, this.expandRef(tableRef))\r\n\t\t\t: this.delete(obj);\r\n\t};\r\n\r\n\tprivate canEdit = (obj: T) => {\r\n\t\tconst { canEdit, perms, perm } = this.props;\r\n\t\treturn (\r\n\t\t\t(typeof canEdit === 'function' ? canEdit(obj) : !!canEdit) &&\r\n\t\t\tcheckPermissions(perms, perm.concat('modify'))\r\n\t\t);\r\n\t};\r\n\r\n\tprivate canDelete = (obj: T) => {\r\n\t\tconst { canDelete, perms, perm } = this.props;\r\n\t\treturn (\r\n\t\t\t(typeof canDelete === 'function' ? canDelete(obj) : !!canDelete) &&\r\n\t\t\tcheckPermissions(perms, perm.concat('delete'))\r\n\t\t);\r\n\t};\r\n\r\n\tprivate isEditing = (obj: T) => this.props.equals(obj, this.state.data);\r\n\r\n\tprivate renderCreateForm(\r\n\t\tcreateTitle: string | undefined,\r\n\t\tcreateFields: { [x: string]: DataFieldRaw<T> }\r\n\t) {\r\n\t\tconst { checkCreatePerm, perms, perm, createButton, creating } = this.props;\r\n\t\tif (\r\n\t\t\t!createTitle ||\r\n\t\t\t(checkCreatePerm && !checkPermissions(perms, perm.concat('create')))\r\n\t\t) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<Grid.Column>\r\n\t\t\t\t<CreateForm\r\n\t\t\t\t\ttitle={createTitle}\r\n\t\t\t\t\tbutton={createButton}\r\n\t\t\t\t\tcreating={creating}\r\n\t\t\t\t\tfields={createFields}\r\n\t\t\t\t\tonCreate={this.onCreate}\r\n\t\t\t\t/>\r\n\t\t\t</Grid.Column>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate renderFilterForm(\r\n\t\tfilterTitle: string | undefined,\r\n\t\tfilterFields: { [x: string]: DataFieldRaw<T> },\r\n\t\tregsValid: boolean\r\n\t) {\r\n\t\tif (!filterTitle) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<Grid.Column>\r\n\t\t\t\t<FilterForm\r\n\t\t\t\t\ttitle={filterTitle}\r\n\t\t\t\t\tfields={filterFields}\r\n\t\t\t\t\tvalid={regsValid}\r\n\t\t\t\t\tvalues={this.props.filter}\r\n\t\t\t\t\tonFilterChange={this.props.setFilter}\r\n\t\t\t\t/>\r\n\t\t\t</Grid.Column>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nfunction mapStateToProps<T>(endpoint: string, id: IdFunction<T>) {\r\n\treturn (_state: AppState, ownProps: OwnProps<T>) => {\r\n\t\tconst state: DataViewState<T> = _.get(\r\n\t\t\t_state,\r\n\t\t\tendpoint.replace(/\\//g, '_').replace('-', '')\r\n\t\t);\r\n\r\n\t\treturn {\r\n\t\t\tcreating: state ? state.creating : false,\r\n\t\t\tfilter: state && state.filter ? state.filter : {},\r\n\t\t\tlist: state ? state.list : [],\r\n\t\t\ttypes: _state.api.types,\r\n\t\t\tidFunc: id,\r\n\t\t\tperm: endpoint.split('/'),\r\n\t\t\tperms: _state.api.permissions\r\n\t\t};\r\n\t};\r\n}\r\n\r\nfunction mapDispatchToProps<T>(\r\n\tendpoint: string,\r\n\tid: IdFunction<T>,\r\n\tnoDetails: boolean\r\n) {\r\n\treturn (dispatch: Dispatch<AppAction>) => {\r\n\t\treturn {\r\n\t\t\trequestList: () => dispatch(requestList(endpoint, !noDetails)),\r\n\t\t\trequestDetails: (data: T) => dispatch(requestDetails(endpoint, id, data)),\r\n\t\t\trequestCreate: (data: T) => dispatch(requestCreate(endpoint, id, data)),\r\n\t\t\trequestChange: (data: T, newData: object) =>\r\n\t\t\t\tdispatch(requestChange(endpoint, id, data, newData)),\r\n\t\t\trequestDelete: (data: T) => dispatch(requestDelete(endpoint, id, data)),\r\n\t\t\tsetFilter: (filter: string, value: string) =>\r\n\t\t\t\tdispatch(setFilter(endpoint, filter, value)),\r\n\t\t\tequals: (o1: T, o2: T) => o1 != null && o2 != null && id(o1) === id(o2)\r\n\t\t};\r\n\t};\r\n}\r\n\r\nexport default function createDataView<T>(\r\n\tendpoint: string,\r\n\tobjId: string | IdFunction<T>,\r\n\tnoDetails?: boolean\r\n) {\r\n\tif (!objId) {\r\n\t\tobjId = 'id';\r\n\t}\r\n\tconst id =\r\n\t\ttypeof objId === 'function'\r\n\t\t\t? objId\r\n\t\t\t: (data: T) => _.get(data, objId as string);\r\n\r\n\treturn connect<StateProps<T>, DispatchProps<T>, OwnProps<T>, AppState>(\r\n\t\tmapStateToProps<T>(endpoint, id),\r\n\t\tmapDispatchToProps<T>(endpoint, id, noDetails ? true : false)\r\n\t)(DataView as any);\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/DataView/index.tsx","import * as _ from 'lodash';\r\nimport * as React from 'react';\r\nimport { withTranslation, WithTranslation } from 'react-i18next';\r\nimport { Accordion, Button, Dropdown, Form, Icon } from 'semantic-ui-react';\r\n\r\nimport { DataFieldGroup, DataFieldRaw, DataTableRef } from '../../types';\r\nimport { handleChange, HandleChangeFunc } from '../Util';\r\n\r\nexport interface Props<T> extends WithTranslation {\r\n\ttitle: string;\r\n\tcreating: boolean;\r\n\tonCreate: (data: any, view: DataTableRef) => void;\r\n\tbutton?: string;\r\n\tfields: {\r\n\t\t[x: string]: DataFieldRaw<T>;\r\n\t};\r\n}\r\n\r\ninterface OwnState {\r\n\topen: boolean;\r\n\tnewData: any;\r\n}\r\n\r\nclass CreateForm<T> extends React.Component<Props<T>, OwnState> {\r\n\tprivate handleChange: HandleChangeFunc;\r\n\r\n\tpublic constructor(props: Props<T>) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.state = {\r\n\t\t\topen: false,\r\n\t\t\tnewData: {}\r\n\t\t};\r\n\r\n\t\tthis.doHandleChange = this.doHandleChange.bind(this);\r\n\t\tthis.handleChange = handleChange.bind(this, this.doHandleChange);\r\n\t\tthis.create = this.create.bind(this);\r\n\t}\r\n\r\n\tprivate doHandleChange(key: string, value: string) {\r\n\t\tthis.setState({\r\n\t\t\tnewData: {\r\n\t\t\t\t...this.state.newData,\r\n\t\t\t\t[key]: value\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic shouldComponentUpdate(nextProps: Props<T>, nextState: OwnState) {\r\n\t\treturn (\r\n\t\t\tnextProps.creating !== this.props.creating ||\r\n\t\t\tnextProps.fields !== this.props.fields ||\r\n\t\t\tnextState.newData !== this.state.newData ||\r\n\t\t\tnextState.open !== this.state.open\r\n\t\t);\r\n\t}\r\n\r\n\tprivate create() {\r\n\t\tconst data = {};\r\n\t\tObject.keys(this.state.newData).forEach(key => {\r\n\t\t\t_.set(data, key, this.state.newData[key]);\r\n\t\t});\r\n\r\n\t\tthis.props.onCreate(data, {\r\n\t\t\tstate: this.state.newData,\r\n\t\t\tsetState: this.setState,\r\n\t\t\thandleChange: this.handleChange\r\n\t\t});\r\n\t}\r\n\r\n\tprivate canCreate(): boolean {\r\n\t\treturn Object.keys(this.props.fields).every(name => {\r\n\t\t\tconst field = this.props.fields[name];\r\n\t\t\tconst key = field.createName ? field.createName : name;\r\n\t\t\treturn (\r\n\t\t\t\ttypeof field === 'string' || !field.required || this.state.newData[key]\r\n\t\t\t);\r\n\t\t});\r\n\t}\r\n\r\n\tprivate handleClick = () => {\r\n\t\tthis.setState({\r\n\t\t\topen: !this.state.open\r\n\t\t});\r\n\t};\r\n\r\n\tpublic render() {\r\n\t\tconst { title, creating } = this.props;\r\n\r\n\t\tconst _t = this.props.t;\r\n\r\n\t\treturn (\r\n\t\t\t<Accordion styled fluid>\r\n\t\t\t\t<Accordion.Title active={this.state.open} onClick={this.handleClick}>\r\n\t\t\t\t\t<Icon fitted name=\"plus\" /> {title}\r\n\t\t\t\t</Accordion.Title>\r\n\r\n\t\t\t\t<Accordion.Content active={this.state.open}>\r\n\t\t\t\t\t<Form loading={creating}>\r\n\t\t\t\t\t\t{this.renderFieldGroups()}\r\n\r\n\t\t\t\t\t\t<Button primary onClick={this.create} disabled={!this.canCreate()}>\r\n\t\t\t\t\t\t\t{this.props.button || _t('Create')}\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t</Form>\r\n\t\t\t\t</Accordion.Content>\r\n\t\t\t</Accordion>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate renderFieldGroups() {\r\n\t\tconst fieldGroups: DataFieldGroup<T>[] = [];\r\n\t\tObject.keys(this.props.fields).forEach(name => {\r\n\t\t\tconst field = this.props.fields[name];\r\n\t\t\tconst newField: DataFieldRaw<T> = {\r\n\t\t\t\t...field,\r\n\t\t\t\tname: field.createName ? field.createName : name\r\n\t\t\t};\r\n\r\n\t\t\tif (newField.isGroup) {\r\n\t\t\t\tfieldGroups.push({ only: newField });\r\n\t\t\t} else if (\r\n\t\t\t\tfieldGroups.length &&\r\n\t\t\t\t!fieldGroups[fieldGroups.length - 1].second\r\n\t\t\t) {\r\n\t\t\t\tfieldGroups[fieldGroups.length - 1].second = newField;\r\n\t\t\t} else {\r\n\t\t\t\tfieldGroups.push({ first: newField });\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn fieldGroups.map((fg, i) => {\r\n\t\t\tif (fg.only) {\r\n\t\t\t\treturn <div key={i}>{this.renderField(fg.only)}</div>;\r\n\t\t\t}\r\n\r\n\t\t\treturn (\r\n\t\t\t\t<Form.Group key={i} widths=\"equal\">\r\n\t\t\t\t\t{fg.first && this.renderField(fg.first)}\r\n\r\n\t\t\t\t\t{fg.second && this.renderField(fg.second)}\r\n\t\t\t\t</Form.Group>\r\n\t\t\t);\r\n\t\t});\r\n\t}\r\n\r\n\tprivate renderField(field: DataFieldRaw<T>) {\r\n\t\tconst state = this.state.newData;\r\n\r\n\t\tif (typeof field.create === 'function') {\r\n\t\t\treturn field.create({\r\n\t\t\t\tstate: state,\r\n\t\t\t\tsetState: this.setState,\r\n\t\t\t\thandleChange: this.handleChange,\r\n\t\t\t\tvalue: state[field.name]\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (field.options) {\r\n\t\t\treturn (\r\n\t\t\t\t<Form.Field\r\n\t\t\t\t\tfluid={true}\r\n\t\t\t\t\tselection={true}\r\n\t\t\t\t\tsearch={true}\r\n\t\t\t\t\trequired={field.required}\r\n\t\t\t\t\tcontrol={Dropdown}\r\n\t\t\t\t\tname={field.name}\r\n\t\t\t\t\tlabel={field.label}\r\n\t\t\t\t\tplaceholder={field.label}\r\n\t\t\t\t\tonChange={this.handleChange}\r\n\t\t\t\t\tvalue={state[field.name]}\r\n\t\t\t\t\toptions={field.options}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<Form.Input\r\n\t\t\t\trequired={field.required}\r\n\t\t\t\ttype={field.type ? field.type : 'text'}\r\n\t\t\t\tname={field.name}\r\n\t\t\t\tlabel={field.label}\r\n\t\t\t\tplaceholder={field.label}\r\n\t\t\t\tonChange={this.handleChange}\r\n\t\t\t\tvalue={state[field.name]}\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default withTranslation('CreateForm')(CreateForm);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/CreateForm/index.tsx","import * as _ from 'lodash';\r\nimport * as React from 'react';\r\nimport { Accordion, Dropdown, Form, Icon, Message } from 'semantic-ui-react';\r\n\r\nimport { DataFieldGroup, DataFieldRaw } from '../../types';\r\nimport { handleChange, HandleChangeFunc } from '../Util';\r\n\r\nexport interface Props<T> {\r\n\ttitle: string;\r\n\tvalid: boolean;\r\n\tfields: {\r\n\t\t[x: string]: DataFieldRaw<T>;\r\n\t};\r\n\tvalues: {\r\n\t\t[x: string]: string | string[];\r\n\t};\r\n\tonFilterChange: (key: string, value: string) => void;\r\n}\r\n\r\ninterface State {\r\n\topen: boolean;\r\n}\r\n\r\nclass FilterForm<T> extends React.Component<Props<T>, State> {\r\n\tprivate handleChange: HandleChangeFunc;\r\n\r\n\tpublic constructor(props: Props<T>) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.state = {\r\n\t\t\topen: false\r\n\t\t};\r\n\r\n\t\tthis.handleChange = handleChange.bind(this, this.props.onFilterChange);\r\n\t}\r\n\r\n\tpublic shouldComponentUpdate(nextProps: Props<T>, nextState: State) {\r\n\t\treturn (\r\n\t\t\tnextProps.values !== this.props.values ||\r\n\t\t\tnextProps.fields !== this.props.fields ||\r\n\t\t\tnextProps.valid !== this.props.valid ||\r\n\t\t\tnextState.open !== this.state.open\r\n\t\t);\r\n\t}\r\n\r\n\tprivate handleClick = () => {\r\n\t\tthis.setState({\r\n\t\t\topen: !this.state.open\r\n\t\t});\r\n\t};\r\n\r\n\tpublic render() {\r\n\t\tconst { title, fields, values, valid } = this.props;\r\n\r\n\t\tconst fieldGroups: DataFieldGroup<T>[] = [];\r\n\t\tObject.keys(fields).forEach(name => {\r\n\t\t\tconst field = fields[name];\r\n\t\t\tconst newField: DataFieldRaw<T> = {\r\n\t\t\t\t...field,\r\n\t\t\t\tname: field.filterName ? field.filterName : name\r\n\t\t\t};\r\n\r\n\t\t\tif (newField.isGroup) {\r\n\t\t\t\tfieldGroups.push({ only: newField });\r\n\t\t\t} else if (\r\n\t\t\t\tfieldGroups.length &&\r\n\t\t\t\t!fieldGroups[fieldGroups.length - 1].second\r\n\t\t\t) {\r\n\t\t\t\tfieldGroups[fieldGroups.length - 1].second = newField;\r\n\t\t\t} else {\r\n\t\t\t\tfieldGroups.push({ first: newField });\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tconst fs = fieldGroups.map((fg, i) => {\r\n\t\t\tif (fg.only) {\r\n\t\t\t\treturn this.renderField(fg.only, _.get(values, fg.only.name), !valid);\r\n\t\t\t}\r\n\r\n\t\t\tconst first = fg.first\r\n\t\t\t\t? this.renderField(fg.first, _.get(values, fg.first.name), !valid)\r\n\t\t\t\t: null;\r\n\t\t\tconst second = fg.second\r\n\t\t\t\t? this.renderField(fg.second, _.get(values, fg.second.name), !valid)\r\n\t\t\t\t: null;\r\n\r\n\t\t\treturn (\r\n\t\t\t\t<Form.Group key={i} widths=\"equal\">\r\n\t\t\t\t\t{first}\r\n\t\t\t\t\t{second}\r\n\t\t\t\t</Form.Group>\r\n\t\t\t);\r\n\t\t});\r\n\r\n\t\treturn (\r\n\t\t\t<Accordion styled fluid>\r\n\t\t\t\t<Accordion.Title active={this.state.open} onClick={this.handleClick}>\r\n\t\t\t\t\t<Icon name=\"filter\" fitted /> {title}\r\n\t\t\t\t</Accordion.Title>\r\n\r\n\t\t\t\t<Accordion.Content active={this.state.open}>\r\n\t\t\t\t\t<Form>\r\n\t\t\t\t\t\t{fs}\r\n\t\t\t\t\t\t<Message\r\n\t\t\t\t\t\t\terror\r\n\t\t\t\t\t\t\tvisible={!valid}\r\n\t\t\t\t\t\t\tcontent=\"Search term must be a valid regex\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form>\r\n\t\t\t\t</Accordion.Content>\r\n\t\t\t</Accordion>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate renderField(\r\n\t\tfield: DataFieldRaw<T>,\r\n\t\tvalue: string | string[],\r\n\t\terror: boolean\r\n\t) {\r\n\t\tif (typeof field.filter === 'function') {\r\n\t\t\treturn field.filter({\r\n\t\t\t\tstate: this.props.values,\r\n\t\t\t\tsetState: this.setState,\r\n\t\t\t\thandleChange: this.handleChange,\r\n\t\t\t\tvalue: value\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (field.options) {\r\n\t\t\tif (!value) {\r\n\t\t\t\tvalue = [];\r\n\t\t\t}\r\n\r\n\t\t\treturn (\r\n\t\t\t\t<Form.Field\r\n\t\t\t\t\tfluid\r\n\t\t\t\t\tselection\r\n\t\t\t\t\tsearch\r\n\t\t\t\t\tmultiple\r\n\t\t\t\t\tcontrol={Dropdown}\r\n\t\t\t\t\tname={field.name}\r\n\t\t\t\t\tlabel={field.label}\r\n\t\t\t\t\tplaceholder={field.label}\r\n\t\t\t\t\toptions={field.options}\r\n\t\t\t\t\tvalue={value}\r\n\t\t\t\t\terror={error}\r\n\t\t\t\t\tonChange={this.handleChange}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<Form.Input\r\n\t\t\t\tname={field.name}\r\n\t\t\t\ttype={field.type ? field.type : 'text'}\r\n\t\t\t\tlabel={field.label}\r\n\t\t\t\tplaceholder={field.label}\r\n\t\t\t\tvalue={value}\r\n\t\t\t\terror={error}\r\n\t\t\t\tonChange={this.handleChange}\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default FilterForm;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/FilterForm/index.tsx"],"sourceRoot":""}