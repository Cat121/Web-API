{"version":3,"sources":["components/PermissionsTree/index.tsx","views/Users/index.tsx","components/DataTable/index.tsx","components/DataTable/Pagination.tsx","components/DataTable/TableHeader.tsx","components/DataTable/TableRow.tsx","components/DataView/index.tsx","components/CreateForm/index.tsx","components/FilterForm/index.tsx"],"names":["PERMISSION_OPTIONS","icon","text","value","PermissionsTree","_super","props","_this","call","this","state","__extends","prototype","handleChange","key","onChange","handleDelete","onDelete","render","_a","permissions","Elem","sub","__WEBPACK_IMPORTED_MODULE_2_semantic_ui_react__","List","perms","Object","keys","sort","a","b","localeCompare","map","renderKey","__WEBPACK_IMPORTED_MODULE_1_react__","renderEditor","canEdit","isSimple","knownPerms","knownPermissions","__WEBPACK_IMPORTED_MODULE_3__types__","editButton","negative","size","onClick","subTree","k","v","concat","Item","renderMain","Content","iconName","Icon","undefined","color","name","content","Group","hoverable","trigger","position","on","positive","renderForm","newName","newValue","pathOptions","__WEBPACK_IMPORTED_MODULE_0_lodash__","Select","label","options","e","p","setState","search","allowAdditions","Button","primary","type","disabled","DataView","__WEBPACK_IMPORTED_MODULE_5__components_DataView__","Users","onEdit","user","view","showDetails","onCreate","data","create","username","password","toggleModal","modal","val","newPerms","savePermissions","save","t","fields","required","filter","__WEBPACK_IMPORTED_MODULE_4_semantic_ui_react__","Input","placeholder","__WEBPACK_IMPORTED_MODULE_6__components_PermissionsTree__","canDelete","createTitle","filterTitle","title","renderModal","open","onClose","className","Header","Actions","secondary","__webpack_exports__","__WEBPACK_IMPORTED_MODULE_3_react_redux__","dispatch","__WEBPACK_IMPORTED_MODULE_2_react_i18next__","DataTable","changePage","event","page","preventDefault","obj","newData","forEach","edit","bind","doHandleChange","__WEBPACK_IMPORTED_MODULE_5__Util__","__assign","shouldComponentUpdate","nextProps","nextState","list","actions","f","maxPage","Math","ceil","length","min","_t","editable","deletable","style","marginTop","renderHeader","__WEBPACK_IMPORTED_MODULE_3_semantic_ui_react__","striped","stackable","__WEBPACK_IMPORTED_MODULE_7__TableHeader__","hasActions","i18n","__WEBPACK_IMPORTED_MODULE_4__services_i18n__","Body","renderRows","__WEBPACK_IMPORTED_MODULE_6__Pagination__","fitted","listPage","slice","thisRef","changes","i","__WEBPACK_IMPORTED_MODULE_8__TableRow__","idFunc","tableRef","actionable","editing","isEditing","onSave","Pagination","__WEBPACK_IMPORTED_MODULE_0_react__","__WEBPACK_IMPORTED_MODULE_1_semantic_ui_react__","pagination","renderFirst","renderPrevMore","renderNextMore","renderLast","from","max","to","pages","push","active","DataTableHeader","Row","renderFields","renderActions","field","HeaderCell","TableRow","apply","arguments","onEditEmpty","j","Cell","collapsing","wide","renderField","renderEdit","__WEBPACK_IMPORTED_MODULE_2__Util__","col","Field","fluid","selection","control","_canEdit","_canDelete","updating","loading","del","endpoint","objId","noDetails","id","__WEBPACK_IMPORTED_MODULE_2_react_redux__","_state","ownProps","replace","creating","types","api","perm","split","mapStateToProps","requestList","__WEBPACK_IMPORTED_MODULE_4__actions_dataview__","requestDetails","requestCreate","requestChange","requestDelete","setFilter","equals","o1","o2","mapDispatchToProps","expandRef","details","endEdit","delete","newObj","__WEBPACK_IMPORTED_MODULE_8__Util__","componentDidMount","static","interval","setInterval","componentWillUnmount","clearInterval","checks","regsValid","func_1","createFields","filterFields","ff","find","filterName","dataVal","filterValue","indexOf","RegExp","test","_b","every","check","cols","origActions","DT","createTable","createForm","renderCreateForm","filterForm","renderFilterForm","basic","doubling","columns","__WEBPACK_IMPORTED_MODULE_6__DataTable__","checkCreatePerm","createButton","Column","__WEBPACK_IMPORTED_MODULE_5__CreateForm__","button","__WEBPACK_IMPORTED_MODULE_7__FilterForm__","valid","values","onFilterChange","CreateForm","handleClick","__WEBPACK_IMPORTED_MODULE_4__Util__","canCreate","createName","styled","Title","renderFieldGroups","fieldGroups","newField","isGroup","only","second","first","fg","widths","FilterForm","__WEBPACK_IMPORTED_MODULE_3__Util__","fs","error","visible","multiple"],"mappings":"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","file":"static/js/8.7349722f.chunk.js","sourcesContent":["import * as _ from 'lodash';\r\nimport * as React from 'react';\r\nimport { Button, Form, List, Popup } from 'semantic-ui-react';\r\n\r\nimport { KNOWN_PERMISSIONS } from '../../types';\r\n\r\nconst PERMISSION_OPTIONS = [\r\n\t{ icon: 'checkmark', text: 'Allow', value: true },\r\n\t{ icon: 'ban', text: 'Deny', value: false },\r\n\t{\r\n\t\ticon: 'caret down',\r\n\t\ttext: 'Custom',\r\n\t\tvalue: '__custom__'\r\n\t}\r\n];\r\n\r\nexport interface Props {\r\n\tpermissions: any;\r\n\tsub?: boolean;\r\n\tcanEdit?: boolean;\r\n\tonChange?: (key: string[], value: string | boolean) => void;\r\n\tonDelete?: (key: string[]) => void;\r\n\tknownPermissions?: any;\r\n}\r\n\r\ninterface State {\r\n\tnewName?: string;\r\n\tnewValue?: string | boolean;\r\n}\r\n\r\nexport class PermissionsTree extends React.Component<Props, State> {\r\n\tpublic constructor(props: Props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.state = {};\r\n\t}\r\n\r\n\tprivate handleChange(key: string[], value: string | boolean) {\r\n\t\tif (this.props.onChange) {\r\n\t\t\tthis.props.onChange(key, value);\r\n\t\t}\r\n\t}\r\n\tprivate handleDelete(key: string[]) {\r\n\t\tif (this.props.onDelete) {\r\n\t\t\tthis.props.onDelete(key);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic render(): JSX.Element {\r\n\t\tconst { permissions, sub } = this.props;\r\n\t\t// tslint:disable-next-line:variable-name\r\n\t\tconst Elem = sub ? List.List : List;\r\n\r\n\t\tconst perms = Object.keys(permissions)\r\n\t\t\t.sort((a, b) => a.localeCompare(b))\r\n\t\t\t.map(key => this.renderKey(key));\r\n\r\n\t\treturn (\r\n\t\t\t<Elem>\r\n\t\t\t\t{perms}\r\n\t\t\t\t{this.renderEditor()}\r\n\t\t\t</Elem>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate renderKey(key: string) {\r\n\t\tconst { canEdit, permissions } = this.props;\r\n\t\tconst subPerms = permissions[key];\r\n\t\tconst isSimple = typeof subPerms === 'boolean';\r\n\r\n\t\tconst knownPerms = this.props.knownPermissions\r\n\t\t\t? this.props.knownPermissions\r\n\t\t\t: KNOWN_PERMISSIONS;\r\n\r\n\t\tconst onDelete = () => this.handleDelete([key]);\r\n\t\tconst editButton = canEdit && (\r\n\t\t\t<Button negative size=\"mini\" icon=\"delete\" onClick={onDelete} />\r\n\t\t);\r\n\r\n\t\tconst onSubTreeChange = (k: string[], v: string | boolean) =>\r\n\t\t\tthis.handleChange([key, ...k], v);\r\n\t\tconst onSubTreeDelete = (k: string[]) => this.handleDelete([key, ...k]);\r\n\t\tconst subTree = !isSimple && (\r\n\t\t\t<PermissionsTree\r\n\t\t\t\tsub\r\n\t\t\t\tcanEdit={this.props.canEdit}\r\n\t\t\t\tpermissions={permissions[key]}\r\n\t\t\t\tonChange={onSubTreeChange}\r\n\t\t\t\tonDelete={onSubTreeDelete}\r\n\t\t\t\tknownPermissions={knownPerms[key] ? knownPerms[key] : {}}\r\n\t\t\t/>\r\n\t\t);\r\n\r\n\t\treturn (\r\n\t\t\t<List.Item key={key}>\r\n\t\t\t\t{this.renderMain(key)}\r\n\r\n\t\t\t\t<List.Content>\r\n\t\t\t\t\t{key} {editButton}\r\n\t\t\t\t\t{subTree}\r\n\t\t\t\t</List.Content>\r\n\t\t\t</List.Item>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate renderMain(key: string) {\r\n\t\tconst { canEdit, permissions } = this.props;\r\n\t\tconst subPerms = permissions[key];\r\n\t\tconst isSimple = typeof subPerms === 'boolean';\r\n\r\n\t\tconst iconName = isSimple\r\n\t\t\t? permissions[key]\r\n\t\t\t\t? 'checkmark'\r\n\t\t\t\t: 'ban'\r\n\t\t\t: 'caret down';\r\n\t\tconst icon = (\r\n\t\t\t<List.Icon\r\n\t\t\t\tsize={canEdit ? 'large' : undefined}\r\n\t\t\t\tcolor={isSimple ? (permissions[key] ? 'green' : 'red') : undefined}\r\n\t\t\t\tname={iconName}\r\n\t\t\t/>\r\n\t\t);\r\n\r\n\t\tif (!canEdit) {\r\n\t\t\treturn icon;\r\n\t\t}\r\n\r\n\t\tconst onGrant = () => this.handleChange([key], true);\r\n\t\tconst onReject = () => this.handleChange([key], false);\r\n\t\tconst onCustom = () => this.handleChange([key], '__custom__');\r\n\t\tconst content = (\r\n\t\t\t<>\r\n\t\t\t\t<Button.Group>\r\n\t\t\t\t\t<Button icon=\"checkmark\" color=\"green\" onClick={onGrant} />\r\n\t\t\t\t\t<Button icon=\"ban\" color=\"red\" onClick={onReject} />\r\n\t\t\t\t\t<Button icon=\"caret down\" onClick={onCustom} />\r\n\t\t\t\t</Button.Group>\r\n\t\t\t</>\r\n\t\t);\r\n\r\n\t\treturn (\r\n\t\t\t<Popup\r\n\t\t\t\thoverable\r\n\t\t\t\ttrigger={icon}\r\n\t\t\t\tcontent={content}\r\n\t\t\t\tposition=\"top right\"\r\n\t\t\t\ton={['hover', 'click']}\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate renderEditor() {\r\n\t\tif (!this.props.canEdit) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<List.Item>\r\n\t\t\t\t<List.Content>\r\n\t\t\t\t\t<Popup\r\n\t\t\t\t\t\ton=\"click\"\r\n\t\t\t\t\t\ttrigger={<Button positive icon=\"add\" size=\"mini\" />}\r\n\t\t\t\t\t\tcontent={this.renderForm()}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</List.Content>\r\n\t\t\t</List.Item>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate renderForm() {\r\n\t\tconst { newName, newValue } = this.state;\r\n\r\n\t\tconst knownPerms = this.props.knownPermissions\r\n\t\t\t? this.props.knownPermissions\r\n\t\t\t: KNOWN_PERMISSIONS;\r\n\t\tconst pathOptions = _.uniq(\r\n\t\t\t['*', '.', this.state.newName].concat(Object.keys(knownPerms))\r\n\t\t).map(k => ({ text: k, value: k }));\r\n\r\n\t\tconst onPermissionsChange = (e: any, p: any) =>\r\n\t\t\tthis.setState({ newValue: p.value });\r\n\t\tconst onPathChange = (e: any, p: any) =>\r\n\t\t\tthis.setState({ newName: p.value });\r\n\t\tconst onSubmit = () => this.handleChange([newName as any], newValue as any);\r\n\r\n\t\treturn (\r\n\t\t\t<Form>\r\n\t\t\t\t<Form.Select\r\n\t\t\t\t\tlabel=\"Permissions\"\r\n\t\t\t\t\toptions={PERMISSION_OPTIONS}\r\n\t\t\t\t\tonChange={onPermissionsChange}\r\n\t\t\t\t/>\r\n\t\t\t\t<Form.Select\r\n\t\t\t\t\tsearch\r\n\t\t\t\t\tallowAdditions\r\n\t\t\t\t\tlabel=\"Path\"\r\n\t\t\t\t\toptions={pathOptions}\r\n\t\t\t\t\tonChange={onPathChange}\r\n\t\t\t\t/>\r\n\t\t\t\t<Form.Button\r\n\t\t\t\t\tprimary\r\n\t\t\t\t\ttype=\"submit\"\r\n\t\t\t\t\tdisabled={!this.state.newName || !this.state.newValue}\r\n\t\t\t\t\tonClick={onSubmit}\r\n\t\t\t\t>\r\n\t\t\t\t\tAdd\r\n\t\t\t\t</Form.Button>\r\n\t\t\t</Form>\r\n\t\t);\r\n\t}\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/PermissionsTree/index.tsx","import * as _ from 'lodash';\r\nimport * as React from 'react';\r\nimport { withTranslation, WithTranslation } from 'react-i18next';\r\nimport { connect } from 'react-redux';\r\nimport { Dispatch } from 'redux';\r\nimport { Button, Form, Modal } from 'semantic-ui-react';\r\n\r\nimport { AppAction } from '../../actions';\r\nimport DataViewFunc, { DataViewFields } from '../../components/DataView';\r\nimport { PermissionsTree } from '../../components/PermissionsTree';\r\nimport { UserPermissionStruct } from '../../fetch';\r\nimport { AppState, DataViewRef } from '../../types';\r\n\r\n// tslint:disable-next-line: variable-name\r\nconst DataView = DataViewFunc('user', 'name');\r\n\r\ninterface Props extends WithTranslation {}\r\n\r\ninterface State {\r\n\tmodal: boolean;\r\n\tuser?: UserPermissionStruct;\r\n\tview?: DataViewRef<UserPermissionStruct>;\r\n\tpermissions?: any;\r\n}\r\n\r\nclass Users extends React.Component<Props, State> {\r\n\tpublic constructor(props: Props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.state = {\r\n\t\t\tmodal: false\r\n\t\t};\r\n\t}\r\n\r\n\tpublic render() {\r\n\t\tconst { t } = this.props;\r\n\r\n\t\tconst fields: DataViewFields<UserPermissionStruct> = {\r\n\t\t\tname: {\r\n\t\t\t\trequired: true,\r\n\t\t\t\tlabel: t('Name'),\r\n\t\t\t\tcreate: true,\r\n\t\t\t\tfilter: true\r\n\t\t\t},\r\n\t\t\tpassword: {\r\n\t\t\t\trequired: true,\r\n\t\t\t\tcreate: (view: DataViewRef<UserPermissionStruct>) => (\r\n\t\t\t\t\t<Form.Input\r\n\t\t\t\t\t\tlabel={t('Password')}\r\n\t\t\t\t\t\ttype=\"password\"\r\n\t\t\t\t\t\tname=\"password\"\r\n\t\t\t\t\t\tplaceholder=\"********\"\r\n\t\t\t\t\t\tvalue={view.state.password}\r\n\t\t\t\t\t\tonChange={view.handleChange}\r\n\t\t\t\t\t/>\r\n\t\t\t\t),\r\n\t\t\t\tview: false\r\n\t\t\t},\r\n\t\t\tpermissions: {\r\n\t\t\t\tlabel: t('Permissions'),\r\n\t\t\t\tview: (user: UserPermissionStruct) => (\r\n\t\t\t\t\t<PermissionsTree permissions={user.permissions} />\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\treturn (\r\n\t\t\t<>\r\n\t\t\t\t<DataView\r\n\t\t\t\t\tcanEdit\r\n\t\t\t\t\tcanDelete\r\n\t\t\t\t\ticon=\"users\"\r\n\t\t\t\t\tcreateTitle={t('CreateUser')}\r\n\t\t\t\t\tfilterTitle={t('FilterUsers')}\r\n\t\t\t\t\ttitle={t('Users')}\r\n\t\t\t\t\tfields={fields}\r\n\t\t\t\t\tonEdit={this.onEdit}\r\n\t\t\t\t\tonCreate={this.onCreate}\r\n\t\t\t\t/>\r\n\t\t\t\t{this.renderModal()}\r\n\t\t\t</>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate renderModal() {\r\n\t\tconst { t } = this.props;\r\n\t\tconst { user, modal, permissions } = this.state;\r\n\r\n\t\tif (!user) {\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<Modal\r\n\t\t\t\topen={modal}\r\n\t\t\t\tonClose={this.toggleModal}\r\n\t\t\t\tsize=\"fullscreen\"\r\n\t\t\t\tclassName=\"scrolling\"\r\n\t\t\t>\r\n\t\t\t\t<Modal.Header>{user.name} </Modal.Header>\r\n\t\t\t\t<Modal.Content>\r\n\t\t\t\t\t<PermissionsTree\r\n\t\t\t\t\t\tcanEdit\r\n\t\t\t\t\t\tpermissions={permissions}\r\n\t\t\t\t\t\tonChange={this.handleChange}\r\n\t\t\t\t\t\tonDelete={this.handleDelete}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Modal.Content>\r\n\t\t\t\t<Modal.Actions>\r\n\t\t\t\t\t<Button primary onClick={this.savePermissions}>\r\n\t\t\t\t\t\t{t('Save')}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t\t&nbsp;\r\n\t\t\t\t\t<Button secondary onClick={this.toggleModal}>\r\n\t\t\t\t\t\t{t('Cancel')}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</Modal.Actions>\r\n\t\t\t</Modal>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate onEdit = (\r\n\t\tuser: UserPermissionStruct | undefined,\r\n\t\tview: DataViewRef<UserPermissionStruct>\r\n\t) => {\r\n\t\tthis.showDetails(user, view);\r\n\t};\r\n\r\n\tprivate onCreate = (data: any, view: DataViewRef<UserPermissionStruct>) => {\r\n\t\tview.create({ username: data.name, password: data.password });\r\n\t};\r\n\r\n\tprivate toggleModal = () => {\r\n\t\tthis.setState({\r\n\t\t\tmodal: !this.state.modal\r\n\t\t});\r\n\t};\r\n\r\n\tprivate showDetails(\r\n\t\tuser: UserPermissionStruct | undefined,\r\n\t\tview: DataViewRef<UserPermissionStruct>\r\n\t) {\r\n\t\tthis.setState({\r\n\t\t\tmodal: true,\r\n\t\t\tuser,\r\n\t\t\tview,\r\n\t\t\tpermissions: user ? _.merge({}, user.permissions) : undefined\r\n\t\t});\r\n\t}\r\n\r\n\tprivate handleChange = (key: string[], val: string | boolean) => {\r\n\t\tconst newPerms = _.merge({}, this.state.permissions);\r\n\t\tif (val === '__custom__') {\r\n\t\t\t_.set(newPerms, key, {});\r\n\t\t} else {\r\n\t\t\t_.set(newPerms, key, val);\r\n\t\t}\r\n\t\tthis.setState({ permissions: newPerms });\r\n\t};\r\n\r\n\tprivate handleDelete = (key: string[]) => {\r\n\t\tconst newPerms = _.merge({}, this.state.permissions);\r\n\t\t_.unset(newPerms, key);\r\n\t\tthis.setState({ permissions: newPerms });\r\n\t};\r\n\r\n\tprivate savePermissions = () => {\r\n\t\tif (!this.state.view || !this.state.user) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.state.view.save(this.state.user, {\r\n\t\t\tpermissions: this.state.permissions\r\n\t\t});\r\n\t\tthis.toggleModal();\r\n\t};\r\n}\r\n\r\nconst mapStateToProps = (state: AppState) => {\r\n\treturn {};\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch: Dispatch<AppAction>) => {\r\n\treturn {};\r\n};\r\n\r\nexport default connect(\r\n\tmapStateToProps,\r\n\tmapDispatchToProps\r\n)(withTranslation('Users')(Users));\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/views/Users/index.tsx","import * as _ from 'lodash';\r\nimport * as React from 'react';\r\nimport { withTranslation, WithTranslation } from 'react-i18next';\r\nimport { Header, Icon, SemanticICONS, Table } from 'semantic-ui-react';\r\n\r\nimport i18n from '../../services/i18n';\r\nimport { DataFieldRaw, DataTableRef, IdFunction } from '../../types';\r\nimport { handleChange, HandleChangeFunc } from '../Util';\r\n\r\nimport Pagination from './Pagination';\r\nimport TableHeader from './TableHeader';\r\nimport TableRow from './TableRow';\r\n\r\nconst ITEMS_PER_PAGE = 20;\r\n\r\nexport type DataTableFields<T> = {\r\n\t[key: string]: DataFieldRaw<T>;\r\n};\r\n\r\nexport interface Props<T> {\r\n\ttitle?: string;\r\n\ticon?: SemanticICONS;\r\n\tlist: T[];\r\n\tcanEdit?: (data: T) => boolean;\r\n\tcanDelete?: (data: T) => boolean;\r\n\tfields: DataTableFields<T>;\r\n\tactions?: (data: T, view: DataTableRef) => JSX.Element | undefined;\r\n\tonEdit?: (data: T | undefined, view: DataTableRef) => void;\r\n\tonSave?: (data: T, newData: any, view: DataTableRef) => void;\r\n\tonDelete?: (data: T, view: DataTableRef) => void;\r\n\tidFunc: IdFunction<T>;\r\n\tisEditing: (data: T) => boolean;\r\n}\r\n\r\ninterface AllProps<T> extends Props<T>, WithTranslation {}\r\n\r\ninterface OwnState {\r\n\tpage: number;\r\n\tnewData: any;\r\n}\r\n\r\nclass DataTable<T> extends React.Component<AllProps<T>, OwnState> {\r\n\tprivate handleChange: HandleChangeFunc;\r\n\r\n\tpublic constructor(props: AllProps<T>) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.state = {\r\n\t\t\tpage: 0,\r\n\t\t\tnewData: {}\r\n\t\t};\r\n\r\n\t\tthis.changePage = this.changePage.bind(this);\r\n\t\tthis.doHandleChange = this.doHandleChange.bind(this);\r\n\t\tthis.handleChange = handleChange.bind(this, this.doHandleChange);\r\n\t}\r\n\r\n\tprivate doHandleChange(key: string, value: string) {\r\n\t\tthis.setState({\r\n\t\t\tnewData: {\r\n\t\t\t\t...this.state.newData,\r\n\t\t\t\t[key]: value\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprivate changePage = (event: React.MouseEvent<HTMLElement>, page: number) => {\r\n\t\tevent.preventDefault();\r\n\r\n\t\tthis.setState({\r\n\t\t\tpage: page\r\n\t\t});\r\n\t};\r\n\r\n\tprivate onEdit = (obj: T | undefined, view: DataTableRef): void => {\r\n\t\tconst newData = {};\r\n\t\tif (obj) {\r\n\t\t\tObject.keys(this.props.fields).forEach(name => {\r\n\t\t\t\tif (!this.props.fields[name].edit) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tnewData[name] = _.get(obj, name);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tthis.setState({\r\n\t\t\tnewData: newData\r\n\t\t});\r\n\r\n\t\tif (this.props.onEdit) {\r\n\t\t\tthis.props.onEdit(obj, view);\r\n\t\t}\r\n\t};\r\n\r\n\tpublic shouldComponentUpdate(nextProps: Props<T>, nextState: OwnState) {\r\n\t\treturn (\r\n\t\t\tnextProps.fields !== this.props.fields ||\r\n\t\t\tnextProps.list !== this.props.list ||\r\n\t\t\tnextState.page !== this.state.page ||\r\n\t\t\tnextState.newData !== this.state.newData\r\n\t\t);\r\n\t}\r\n\r\n\tpublic render() {\r\n\t\tconst { list, canEdit, canDelete, actions } = this.props;\r\n\t\tconst fields = Object.keys(this.props.fields)\r\n\t\t\t.map(f => this.props.fields[f])\r\n\t\t\t.filter(f => f.view);\r\n\r\n\t\tconst maxPage = Math.ceil(list.length / ITEMS_PER_PAGE);\r\n\t\tconst page = Math.min(this.state.page, maxPage - 1);\r\n\r\n\t\tconst _t = this.props.t;\r\n\t\tconst editable = _.some(list, canEdit);\r\n\t\tconst deletable = _.some(list, canDelete);\r\n\r\n\t\treturn (\r\n\t\t\t<div style={{ marginTop: '2em' }}>\r\n\t\t\t\t{this.renderHeader()}\r\n\r\n\t\t\t\t<Table striped={true} stackable>\r\n\t\t\t\t\t<TableHeader\r\n\t\t\t\t\t\tfields={fields}\r\n\t\t\t\t\t\thasActions={typeof actions !== typeof undefined}\r\n\t\t\t\t\t\tcanEdit={editable}\r\n\t\t\t\t\t\tcanDelete={deletable}\r\n\t\t\t\t\t\ti18n={i18n}\r\n\t\t\t\t\t\tt={_t}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<Table.Body>{this.renderRows(fields, page)}</Table.Body>\r\n\t\t\t\t</Table>\r\n\t\t\t\t<Pagination\r\n\t\t\t\t\tpage={page}\r\n\t\t\t\t\tmaxPage={maxPage}\r\n\t\t\t\t\tchangePage={this.changePage}\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate renderHeader() {\r\n\t\tconst { icon, title } = this.props;\r\n\r\n\t\tif (!title) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<Header>\r\n\t\t\t\t<Icon fitted name={icon} /> {title}\r\n\t\t\t</Header>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate renderRows(fields: DataFieldRaw<T>[], page: number) {\r\n\t\tconst { list, canEdit, canDelete, actions, t } = this.props;\r\n\r\n\t\tconst listPage = list.slice(\r\n\t\t\tpage * ITEMS_PER_PAGE,\r\n\t\t\t(page + 1) * ITEMS_PER_PAGE\r\n\t\t);\r\n\r\n\t\tconst thisRef: DataTableRef = {\r\n\t\t\thandleChange: this.handleChange,\r\n\t\t\tstate: this.state.newData,\r\n\t\t\tsetState: (changes: object) =>\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\tnewData: { ...this.state.newData, ...changes }\r\n\t\t\t\t})\r\n\t\t};\r\n\r\n\t\tconst editable = _.some(list, canEdit);\r\n\t\tconst deletable = _.some(list, canDelete);\r\n\r\n\t\treturn listPage.map((obj, i) => (\r\n\t\t\t<TableRow\r\n\t\t\t\tkey={this.props.idFunc(obj)}\r\n\t\t\t\tobj={obj}\r\n\t\t\t\ttableRef={thisRef}\r\n\t\t\t\tactionable={editable || deletable}\r\n\t\t\t\tcanEdit={canEdit}\r\n\t\t\t\tcanDelete={canDelete}\r\n\t\t\t\tediting={this.props.isEditing(obj)}\r\n\t\t\t\tfields={fields}\r\n\t\t\t\tonEdit={this.onEdit}\r\n\t\t\t\tonSave={this.props.onSave}\r\n\t\t\t\tonDelete={this.props.onDelete}\r\n\t\t\t\tactions={actions}\r\n\t\t\t\tnewData={this.state.newData}\r\n\t\t\t\thandleChange={this.handleChange}\r\n\t\t\t\ti18n={i18n}\r\n\t\t\t\tt={t}\r\n\t\t\t/>\r\n\t\t));\r\n\t}\r\n}\r\n\r\nexport default withTranslation('DataTable')(DataTable);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/DataTable/index.tsx","import * as React from 'react';\r\nimport { Menu } from 'semantic-ui-react';\r\n\r\nexport interface Props {\r\n\tpage: number;\r\n\tmaxPage: number;\r\n\tchangePage: (event: React.MouseEvent<HTMLElement>, page: number) => void;\r\n}\r\n\r\nexport default class Pagination extends React.Component<Props> {\r\n\tpublic shouldComponentUpdate(nextProps: Props, nextState: any) {\r\n\t\treturn (\r\n\t\t\tnextProps.page !== this.props.page ||\r\n\t\t\tnextProps.maxPage !== this.props.maxPage\r\n\t\t);\r\n\t}\r\n\r\n\tpublic render() {\r\n\t\tif (this.props.maxPage <= 1) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<Menu pagination>\r\n\t\t\t\t{this.renderFirst()}\r\n\t\t\t\t{this.renderPrevMore()}\r\n\t\t\t\t{this.renderMain()}\r\n\t\t\t\t{this.renderNextMore()}\r\n\t\t\t\t{this.renderLast()}\r\n\t\t\t</Menu>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate renderFirst() {\r\n\t\tif (this.props.page <= 4) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\t// tslint:disable-next-line:jsx-no-lambda\r\n\t\treturn <Menu.Item onClick={e => this.props.changePage(e, 0)}>1</Menu.Item>;\r\n\t}\r\n\r\n\tprivate renderPrevMore() {\r\n\t\tif (this.props.page <= 5) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t// tslint:disable-next-line:jsx-no-lambda\r\n\t\t\t<Menu.Item onClick={e => this.props.changePage(e, this.props.page - 5)}>\r\n\t\t\t\t...\r\n\t\t\t</Menu.Item>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate renderMain() {\r\n\t\tconst { page, maxPage } = this.props;\r\n\t\tconst from = Math.max(0, page - 4);\r\n\t\tconst to = Math.min(maxPage, page + 5);\r\n\r\n\t\tconst pages = [];\r\n\t\tfor (let i = from; i < to; i++) {\r\n\t\t\tpages.push(i);\r\n\t\t}\r\n\r\n\t\treturn pages.map(p => (\r\n\t\t\t<Menu.Item\r\n\t\t\t\tkey={p}\r\n\t\t\t\t// tslint:disable-next-line:jsx-no-lambda\r\n\t\t\t\tonClick={e => this.props.changePage(e, p)}\r\n\t\t\t\tactive={p === page}\r\n\t\t\t>\r\n\t\t\t\t{p + 1}\r\n\t\t\t</Menu.Item>\r\n\t\t));\r\n\t}\r\n\r\n\tprivate renderNextMore() {\r\n\t\tif (this.props.page >= this.props.maxPage - 6) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t// tslint:disable-next-line:jsx-no-lambda\r\n\t\t\t<Menu.Item onClick={e => this.props.changePage(e, this.props.page + 5)}>\r\n\t\t\t\t...\r\n\t\t\t</Menu.Item>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate renderLast() {\r\n\t\tif (this.props.page >= this.props.maxPage - 5) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<Menu.Item\r\n\t\t\t\t// tslint:disable-next-line:jsx-no-lambda\r\n\t\t\t\tonClick={e => this.props.changePage(e, this.props.maxPage - 1)}\r\n\t\t\t>\r\n\t\t\t\t{this.props.maxPage}\r\n\t\t\t</Menu.Item>\r\n\t\t);\r\n\t}\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/DataTable/Pagination.tsx","import * as React from 'react';\r\nimport { WithTranslation } from 'react-i18next';\r\nimport { Table } from 'semantic-ui-react';\r\n\r\nimport { DataFieldRaw } from '../../types';\r\n\r\nexport interface Props<T> extends WithTranslation {\r\n\thasActions: boolean;\r\n\tcanEdit?: boolean;\r\n\tcanDelete?: boolean;\r\n\tfields: DataFieldRaw<T>[];\r\n}\r\n\r\nexport default class DataTableHeader<T> extends React.Component<Props<T>> {\r\n\tpublic shouldComponentUpdate(nextProps: Props<T>, nextState: any) {\r\n\t\treturn nextProps.fields !== this.props.fields;\r\n\t}\r\n\r\n\tpublic render() {\r\n\t\treturn (\r\n\t\t\t<Table.Header>\r\n\t\t\t\t<Table.Row>\r\n\t\t\t\t\t{this.renderFields()}\r\n\t\t\t\t\t{this.renderActions()}\r\n\t\t\t\t</Table.Row>\r\n\t\t\t</Table.Header>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate renderFields() {\r\n\t\treturn Object.keys(this.props.fields).map(name => {\r\n\t\t\tconst field = this.props.fields[name];\r\n\t\t\treturn (\r\n\t\t\t\t<Table.HeaderCell key={name}>\r\n\t\t\t\t\t{field.label ? field.label : '<' + field.name + '>'}\r\n\t\t\t\t</Table.HeaderCell>\r\n\t\t\t);\r\n\t\t});\r\n\t}\r\n\r\n\tprivate renderActions() {\r\n\t\tif (\r\n\t\t\t!this.props.hasActions &&\r\n\t\t\t!this.props.canEdit &&\r\n\t\t\t!this.props.canDelete\r\n\t\t) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn <Table.HeaderCell>{this.props.t('Actions')}</Table.HeaderCell>;\r\n\t}\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/DataTable/TableHeader.tsx","import * as React from 'react';\r\nimport { WithTranslation } from 'react-i18next';\r\nimport { Button, Dropdown, Form, Icon, Table } from 'semantic-ui-react';\r\n\r\nimport { DataFieldRaw, DataTableRef } from '../../types';\r\nimport { get, HandleChangeFunc } from '../Util';\r\n\r\nexport interface Props<T> extends WithTranslation {\r\n\tobj: T;\r\n\ttableRef: DataTableRef;\r\n\tactionable: boolean;\r\n\tcanEdit?: (data: T) => boolean;\r\n\tcanDelete?: (data: T) => boolean;\r\n\tediting: boolean;\r\n\tfields: DataFieldRaw<T>[];\r\n\tonEdit: (data: T | undefined, view: DataTableRef) => void;\r\n\tonSave?: (data: T, newData: any, view: DataTableRef) => void;\r\n\tonDelete?: (data: T, view: DataTableRef) => void;\r\n\tactions?: (data: T, view: DataTableRef) => JSX.Element | undefined;\r\n\thandleChange: HandleChangeFunc;\r\n\tnewData: any;\r\n}\r\n\r\nexport default class TableRow<T> extends React.Component<Props<T>> {\r\n\tpublic shouldComponentUpdate(nextProps: Props<T>, nextState: any) {\r\n\t\treturn (\r\n\t\t\tnextProps.obj !== this.props.obj ||\r\n\t\t\tnextProps.editing !== this.props.editing ||\r\n\t\t\tnextProps.fields !== this.props.fields ||\r\n\t\t\t(this.props.editing && nextProps.newData !== this.props.newData)\r\n\t\t);\r\n\t}\r\n\r\n\tprivate onSave = () => {\r\n\t\tconst { obj, tableRef } = this.props;\r\n\r\n\t\tif (this.props.onSave) {\r\n\t\t\tthis.props.onSave(obj, this.props.newData, tableRef);\r\n\t\t}\r\n\t};\r\n\r\n\tprivate onEditEmpty = () => {\r\n\t\tthis.props.onEdit(undefined, this.props.tableRef);\r\n\t};\r\n\r\n\tprivate onEdit = () => {\r\n\t\tthis.props.onEdit(this.props.obj, this.props.tableRef);\r\n\t};\r\n\r\n\tprivate onDelete = () => {\r\n\t\tif (this.props.onDelete) {\r\n\t\t\tthis.props.onDelete(this.props.obj, this.props.tableRef);\r\n\t\t}\r\n\t};\r\n\r\n\tpublic render() {\r\n\t\treturn (\r\n\t\t\t<Table.Row>\r\n\t\t\t\t{this.renderFields()}\r\n\t\t\t\t{this.renderActions()}\r\n\t\t\t</Table.Row>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate renderFields() {\r\n\t\tconst { fields } = this.props;\r\n\r\n\t\treturn fields.map((field, j) => (\r\n\t\t\t<Table.Cell key={j} collapsing={!field.wide}>\r\n\t\t\t\t{this.renderField(field)}\r\n\t\t\t</Table.Cell>\r\n\t\t));\r\n\t}\r\n\r\n\tprivate renderField(field: DataFieldRaw<T>) {\r\n\t\tconst { obj, editing, tableRef } = this.props;\r\n\r\n\t\treturn field.edit && editing\r\n\t\t\t? typeof field.edit === 'function'\r\n\t\t\t\t? field.edit(obj, tableRef)\r\n\t\t\t\t: this.renderEdit(obj, field)\r\n\t\t\t: typeof field.view === 'function'\r\n\t\t\t? field.view(obj, tableRef)\r\n\t\t\t: get(obj, field.name);\r\n\t}\r\n\r\n\tprivate renderEdit(obj: T, col: DataFieldRaw<T>) {\r\n\t\tif (col.options) {\r\n\t\t\treturn (\r\n\t\t\t\t<Form.Field\r\n\t\t\t\t\tfluid\r\n\t\t\t\t\tselection\r\n\t\t\t\t\tsearch\r\n\t\t\t\t\tcontrol={Dropdown}\r\n\t\t\t\t\tname={col.name}\r\n\t\t\t\t\tplaceholder={col.label}\r\n\t\t\t\t\toptions={col.options}\r\n\t\t\t\t\tvalue={this.props.newData[col.name]}\r\n\t\t\t\t\tonChange={this.props.handleChange}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<Form.Input\r\n\t\t\t\tname={col.name}\r\n\t\t\t\ttype={col.type ? col.type : 'text'}\r\n\t\t\t\tplaceholder={col.label}\r\n\t\t\t\tvalue={this.props.newData[col.name]}\r\n\t\t\t\tonChange={this.props.handleChange}\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate renderActions() {\r\n\t\tconst {\r\n\t\t\tactions,\r\n\t\t\tobj,\r\n\t\t\tactionable,\r\n\t\t\tcanEdit,\r\n\t\t\tcanDelete,\r\n\t\t\tediting,\r\n\t\t\ttableRef\r\n\t\t} = this.props;\r\n\r\n\t\tconst _canEdit = typeof canEdit === 'function' ? canEdit(obj) : canEdit;\r\n\t\tconst _canDelete =\r\n\t\t\ttypeof canDelete === 'function' ? canDelete(obj) : canEdit;\r\n\r\n\t\tif (!actions && !actionable) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tlet edit = null;\r\n\t\tif (_canEdit && editing) {\r\n\t\t\tedit = (\r\n\t\t\t\t<Table.Cell collapsing>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tprimary\r\n\t\t\t\t\t\tdisabled={(obj as any).updating}\r\n\t\t\t\t\t\tloading={(obj as any).updating}\r\n\t\t\t\t\t\tonClick={this.onSave}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Icon name=\"save\" /> {this.props.t('Save')}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tsecondary\r\n\t\t\t\t\t\tdisabled={(obj as any).updating}\r\n\t\t\t\t\t\tloading={(obj as any).updating}\r\n\t\t\t\t\t\tonClick={this.onEditEmpty}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Icon name=\"cancel\" /> {this.props.t('Cancel')}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</Table.Cell>\r\n\t\t\t);\r\n\t\t} else if (_canEdit) {\r\n\t\t\tedit = (\r\n\t\t\t\t<Table.Cell collapsing>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tprimary\r\n\t\t\t\t\t\tdisabled={(obj as any).updating}\r\n\t\t\t\t\t\tloading={(obj as any).updating}\r\n\t\t\t\t\t\tonClick={this.onEdit}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Icon name=\"edit\" /> {this.props.t('Edit')}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</Table.Cell>\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tlet del = null;\r\n\t\tif (_canDelete) {\r\n\t\t\tdel = (\r\n\t\t\t\t<Button\r\n\t\t\t\t\tnegative\r\n\t\t\t\t\tdisabled={(obj as any).updating}\r\n\t\t\t\t\tloading={(obj as any).updating}\r\n\t\t\t\t\tonClick={this.onDelete}\r\n\t\t\t\t>\r\n\t\t\t\t\t<Icon name=\"trash\" /> {this.props.t('Remove')}\r\n\t\t\t\t</Button>\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<Table.Cell collapsing>\r\n\t\t\t\t{edit}\r\n\t\t\t\t{del}\r\n\t\t\t\t{actions ? actions(obj, tableRef) : null}\r\n\t\t\t</Table.Cell>\r\n\t\t);\r\n\t}\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/DataTable/TableRow.tsx","import * as _ from 'lodash';\r\nimport * as React from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { Dispatch } from 'redux';\r\nimport { Grid, Segment } from 'semantic-ui-react';\r\n\r\nimport { AppAction } from '../../actions';\r\nimport {\r\n\trequestChange,\r\n\trequestCreate,\r\n\trequestDelete,\r\n\trequestDetails,\r\n\trequestList,\r\n\tsetFilter\r\n} from '../../actions/dataview';\r\nimport { DataViewState } from '../../reducers/dataview';\r\nimport {\r\n\tAppState,\r\n\tDataFieldRaw,\r\n\tDataTableRef,\r\n\tDataViewRef,\r\n\tIdFunction\r\n} from '../../types';\r\nimport CreateForm from '../CreateForm';\r\nimport DataTable, { Props as DataTableProps } from '../DataTable';\r\nimport FilterForm from '../FilterForm';\r\nimport { checkPermissions } from '../Util';\r\n\r\nimport {\r\n\tDispatchProps,\r\n\tFullProps,\r\n\tOwnProps,\r\n\tOwnState,\r\n\tStateProps\r\n} from './types';\r\nexport { DataViewFields } from './types';\r\n\r\nclass DataView<T> extends React.Component<FullProps<T>, OwnState<T>> {\r\n\tprivate interval: NodeJS.Timer;\r\n\r\n\tpublic constructor(props: FullProps<T>) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.state = {\r\n\t\t\tpage: 0,\r\n\t\t\tdata: undefined\r\n\t\t};\r\n\r\n\t\tthis.details = this.details.bind(this);\r\n\t\tthis.create = this.create.bind(this);\r\n\t\tthis.edit = this.edit.bind(this);\r\n\t\tthis.endEdit = this.endEdit.bind(this);\r\n\t\tthis.save = this.save.bind(this);\r\n\t\tthis.delete = this.delete.bind(this);\r\n\t}\r\n\r\n\tpublic componentDidMount() {\r\n\t\tif (!this.props.static) {\r\n\t\t\tthis.props.requestList();\r\n\t\t\tthis.interval = setInterval(this.props.requestList, 10000);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic componentWillUnmount() {\r\n\t\tif (this.interval) {\r\n\t\t\tclearInterval(this.interval);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic shouldComponentUpdate(\r\n\t\tnextProps: FullProps<T>,\r\n\t\tnextState: OwnState<T>\r\n\t) {\r\n\t\treturn (\r\n\t\t\tnextProps.creating !== this.props.creating ||\r\n\t\t\tnextProps.filter !== this.props.filter ||\r\n\t\t\tnextProps.fields !== this.props.fields ||\r\n\t\t\tnextProps.list !== this.props.list ||\r\n\t\t\tnextState.data !== this.state.data\r\n\t\t);\r\n\t}\r\n\r\n\t// Create a new data entry\r\n\tprivate create(data: T) {\r\n\t\tthis.props.requestCreate(data);\r\n\t}\r\n\r\n\t// Get the details for a data entry\r\n\tprivate details(data: T) {\r\n\t\tthis.props.requestDetails(data);\r\n\t}\r\n\r\n\t// Select a data entry for editing\r\n\tprivate edit(data: T | undefined) {\r\n\t\tthis.setState({ data });\r\n\t}\r\n\r\n\t// Save/Update an existing data entry\r\n\tprivate save(data: T, newData: any) {\r\n\t\tthis.props.requestChange(data, newData);\r\n\t\tthis.endEdit();\r\n\t}\r\n\r\n\t// End editing an entry\r\n\tprivate endEdit() {\r\n\t\tthis.setState({\r\n\t\t\tdata: undefined\r\n\t\t});\r\n\t}\r\n\r\n\t// Delete a data entry\r\n\tprivate delete(data: T) {\r\n\t\tthis.props.requestDelete(data);\r\n\t}\r\n\r\n\tpublic render() {\r\n\t\tconst { filter, title, createTitle, filterTitle } = this.props;\r\n\r\n\t\tconst checks: ((val: T) => boolean)[] = [];\r\n\t\tlet regsValid = false;\r\n\r\n\t\t// Get all the fields of the table\r\n\t\tconst fields: { [x: string]: DataFieldRaw<T> } = _.mapValues(\r\n\t\t\tthis.props.fields,\r\n\t\t\t(value, name) => {\r\n\t\t\t\tlet val: DataFieldRaw<T> = {\r\n\t\t\t\t\tname: name,\r\n\t\t\t\t\tview: true\r\n\t\t\t\t};\r\n\r\n\t\t\t\t// If the column is a string use that as the label\r\n\t\t\t\t// If the column is a function, use that function to display the cell\r\n\t\t\t\t// else if the column provides a view function then use that to display the cell\r\n\t\t\t\tif (typeof value === 'string') {\r\n\t\t\t\t\tval.label = value;\r\n\t\t\t\t} else if (typeof value === 'function') {\r\n\t\t\t\t\tval.view = (obj: T, tableRef: DataTableRef) =>\r\n\t\t\t\t\t\tvalue(obj, this.expandRef(tableRef));\r\n\t\t\t\t} else if (typeof value === 'object') {\r\n\t\t\t\t\tval = { ...val, ...value };\r\n\t\t\t\t\tif (typeof value.view === 'function') {\r\n\t\t\t\t\t\tconst func = value.view;\r\n\t\t\t\t\t\tval.view = (obj: T, tableRef: DataTableRef) =>\r\n\t\t\t\t\t\t\tfunc(obj, this.expandRef(tableRef));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn val;\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\t// Get all the fields for the create form\r\n\t\t// Get all the fields for the filter form\r\n\t\tconst createFields: { [x: string]: DataFieldRaw<T> } = {};\r\n\t\tconst filterFields: { [x: string]: DataFieldRaw<T> } = {};\r\n\t\tObject.keys(fields).forEach(f => {\r\n\t\t\tif (fields[f].create) {\r\n\t\t\t\tcreateFields[f] = fields[f];\r\n\t\t\t}\r\n\t\t\tif (fields[f].filter) {\r\n\t\t\t\tfilterFields[f] = fields[f];\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\ttry {\r\n\t\t\tObject.keys(filter).forEach(name => {\r\n\t\t\t\tconst value = filter[name];\r\n\r\n\t\t\t\t// Get the filter field according to the filterName if specified,\r\n\t\t\t\t// otherwise just the name\r\n\t\t\t\tconst ff =\r\n\t\t\t\t\tObject.keys(filterFields)\r\n\t\t\t\t\t\t.map(f => filterFields[f])\r\n\t\t\t\t\t\t.find(f => f.filterName === name) || filterFields[name];\r\n\r\n\t\t\t\t// If we have a filterValue function then use that as the value for the check\r\n\t\t\t\tlet val = (dataVal: T) => _.get(dataVal, name);\r\n\t\t\t\tif (typeof ff.filterValue === 'function') {\r\n\t\t\t\t\tval = ff.filterValue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// If it is an array then we need to check if the value is in the array\r\n\t\t\t\t// Otherwise just use a normal regex check\r\n\t\t\t\tif (_.isArray(value)) {\r\n\t\t\t\t\tif (value.length === 0) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tchecks.push((dataVal: T) => {\r\n\t\t\t\t\t\tconst v = val(dataVal);\r\n\t\t\t\t\t\treturn value.indexOf(v) >= 0;\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tchecks.push((dataVal: T) =>\r\n\t\t\t\t\t\tnew RegExp(value, 'i').test(val(dataVal))\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tregsValid = true;\r\n\t\t} catch {\r\n\t\t\tregsValid = false;\r\n\t\t}\r\n\r\n\t\t// Filter out the values according to the filters\r\n\t\t// If the regex isn't valid then we don't want to filter\r\n\t\tconst list = this.props.list.filter(data => {\r\n\t\t\treturn !regsValid || checks.every(check => check(data));\r\n\t\t});\r\n\r\n\t\t// Check how many columns we need for the create and filter form\r\n\t\tconst cols = createTitle && filterTitle ? 2 : 1;\r\n\r\n\t\t// Wrap the provided actions if we have any\r\n\t\tconst origActions = this.props.actions;\r\n\t\tlet actions = origActions;\r\n\t\tif (typeof origActions === 'function') {\r\n\t\t\tactions = (obj, tableRef) => origActions(obj, this.expandRef(tableRef));\r\n\t\t}\r\n\r\n\t\tconst DT = this.createTable();\r\n\r\n\t\tconst createForm = this.renderCreateForm(createTitle, createFields);\r\n\t\tconst filterForm = this.renderFilterForm(\r\n\t\t\tfilterTitle,\r\n\t\t\tfilterFields,\r\n\t\t\tregsValid\r\n\t\t);\r\n\r\n\t\treturn (\r\n\t\t\t<Segment basic>\r\n\t\t\t\t<Grid stackable doubling columns={cols}>\r\n\t\t\t\t\t{createForm}\r\n\t\t\t\t\t{filterForm}\r\n\t\t\t\t</Grid>\r\n\r\n\t\t\t\t<DT\r\n\t\t\t\t\ttitle={title}\r\n\t\t\t\t\ticon={this.props.icon}\r\n\t\t\t\t\tlist={list}\r\n\t\t\t\t\tidFunc={this.props.idFunc}\r\n\t\t\t\t\tfields={fields}\r\n\t\t\t\t\tonEdit={this.onEdit}\r\n\t\t\t\t\tonSave={this.onSave}\r\n\t\t\t\t\tonDelete={this.onDelete}\r\n\t\t\t\t\tcanEdit={this.canEdit}\r\n\t\t\t\t\tcanDelete={this.canDelete}\r\n\t\t\t\t\tactions={actions}\r\n\t\t\t\t\tisEditing={this.isEditing}\r\n\t\t\t\t/>\r\n\t\t\t</Segment>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate createTable() {\r\n\t\treturn DataTable as React.ComponentClass<DataTableProps<T>>;\r\n\t}\r\n\r\n\tprivate expandRef = (tableRef: DataTableRef): DataViewRef<T> => ({\r\n\t\t...tableRef,\r\n\t\tcreate: this.create,\r\n\t\tdetails: this.details,\r\n\t\tsave: this.save,\r\n\t\tedit: this.edit,\r\n\t\tendEdit: this.endEdit,\r\n\t\tdelete: this.delete\r\n\t});\r\n\r\n\tprivate onCreate = (obj: T, tableRef: DataTableRef) => {\r\n\t\tthis.props.onCreate\r\n\t\t\t? this.props.onCreate(obj, this.expandRef(tableRef))\r\n\t\t\t: this.create(obj);\r\n\t};\r\n\r\n\tprivate onEdit = (obj: T, tableRef: DataTableRef) => {\r\n\t\tthis.props.onEdit\r\n\t\t\t? this.props.onEdit(obj, this.expandRef(tableRef))\r\n\t\t\t: this.edit(obj);\r\n\t};\r\n\r\n\tprivate onSave = (obj: T, newObj: any, tableRef: DataTableRef) => {\r\n\t\tthis.props.onSave\r\n\t\t\t? this.props.onSave(obj, newObj, this.expandRef(tableRef))\r\n\t\t\t: this.save(obj, newObj);\r\n\t};\r\n\r\n\tprivate onDelete = (obj: T, tableRef: DataTableRef) => {\r\n\t\tthis.props.onDelete\r\n\t\t\t? this.props.onDelete(obj, this.expandRef(tableRef))\r\n\t\t\t: this.delete(obj);\r\n\t};\r\n\r\n\tprivate canEdit = (obj: T) => {\r\n\t\tconst { canEdit, perms, perm } = this.props;\r\n\t\treturn (\r\n\t\t\t(typeof canEdit === 'function' ? canEdit(obj) : !!canEdit) &&\r\n\t\t\tcheckPermissions(perms, perm.concat('modify'))\r\n\t\t);\r\n\t};\r\n\r\n\tprivate canDelete = (obj: T) => {\r\n\t\tconst { canDelete, perms, perm } = this.props;\r\n\t\treturn (\r\n\t\t\t(typeof canDelete === 'function' ? canDelete(obj) : !!canDelete) &&\r\n\t\t\tcheckPermissions(perms, perm.concat('delete'))\r\n\t\t);\r\n\t};\r\n\r\n\tprivate isEditing = (obj: T) => this.props.equals(obj, this.state.data);\r\n\r\n\tprivate renderCreateForm(\r\n\t\tcreateTitle: string | undefined,\r\n\t\tcreateFields: { [x: string]: DataFieldRaw<T> }\r\n\t) {\r\n\t\tconst { checkCreatePerm, perms, perm, createButton, creating } = this.props;\r\n\t\tif (\r\n\t\t\t!createTitle ||\r\n\t\t\t(checkCreatePerm && !checkPermissions(perms, perm.concat('create')))\r\n\t\t) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<Grid.Column>\r\n\t\t\t\t<CreateForm\r\n\t\t\t\t\ttitle={createTitle}\r\n\t\t\t\t\tbutton={createButton}\r\n\t\t\t\t\tcreating={creating}\r\n\t\t\t\t\tfields={createFields}\r\n\t\t\t\t\tonCreate={this.onCreate}\r\n\t\t\t\t/>\r\n\t\t\t</Grid.Column>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate renderFilterForm(\r\n\t\tfilterTitle: string | undefined,\r\n\t\tfilterFields: { [x: string]: DataFieldRaw<T> },\r\n\t\tregsValid: boolean\r\n\t) {\r\n\t\tif (!filterTitle) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<Grid.Column>\r\n\t\t\t\t<FilterForm\r\n\t\t\t\t\ttitle={filterTitle}\r\n\t\t\t\t\tfields={filterFields}\r\n\t\t\t\t\tvalid={regsValid}\r\n\t\t\t\t\tvalues={this.props.filter}\r\n\t\t\t\t\tonFilterChange={this.props.setFilter}\r\n\t\t\t\t/>\r\n\t\t\t</Grid.Column>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nfunction mapStateToProps<T>(endpoint: string, id: IdFunction<T>) {\r\n\treturn (_state: AppState, ownProps: OwnProps<T>) => {\r\n\t\tconst state: DataViewState<T> = _.get(\r\n\t\t\t_state,\r\n\t\t\tendpoint.replace(/\\//g, '_').replace('-', '')\r\n\t\t);\r\n\r\n\t\treturn {\r\n\t\t\tcreating: state ? state.creating : false,\r\n\t\t\tfilter: state && state.filter ? state.filter : {},\r\n\t\t\tlist: state ? state.list : [],\r\n\t\t\ttypes: _state.api.types,\r\n\t\t\tidFunc: id,\r\n\t\t\tperm: endpoint.split('/'),\r\n\t\t\tperms: _state.api.permissions\r\n\t\t};\r\n\t};\r\n}\r\n\r\nfunction mapDispatchToProps<T>(\r\n\tendpoint: string,\r\n\tid: IdFunction<T>,\r\n\tnoDetails: boolean\r\n) {\r\n\treturn (dispatch: Dispatch<AppAction>) => {\r\n\t\treturn {\r\n\t\t\trequestList: () => dispatch(requestList(endpoint, !noDetails)),\r\n\t\t\trequestDetails: (data: T) => dispatch(requestDetails(endpoint, id, data)),\r\n\t\t\trequestCreate: (data: T) => dispatch(requestCreate(endpoint, id, data)),\r\n\t\t\trequestChange: (data: T, newData: object) =>\r\n\t\t\t\tdispatch(requestChange(endpoint, id, data, newData)),\r\n\t\t\trequestDelete: (data: T) => dispatch(requestDelete(endpoint, id, data)),\r\n\t\t\tsetFilter: (filter: string, value: string) =>\r\n\t\t\t\tdispatch(setFilter(endpoint, filter, value)),\r\n\t\t\tequals: (o1: T, o2: T) => o1 != null && o2 != null && id(o1) === id(o2)\r\n\t\t};\r\n\t};\r\n}\r\n\r\nexport default function createDataView<T>(\r\n\tendpoint: string,\r\n\tobjId: string | IdFunction<T>,\r\n\tnoDetails?: boolean\r\n) {\r\n\tif (!objId) {\r\n\t\tobjId = 'id';\r\n\t}\r\n\tconst id =\r\n\t\ttypeof objId === 'function'\r\n\t\t\t? objId\r\n\t\t\t: (data: T) => _.get(data, objId as string);\r\n\r\n\treturn connect<StateProps<T>, DispatchProps<T>, OwnProps<T>, AppState>(\r\n\t\tmapStateToProps<T>(endpoint, id),\r\n\t\tmapDispatchToProps<T>(endpoint, id, noDetails ? true : false)\r\n\t)(DataView as any);\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/DataView/index.tsx","import * as _ from 'lodash';\r\nimport * as React from 'react';\r\nimport { withTranslation, WithTranslation } from 'react-i18next';\r\nimport { Accordion, Button, Dropdown, Form, Icon } from 'semantic-ui-react';\r\n\r\nimport { DataFieldGroup, DataFieldRaw, DataTableRef } from '../../types';\r\nimport { handleChange, HandleChangeFunc } from '../Util';\r\n\r\nexport interface Props<T> extends WithTranslation {\r\n\ttitle: string;\r\n\tcreating: boolean;\r\n\tonCreate: (data: any, view: DataTableRef) => void;\r\n\tbutton?: string;\r\n\tfields: {\r\n\t\t[x: string]: DataFieldRaw<T>;\r\n\t};\r\n}\r\n\r\ninterface OwnState {\r\n\topen: boolean;\r\n\tnewData: any;\r\n}\r\n\r\nclass CreateForm<T> extends React.Component<Props<T>, OwnState> {\r\n\tprivate handleChange: HandleChangeFunc;\r\n\r\n\tpublic constructor(props: Props<T>) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.state = {\r\n\t\t\topen: false,\r\n\t\t\tnewData: {}\r\n\t\t};\r\n\r\n\t\tthis.doHandleChange = this.doHandleChange.bind(this);\r\n\t\tthis.handleChange = handleChange.bind(this, this.doHandleChange);\r\n\t\tthis.create = this.create.bind(this);\r\n\t}\r\n\r\n\tprivate doHandleChange(key: string, value: string) {\r\n\t\tthis.setState({\r\n\t\t\tnewData: {\r\n\t\t\t\t...this.state.newData,\r\n\t\t\t\t[key]: value\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic shouldComponentUpdate(nextProps: Props<T>, nextState: OwnState) {\r\n\t\treturn (\r\n\t\t\tnextProps.creating !== this.props.creating ||\r\n\t\t\tnextProps.fields !== this.props.fields ||\r\n\t\t\tnextState.newData !== this.state.newData ||\r\n\t\t\tnextState.open !== this.state.open\r\n\t\t);\r\n\t}\r\n\r\n\tprivate create() {\r\n\t\tconst data = {};\r\n\t\tObject.keys(this.state.newData).forEach(key => {\r\n\t\t\t_.set(data, key, this.state.newData[key]);\r\n\t\t});\r\n\r\n\t\tthis.props.onCreate(data, {\r\n\t\t\tstate: this.state.newData,\r\n\t\t\tsetState: this.setState,\r\n\t\t\thandleChange: this.handleChange\r\n\t\t});\r\n\t}\r\n\r\n\tprivate canCreate(): boolean {\r\n\t\treturn Object.keys(this.props.fields).every(name => {\r\n\t\t\tconst field = this.props.fields[name];\r\n\t\t\tconst key = field.createName ? field.createName : name;\r\n\t\t\treturn (\r\n\t\t\t\ttypeof field === 'string' || !field.required || this.state.newData[key]\r\n\t\t\t);\r\n\t\t});\r\n\t}\r\n\r\n\tprivate handleClick = () => {\r\n\t\tthis.setState({\r\n\t\t\topen: !this.state.open\r\n\t\t});\r\n\t};\r\n\r\n\tpublic render() {\r\n\t\tconst { title, creating } = this.props;\r\n\r\n\t\tconst _t = this.props.t;\r\n\r\n\t\treturn (\r\n\t\t\t<Accordion styled fluid>\r\n\t\t\t\t<Accordion.Title active={this.state.open} onClick={this.handleClick}>\r\n\t\t\t\t\t<Icon fitted name=\"plus\" /> {title}\r\n\t\t\t\t</Accordion.Title>\r\n\r\n\t\t\t\t<Accordion.Content active={this.state.open}>\r\n\t\t\t\t\t<Form loading={creating}>\r\n\t\t\t\t\t\t{this.renderFieldGroups()}\r\n\r\n\t\t\t\t\t\t<Button primary onClick={this.create} disabled={!this.canCreate()}>\r\n\t\t\t\t\t\t\t{this.props.button || _t('Create')}\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t</Form>\r\n\t\t\t\t</Accordion.Content>\r\n\t\t\t</Accordion>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate renderFieldGroups() {\r\n\t\tconst fieldGroups: DataFieldGroup<T>[] = [];\r\n\t\tObject.keys(this.props.fields).forEach(name => {\r\n\t\t\tconst field = this.props.fields[name];\r\n\t\t\tconst newField: DataFieldRaw<T> = {\r\n\t\t\t\t...field,\r\n\t\t\t\tname: field.createName ? field.createName : name\r\n\t\t\t};\r\n\r\n\t\t\tif (newField.isGroup) {\r\n\t\t\t\tfieldGroups.push({ only: newField });\r\n\t\t\t} else if (\r\n\t\t\t\tfieldGroups.length &&\r\n\t\t\t\t!fieldGroups[fieldGroups.length - 1].second\r\n\t\t\t) {\r\n\t\t\t\tfieldGroups[fieldGroups.length - 1].second = newField;\r\n\t\t\t} else {\r\n\t\t\t\tfieldGroups.push({ first: newField });\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn fieldGroups.map((fg, i) => {\r\n\t\t\tif (fg.only) {\r\n\t\t\t\treturn <div key={i}>{this.renderField(fg.only)}</div>;\r\n\t\t\t}\r\n\r\n\t\t\treturn (\r\n\t\t\t\t<Form.Group key={i} widths=\"equal\">\r\n\t\t\t\t\t{fg.first && this.renderField(fg.first)}\r\n\r\n\t\t\t\t\t{fg.second && this.renderField(fg.second)}\r\n\t\t\t\t</Form.Group>\r\n\t\t\t);\r\n\t\t});\r\n\t}\r\n\r\n\tprivate renderField(field: DataFieldRaw<T>) {\r\n\t\tconst state = this.state.newData;\r\n\r\n\t\tif (typeof field.create === 'function') {\r\n\t\t\treturn field.create({\r\n\t\t\t\tstate: state,\r\n\t\t\t\tsetState: this.setState,\r\n\t\t\t\thandleChange: this.handleChange,\r\n\t\t\t\tvalue: state[field.name]\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (field.options) {\r\n\t\t\treturn (\r\n\t\t\t\t<Form.Field\r\n\t\t\t\t\tfluid={true}\r\n\t\t\t\t\tselection={true}\r\n\t\t\t\t\tsearch={true}\r\n\t\t\t\t\trequired={field.required}\r\n\t\t\t\t\tcontrol={Dropdown}\r\n\t\t\t\t\tname={field.name}\r\n\t\t\t\t\tlabel={field.label}\r\n\t\t\t\t\tplaceholder={field.label}\r\n\t\t\t\t\tonChange={this.handleChange}\r\n\t\t\t\t\tvalue={state[field.name]}\r\n\t\t\t\t\toptions={field.options}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<Form.Input\r\n\t\t\t\trequired={field.required}\r\n\t\t\t\ttype={field.type ? field.type : 'text'}\r\n\t\t\t\tname={field.name}\r\n\t\t\t\tlabel={field.label}\r\n\t\t\t\tplaceholder={field.label}\r\n\t\t\t\tonChange={this.handleChange}\r\n\t\t\t\tvalue={state[field.name]}\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default withTranslation('CreateForm')(CreateForm);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/CreateForm/index.tsx","import * as _ from 'lodash';\r\nimport * as React from 'react';\r\nimport { Accordion, Dropdown, Form, Icon, Message } from 'semantic-ui-react';\r\n\r\nimport { DataFieldGroup, DataFieldRaw } from '../../types';\r\nimport { handleChange, HandleChangeFunc } from '../Util';\r\n\r\nexport interface Props<T> {\r\n\ttitle: string;\r\n\tvalid: boolean;\r\n\tfields: {\r\n\t\t[x: string]: DataFieldRaw<T>;\r\n\t};\r\n\tvalues: {\r\n\t\t[x: string]: string | string[];\r\n\t};\r\n\tonFilterChange: (key: string, value: string) => void;\r\n}\r\n\r\ninterface State {\r\n\topen: boolean;\r\n}\r\n\r\nclass FilterForm<T> extends React.Component<Props<T>, State> {\r\n\tprivate handleChange: HandleChangeFunc;\r\n\r\n\tpublic constructor(props: Props<T>) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.state = {\r\n\t\t\topen: false\r\n\t\t};\r\n\r\n\t\tthis.handleChange = handleChange.bind(this, this.props.onFilterChange);\r\n\t}\r\n\r\n\tpublic shouldComponentUpdate(nextProps: Props<T>, nextState: State) {\r\n\t\treturn (\r\n\t\t\tnextProps.values !== this.props.values ||\r\n\t\t\tnextProps.fields !== this.props.fields ||\r\n\t\t\tnextProps.valid !== this.props.valid ||\r\n\t\t\tnextState.open !== this.state.open\r\n\t\t);\r\n\t}\r\n\r\n\tprivate handleClick = () => {\r\n\t\tthis.setState({\r\n\t\t\topen: !this.state.open\r\n\t\t});\r\n\t};\r\n\r\n\tpublic render() {\r\n\t\tconst { title, fields, values, valid } = this.props;\r\n\r\n\t\tconst fieldGroups: DataFieldGroup<T>[] = [];\r\n\t\tObject.keys(fields).forEach(name => {\r\n\t\t\tconst field = fields[name];\r\n\t\t\tconst newField: DataFieldRaw<T> = {\r\n\t\t\t\t...field,\r\n\t\t\t\tname: field.filterName ? field.filterName : name\r\n\t\t\t};\r\n\r\n\t\t\tif (newField.isGroup) {\r\n\t\t\t\tfieldGroups.push({ only: newField });\r\n\t\t\t} else if (\r\n\t\t\t\tfieldGroups.length &&\r\n\t\t\t\t!fieldGroups[fieldGroups.length - 1].second\r\n\t\t\t) {\r\n\t\t\t\tfieldGroups[fieldGroups.length - 1].second = newField;\r\n\t\t\t} else {\r\n\t\t\t\tfieldGroups.push({ first: newField });\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tconst fs = fieldGroups.map((fg, i) => {\r\n\t\t\tif (fg.only) {\r\n\t\t\t\treturn this.renderField(fg.only, _.get(values, fg.only.name), !valid);\r\n\t\t\t}\r\n\r\n\t\t\tconst first = fg.first\r\n\t\t\t\t? this.renderField(fg.first, _.get(values, fg.first.name), !valid)\r\n\t\t\t\t: null;\r\n\t\t\tconst second = fg.second\r\n\t\t\t\t? this.renderField(fg.second, _.get(values, fg.second.name), !valid)\r\n\t\t\t\t: null;\r\n\r\n\t\t\treturn (\r\n\t\t\t\t<Form.Group key={i} widths=\"equal\">\r\n\t\t\t\t\t{first}\r\n\t\t\t\t\t{second}\r\n\t\t\t\t</Form.Group>\r\n\t\t\t);\r\n\t\t});\r\n\r\n\t\treturn (\r\n\t\t\t<Accordion styled fluid>\r\n\t\t\t\t<Accordion.Title active={this.state.open} onClick={this.handleClick}>\r\n\t\t\t\t\t<Icon name=\"filter\" fitted /> {title}\r\n\t\t\t\t</Accordion.Title>\r\n\r\n\t\t\t\t<Accordion.Content active={this.state.open}>\r\n\t\t\t\t\t<Form>\r\n\t\t\t\t\t\t{fs}\r\n\t\t\t\t\t\t<Message\r\n\t\t\t\t\t\t\terror\r\n\t\t\t\t\t\t\tvisible={!valid}\r\n\t\t\t\t\t\t\tcontent=\"Search term must be a valid regex\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form>\r\n\t\t\t\t</Accordion.Content>\r\n\t\t\t</Accordion>\r\n\t\t);\r\n\t}\r\n\r\n\tprivate renderField(\r\n\t\tfield: DataFieldRaw<T>,\r\n\t\tvalue: string | string[],\r\n\t\terror: boolean\r\n\t) {\r\n\t\tif (typeof field.filter === 'function') {\r\n\t\t\treturn field.filter({\r\n\t\t\t\tstate: this.props.values,\r\n\t\t\t\tsetState: this.setState,\r\n\t\t\t\thandleChange: this.handleChange,\r\n\t\t\t\tvalue: value\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (field.options) {\r\n\t\t\tif (!value) {\r\n\t\t\t\tvalue = [];\r\n\t\t\t}\r\n\r\n\t\t\treturn (\r\n\t\t\t\t<Form.Field\r\n\t\t\t\t\tfluid\r\n\t\t\t\t\tselection\r\n\t\t\t\t\tsearch\r\n\t\t\t\t\tmultiple\r\n\t\t\t\t\tcontrol={Dropdown}\r\n\t\t\t\t\tname={field.name}\r\n\t\t\t\t\tlabel={field.label}\r\n\t\t\t\t\tplaceholder={field.label}\r\n\t\t\t\t\toptions={field.options}\r\n\t\t\t\t\tvalue={value}\r\n\t\t\t\t\terror={error}\r\n\t\t\t\t\tonChange={this.handleChange}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<Form.Input\r\n\t\t\t\tname={field.name}\r\n\t\t\t\ttype={field.type ? field.type : 'text'}\r\n\t\t\t\tlabel={field.label}\r\n\t\t\t\tplaceholder={field.label}\r\n\t\t\t\tvalue={value}\r\n\t\t\t\terror={error}\r\n\t\t\t\tonChange={this.handleChange}\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default FilterForm;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/FilterForm/index.tsx"],"sourceRoot":""}